!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=monaco},function(t,e,n){"use strict";n.r(e);var i=n(0);function o(t,e,n,o){o||(o=e.editor.getPosition());var r=n.motion(e,o,n.count||1,t,void 0===n.count);return!1===r?{from:o}:i.Position.isIPosition(r)?{from:o,to:r}:Object.assign(r,{from:r.from||o,to:r.position})}function r(t,e){return"object"==typeof(n=t)&&n.then?t.then(e):e(t);var n}var s,a,u,c=function(){function t(t,e){this.command=t,this.args=e}return t.prototype.setCount=function(t){this.args.count=t},t.prototype.execute=function(t){return h(this.command,t,this.args)},t}(),d=new(function(){function t(){}return t.prototype.setLast=function(t,e){this.last=new c(t,e)},t.prototype.setLastAction=function(t){this.last=t},t.prototype.repeatLast=function(t,e){if(this.last)return void 0!==e&&this.last.setCount(e),t.vimState.isRepeating=!0,r(this.last.execute(t),function(){t.vimState.isRepeating=!1})},t}());function l(t){var e="function"==typeof t?{run:t}:t;return Object.assign({shouldRecord:!1},e)}function h(t,e,n){return e.vimState.isExecutingCommand=!0,r(t.run(e,n),function(){e.vimState.isExecutingCommand=!1,!1!==t.shouldRecord&&d.setLast(t,n)})}function f(t,e){return void 0===e&&(e=0),{kind:"Key",key:"number"==typeof t?t:t.charCodeAt(e)}}function p(t){return void 0===t&&(t=!1),{kind:"Digit",nonZero:t}}function g(t,e){return{kind:"Cat",left:t,right:e}}function m(t){var e=t.length;if(e<1)throw new Error("empty arg.");return 1===e?t[0]:t.reduce(function(t,e){return g(t,e)})}function v(t,e){return{kind:"Alt",left:t,right:e}}function y(t){var e=t.length;if(e<1)throw new Error("empty arg.");return 1===e?t[0]:t.reduce(function(t,e){return v(t,e)})}function A(t){return{kind:"Opt",child:t}}function b(t,e){return{kind:"Seq",target:t,action:e}}function C(t){return{kind:"Set",target:{which:"command",value:t}}}function S(t){return{kind:"Set",target:{which:"motion",value:t}}}function k(t){return{kind:"Set",target:{which:"linewise",value:t}}}function x(t,e){return{kind:"Cap",child:t,action:e}}function w(t,e,n,i,o){var r=t;return r|=512,e&&(r|=1024),n&&(r|=2048),i&&(r|=4096),o&&(r|=8192),r}function P(t){return t<256}!function(t){var e,n;function i(t,e,n){for(var i=0,o=n;o<e.length;o++)i=10*i+(e[o]-"0".charCodeAt(0));t.count=i*(t.count||1)}t.integer=g(p(!0),(e=p(),n?{kind:"Plus",child:e}:{kind:"Star",child:e})),t.countPart=A(x(t.integer,i)),t.explicitCountPart=x(t.integer,i),t.linewisePart=A(v(g(f("v"),k(!1)),g(f("V"),k(!0)))),t.registerPart=A(m([t.countPart,f('"'),{kind:"Reg"}]))}(s||(s={}));var N={space:" ",lt:">",bslash:"\\",bar:"|"},I={bs:1,tab:2,cr:3,return:3,enter:3,esc:9,del:20,up:16,down:18,left:15,right:17,f1:59,f2:60,f3:61,f4:62,f5:63,f6:64,f7:65,f8:66,f9:67,f10:68,f11:69,f12:70,insert:19,home:14,end:13,pageup:11,pagedown:12,k0:93,k1:94,k2:95,k3:96,k4:97,k5:98,k6:99,k7:100,k8:101,k9:102,kplus:104,kminus:106,kmultiply:103,kdivide:108,kpoint:107},L=((a={})[1]="BS",a[2]="Tab",a[3]="CR",a[9]="Esc",a[20]="Del",a[16]="Up",a[18]="Down",a[15]="Left",a[17]="Right",a[59]="F1",a[60]="F2",a[61]="F3",a[62]="F4",a[63]="F5",a[64]="F6",a[65]="F7",a[66]="F8",a[67]="F9",a[68]="F10",a[69]="F11",a[70]="F12",a[19]="Insert",a[14]="Home",a[13]="End",a[11]="PageUp",a[12]="PageDown",a[93]="k0",a[94]="k1",a[95]="k2",a[96]="k3",a[97]="k4",a[98]="k5",a[99]="k6",a[100]="k7",a[101]="k8",a[102]="k9",a[104]="kPlus",a[106]="kMinus",a[103]="kMultiply",a[108]="kDivide",a[107]="kPoint",a),M={";":80,"=":81,",":82,"-":83,".":84,"/":85,"~":86,"[":87,"\\":88,"]":89,"'":90},E=((u={})[80]=";",u[81]="=",u[82]=",",u[83]="-",u[84]=".",u[85]="/",u[86]="~",u[87]="[",u[88]="\\",u[89]="]",u[90]="'",u),R="0".charCodeAt(0),_="9".charCodeAt(0),O="a".charCodeAt(0),B="z".charCodeAt(0);function V(t){if(1===t.length){var e=t.charCodeAt(0);if(e>=R&&e<=_)return e-R+21;if(e>=O&&e<=B)return e-O+31;if(M[t])return M[t]}return I[t]}function D(t){for(var e=[],n=0;n<t.length;n++){if("<"===t[n]){var i=t.indexOf(">",n+1);if(-1!==i){var o=t.substring(n+1,i).toLowerCase();if(void 0!==N[o])e.push(N[o].charCodeAt(0));else{var r=!1,s=!1,a=!1,u=!1;o.startsWith("c-")?(r=!0,o=o.substring(2)):o.startsWith("s-")?(s=!0,o=o.substring(2)):o.startsWith("a-")?(a=!0,o=o.substring(2)):o.startsWith("m-")&&(u=!0,o=o.substring(2));var c=V(o);if(void 0===c)throw new Error('Invalid vkey "'+o+'"');e.push(w(c,r,s,a,u))}n=i;continue}}e.push(t[n].charCodeAt(0))}return e}function W(t){return m(D(t).map(function(t){return f(t)}))}function T(t){if(P(t))return String.fromCharCode(t);var e="";(function(t){return 0!=(1024&t)})(t)&&(e+="C-"),function(t){return 0!=(2048&t)}(t)&&(e+="S-"),function(t){return 0!=(4096&t)}(t)&&(e+="A-"),function(t){return 0!=(8192&t)}(t)&&(e+="M-");var n=255&t,o=i.KeyCode[n];return E[n]?o=E[n]:L[n]?o=L[n]:o.startsWith("KEY_")&&(o=o.substring("KEY_".length)),e+o}var K,j=(K=function(t,e){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}K(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),U=w(9),F=function(){return function(t,e){this.name=t,this.displayName=e}}(),Q=function(t){function e(e,n,i){var o=t.call(this,e,n)||this;return o.context=i,o.inputs=[],o.remapping=null,o}return j(e,t),e.prototype.dispose=function(){this.program.reset()},e.prototype.reset=function(){this.inputs=[],this.remapping=null,this.program.reset()},e.prototype.discardInputBuffer=function(){this.reset()},e.prototype.handleInput=function(t,e){var n=this,i=0!==this.inputs.length;if(t===U&&i)return this.context.vimState.notifyKeyCanceled(this.inputs),this.reset(),this.context.vimState.notifyKeyBufferChanged(""),!0;if(this.inputs.push(t),i&&this.remapping?"Waiting"===this.remapping.status&&this.remapping.next(t):this.remapping=this.mapper.getRemapping(t),"End"===this.remapping.status){var o=this.remapping.value;return this.reset(),i&&this.context.vimState.notifyKeyBufferChanged(""),this.context.vimState.sendInput(o),!0}if("UserAction"===this.remapping.status){var r=this.remapping.userAction;return this.reset(),i&&this.context.vimState.notifyKeyBufferChanged(""),{handled:!0,job:function(){return r(n.context.editor)}}}var s=!0,a=!1,u=void 0,c=this.program.step(this.context.editor.getId(),t);if("Fail"===c.kind&&"Failed"===this.remapping.status){var d=this.inputs;this.reset(),i?(a=!0,this.context.vimState.notifyKeyFailed(d)):(s=P(t))&&(a=!0,this.context.vimState.notifyKeyFailed(d)),i&&this.context.vimState.notifyKeyBufferChanged("")}else if("Waiting"===c.kind||"Waiting"===this.remapping.status)this.context.vimState.notifyKeyWaiting(this.inputs),this.context.vimState.notifyKeyBufferChanged(this.inputs);else{if("Matched"!==c.kind)throw new Error;this.context.vimState.notifyKeyMatched(this.inputs),this.reset(),i&&this.context.vimState.notifyKeyBufferChanged("");var l=c.capture,f=l.command;if(!f)throw new Error("No command is set.");u=function(){return h(f,n.context,l)}}return{handled:s,failed:a,job:u}},e}(F);function q(t,e,n){var i=t;if(0!==e.length){for(var o=0;o<e.length-1;o++){var r=e[o],s=i.get(r);if(s){if(!(s instanceof Map))throw new Error("conflict: should be container node.")}else s=new Map,i.set(r,s);i=s}var a=e[e.length-1];if(i.has(a))throw new Error("conflict: key already exists.");i.set(a,n)}}function Z(t){for(var e=new Map,n=0,i=t;n<i.length;n++){var o=i[n];q(e,o.seq,o.val)}return e}for(var G=" \f\n\r\t\v​  ​᠎ ​ ​ ​ ​  ​ ​ ​  ​ ​\u2028\u2029  ​　\ufeff",H=new Set,Y=0;Y<"/\\()\"':,.;<>~!@#$%^&*|+=[]{}`?-".length;Y++)H.add("/\\()\"':,.;<>~!@#$%^&*|+=[]{}`?-".charCodeAt(Y));var J=new Set;for(Y=0;Y<G.length;Y++)J.add(G.charCodeAt(Y));var z=function(){function t(t){this.editor=t,this.wrap=!0;var e=t.getModel();if(!e)throw new Error;this.model=e}return t.create=function(e,n,i){var o=new t(e);return o._lineCount=o.model.getLineCount(),o._line="$"===n?o._lineCount:o.cc(n,o._lineCount),o._lineLength=o.model.getLineLength(o._line),o.setColumn(i),o},t.prototype.clone=function(){var e=new t(this.editor);return e.wrap=this.wrap,e._lineCount=this._lineCount,e._line=this._line,e._index=this._index,e._lineLength=this._lineLength,e._lineText=this._lineText,e._char=this._char,e._kind=this._kind,e},t.prototype.assign=function(t){return this.wrap=t.wrap,this._lineCount=t._lineCount,this._line=t._line,this._index=t._index,this._lineLength=t._lineLength,this._lineText=t._lineText,this._char=t._char,this._kind=t._kind,this},Object.defineProperty(t.prototype,"lineNumber",{get:function(){return this._line},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this._index+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineLength",{get:function(){return this._lineLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineCount",{get:function(){return this._lineCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineText",{get:function(){return void 0===this._lineText&&(this._lineText=this.model.getLineContent(this._line)),this._lineText},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"char",{get:function(){return void 0===this._char&&(this._char=this._index===this._lineLength?"":this.lineText[this._index]),this._char},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kind",{get:function(){var t;return void 0===this._kind&&(this._kind=this._index===this._lineLength?4:function(t){return t>="a".charCodeAt(0)&&t<="z".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t==="_".charCodeAt(0)}(t=this.lineText.charCodeAt(this._index))?1:J.has(t)?0:H.has(t)?2:3),this._kind},enumerable:!0,configurable:!0}),t.prototype.shouldWrap=function(t){return this.wrap=t,this},Object.defineProperty(t.prototype,"isBlank",{get:function(){return 0===this.kind||4===this.kind},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmptyLine",{get:function(){return 0===this._lineLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEOF",{get:function(){return this._line===this._lineCount&&this._index==this._lineLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBOF",{get:function(){return 1===this._line&&0===this._index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLastChar",{get:function(){return this._line===this._lineCount&&this._index+1>=this._lineLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLineLastChar",{get:function(){return this._index+1>=this._lineLength},enumerable:!0,configurable:!0}),t.prototype.cc=function(t,e){return t<1?1:t>e?e:t},t.prototype.resetCache=function(t){this._char=void 0,this._kind=void 0,t&&(this._lineText=void 0)},t.prototype.setColumn=function(t){var e;"^"===t?0===(e=this.model.getLineFirstNonWhitespaceColumn(this._line))&&(e=Math.max(1,this.model.getLineLength(this._line))):e="g_"===t?Math.max(1,this.model.getLineLastNonWhitespaceColumn(this._line)-1):"$"===t?Math.max(1,this.model.getLineLength(this._line)):"eol"===t?this.model.getLineMaxColumn(this._line):this.cc(t,this._lineLength+1);var n=e-1;return this._index!==n&&(this._index=n,this.resetCache(!1)),this},t.prototype.forward=function(){if(0===this._lineLength||this._index===this._lineLength){if(this._line===this.lineCount||!this.wrap)return!1;this._line+=1,this._index=0,this._lineLength=this.model.getLineLength(this._line),this.resetCache(!0)}else this._index++,this.resetCache(!1);return!0},t.prototype.backward=function(){if(0===this._index){if(1===this._line||!this.wrap)return!1;this._line-=1,this._lineLength=this.model.getLineLength(this._line),this._index=this._lineLength,this.resetCache(!0)}else this._index--,this.resetCache(!1);return!0},t.prototype.move=function(t){if(t>0)for(;0!==t&&this.forward();)t--;else if(t<0)for(;0!==t&&this.backward();)t++;return this},t.prototype.soft=function(){var t=this._index===this._lineLength?Math.max(0,this._lineLength-1):this._index;return this._index!==t&&(this._index=t,this.resetCache(!1)),this},t.prototype.stepIf=function(t){for(var e=this.clone(),n=this.clone(),i=0;n.forward()&&t(n);)e.assign(n),i++;return this.assign(e),i},t.prototype.stepTo=function(t,e){void 0===e&&(e=!0);for(var n=this.clone(),i=this.clone(),o=!1;i.forward();)if(n.assign(i),t(i)){o=!0;break}return(o||e)&&this.assign(n),o},t.prototype.stepTill=function(t,e){void 0===e&&(e=!0);for(var n=this.clone(),i=this.clone(),o=!1;i.forward();){if(t(i)){o=!0;break}n.assign(i)}return(o||e)&&this.assign(n),o},t.prototype.backIf=function(t){for(var e=this.clone(),n=this.clone(),i=0;n.backward()&&t(n);)e.assign(n),i++;return this.assign(e),i},t.prototype.backTo=function(t,e){void 0===e&&(e=!0);for(var n=this.clone(),i=this.clone(),o=!1;i.backward();)if(n.assign(i),t(i)){o=!0;break}return(o||e)&&this.assign(n),o},t.prototype.backTill=function(t,e){void 0===e&&(e=!0);for(var n=this.clone(),i=this.clone(),o=!1;i.backward();){if(t(i)){o=!0;break}n.assign(i)}return(o||e)&&this.assign(n),o},t.prototype.toRange=function(){return i.Range.fromPositions(this,this)},t.prototype.toSelection=function(t){return t=t||this,i.Selection.fromPositions(t,this)},t.prototype.reveal=function(t){void 0===t&&(t=0);var e=this.toRange();switch(t){case 0:this.editor.revealRange(e);break;case 1:this.editor.revealRangeInCenter(e);break;case 2:this.editor.revealRangeInCenterIfOutsideViewport(e);break;case 3:this.editor.revealRangeAtTop(e);break;case 4:this.editor._revealRange(e,4,!0,0)}return this},t.prototype.live=function(t){switch(void 0===t&&(t=0),t){case 0:this.editor.setPosition(this);break;case 1:this.setEditorPrimaryCurosr();break;case 2:this.setEditorPrimarySelectionActive()}return this},t.prototype.setEditorPrimaryCurosr=function(){var t=this.editor.getSelections();t&&0!==t.length&&(t[0]=this.toSelection(),this.editor.setSelections(t))},t.prototype.setEditorPrimarySelectionActive=function(){var t=this.editor.getSelections();if(t&&0!==t.length){var e={lineNumber:t[0].selectionStartLineNumber,column:t[0].selectionStartColumn};t[0]=this.toSelection(e),this.editor.setSelections(t)}},t}(),X=function(){function t(t){this.editor=t}return Object.defineProperty(t.prototype,"model",{get:function(){var t=this.editor.getModel();if(!t)throw new Error;return t},enumerable:!0,configurable:!0}),t.prototype.get=function(t,e){if(void 0===t){var n=this.editor.getPosition();if(!n)throw new Error;return z.create(this.editor,n.lineNumber,n.column)}return void 0!==t&&void 0!==e?z.create(this.editor,t,e):z.create(this.editor,t.lineNumber,t.column)},t.prototype.soften=function(t){return z.create(this.editor,t.lineNumber,t.column).soft()},t}(),$=function(){function t(){}return t.findNextWordStart=function(t,e,n,i,o,r){void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===r&&(r=!1);t.getModel();var s=z.create(t,e.lineNumber,e.column),a=!s.isBlank;if(i)for(;n&&!s.isEOF;)s.isBlank||s.stepTo(function(t){return t.isBlank}),a&&1===n&&o||s.stepTo(function(t){return!t.isBlank||t.isEmptyLine}),n--;else for(;n&&!s.isEOF;)s.isBlank||s.stepTo(function(t){return t.kind!=s.kind}),a&&1===n&&o||s.isBlank&&s.stepTo(function(t){return!t.isBlank||t.isEmptyLine}),n--;if(r&&s.lineNumber!==e.lineNumber){for(var u=!0,c=s.clone();c.backward();)if(0!==c.kind){4!==c.kind&&(u=!1);break}return u?c:s}return s},t.findNextWordEnd=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();for(var o=z.create(t,e.lineNumber,e.column);n&&!o.isEOF;)o.forward(),o.isBlank&&o.stepTo(function(t){return!t.isBlank}),o.stepIf(i?function(t){return!t.isBlank}:function(t){return t.kind===o.kind}),n--;return o},t.findPrevWordStart=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();var o=z.create(t,e.lineNumber,e.column);if(o.isBOF)return!1;for(;n&&!o.isBOF;)o.backward(),o.isBlank&&o.backTo(function(t){return!t.isBlank||t.isEmptyLine}),o.isEmptyLine||o.backIf(i?function(t){return!t.isBlank}:function(t){return t.kind===o.kind}),n--;return o},t.findPrevWordEnd=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();var o=z.create(t,e.lineNumber,e.column);if(o.isBOF)return!1;if(i)for(;n&&!o.isBOF;)o.isBlank&&!o.isEmptyLine||o.backTo(function(t){return t.isBlank}),o.isEmptyLine||o.backTo(function(t){return!t.isBlank||t.isEmptyLine}),n--;else for(;n&&!o.isBOF;)o.isBlank&&!o.isEmptyLine||o.backTo(function(t){return t.kind!=o.kind}),o.isBlank&&!o.isEmptyLine&&o.backTo(function(t){return!t.isBlank||t.isEmptyLine}),n--;return o},t.findOuterWord=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();for(var o=z.create(t,e.lineNumber,e.column),r=1,s=!1,a=o.clone();r<=n&&!o.isEOF;)1===r?(0===o.kind?(o.backIf(function(t){return 0===t.kind}),s=!0):o.backIf(i?function(t){return 0!==t.kind}:function(t){return t.kind===o.kind}),a.assign(o)):o.forward(),0===o.kind?o.stepTo(function(t){return!t.isBlank}):s=!1,o.stepIf(i?function(t){return!t.isBlank}:function(t){return t.kind===o.kind}),s||r!==n||0===o.stepIf(function(t){return 0===t.kind})&&0!==a.kind&&a.shouldWrap(!1).backTill(function(t){return!t.isBlank},!1),r++;return{from:a,position:o.soft()}},t.findInnerWord=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();var o=z.create(t,e.lineNumber,e.column),r=1,s=o.clone();for(s.shouldWrap(!1).backIf(s.isBlank?function(t){return t.isBlank}:i?function(t){return!t.isBlank}:function(t){return t.kind===o.kind});r<=n&&!o.isEOF;)1!==r&&o.forward(),o.stepIf(o.isBlank?function(t){return 0===t.kind}:i?function(t){return!t.isBlank}:function(t){return t.kind===o.kind}),r++;return{from:s,position:o.soft()}},t.markQuotePairs=function(t,e,n){t.getModel();for(var i,o=z.create(t,e.lineNumber,e.column).shouldWrap(!1).setColumn(1),r=[];o.forward();){var s=o.char;s===n?void 0===i?i=o.column:(r.push([i,o.column]),i=void 0):"\\"===s&&o.forward()}return r},t.findOuterQuote=function(e,n,i){e.getModel();for(var o=n.column,r=0,s=t.markQuotePairs(e,n,i);r<s.length;r++){var a=s[r];if(a[1]>=o){var u=n.lineNumber;return{from:{lineNumber:u,column:a[0]},position:{lineNumber:u,column:a[1]}}}}return!1},t.findInnerQuote=function(e,n,i){for(var o=n.column,r=0,s=t.markQuotePairs(e,n,i);r<s.length;r++){var a=s[r];if(a[1]>=o){var u=n.lineNumber,c=a[0],d=a[1];return c+1!==d&&(c++,d--),{from:{lineNumber:u,column:c},position:{lineNumber:u,column:d}}}}return!1},t.getWordToSearch=function(t,e){var n,o=t.getModel(),r=z.create(t,e.lineNumber,e.column).shouldWrap(!1).clone();if(1===r.kind){var s=r.clone();r.backIf(function(t){return 1===t.kind}),s.stepTo(function(t){return 1!==t.kind}),n=o.getValueInRange(i.Range.fromPositions(r,s))}else{if(r.stepTo(function(t){return 1===t.kind},!1))(s=r.clone()).stepTo(function(t){return 1!==t.kind}),n=o.getValueInRange(i.Range.fromPositions(r,s));else if(r.isBlank){if(r.stepTo(function(t){return!t.isBlank}))(s=r.clone()).stepTo(function(t){return t.isBlank}),n=o.getValueInRange(i.Range.fromPositions(r,s))}else{var s=r.clone();r.backIf(function(t){return!t.isBlank}),s.stepTo(function(t){return t.isBlank}),n=o.getValueInRange(i.Range.fromPositions(r,s))}}return{start:r,searchString:n}},t}(),tt=new Map;var et=function(){function t(t){var e=this;this.editor=t,this.editorId=this.editor.getId(),this.editor.onDidDispose(function(){tt.delete(e.editorId)}),this.editor.onDidChangeModelContent(function(t){e.matchRanges=void 0,e.pattern=void 0})}return Object.defineProperty(t.prototype,"model",{get:function(){var t=this.editor.getModel();if(!t)throw new Error("ICodeEditor.getModel() returns null.");return t},enumerable:!0,configurable:!0}),t.create=function(e){var n=e.getId(),i=tt.get(n);return i||(i=new t(e),tt.set(n,i)),i},t.prototype.search=function(t){if(!this.matchRanges||!this.pattern||(n=this.pattern,i=t,n.searchString!==i.searchString||n.isRegex!==i.isRegex||n.matchCase!==i.matchCase||n.wholeWord!==i.wholeWord)){var e=this.model.findMatches(t.searchString,!1,t.isRegex,t.matchCase,t.wholeWord?this.editor.getConfiguration().wordSeparators:null,!1);this.matchRanges=e.map(function(t){return t.range}),this.pattern=t}var n,i;return this.matchRanges},t}(),nt=function(){function t(){}return t.search=function(t,e,n,i,o){return void 0===o&&(o=1),"forward"===i?this.searchNext(t,e,n,o):this.searchPrev(t,e,n,o)},t.searchNext=function(t,e,n,i){void 0===i&&(i=1);var o=et.create(t.editor).search(n);if(0===o.length)return null;for(;i>0;){for(var r=!1,s=0,a=o;s<a.length;s++){var u=a[s];if(u.startLineNumber>e.lineNumber||u.startLineNumber===e.lineNumber&&u.startColumn>e.column){r=!0,e=u.getStartPosition();break}}r||(e=o[0].getStartPosition()),i--}return e},t.searchPrev=function(t,e,n,i){void 0===i&&(i=1);var o=et.create(t.editor).search(n);if(0===o.length)return null;for(;i>0;){for(var r=!1,s=o.length-1;s>=0;s--){var a=o[s];if(a.startLineNumber<e.lineNumber||a.startLineNumber===e.lineNumber&&a.endColumn<=e.column){r=!0,e=a.getStartPosition();break}}r||(e=o[o.length-1].getStartPosition()),i--}return e},t}(),it=function(){function t(){this.seqMap=Z([])}return t.prototype.add=function(t,e){try{q(this.seqMap,t,e)}catch(t){}},t.prototype.addString=function(t,e){try{this.add(D(t),D(e))}catch(t){}},t.prototype.addUserAction=function(t,e){try{q(this.seqMap,D(t),e)}catch(t){}},t.prototype.addEditorAction=function(t,e){try{q(this.seqMap,D(t),function(t){var n=t.getAction(e);if(n)return n.run()})}catch(t){}},t.prototype.clear=function(){this.seqMap.clear()},t.prototype.getRemapping=function(t){return new ot(t,this.seqMap.get(t))},t}(),ot=function(){function t(t,e){this._keys=[t],this._status=this.statusFromSearch(e)}return t.prototype.statusFromSearch=function(t){return void 0===t?{kind:"Failed"}:"function"==typeof t?{kind:"UserAction",value:t}:Array.isArray(t)?{kind:"End",value:t}:{kind:"Waiting",value:t}},Object.defineProperty(t.prototype,"status",{get:function(){return this._status.kind},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){if("End"===this._status.kind)return this._status.value;throw new Error},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAction",{get:function(){if("UserAction"===this._status.kind)return this._status.value;throw new Error},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalKeys",{get:function(){return this._keys},enumerable:!0,configurable:!0}),t.prototype.next=function(t){if("Waiting"!==this._status.kind)throw new Error;this._keys.push(t),this._status=this.statusFromSearch(this._status.value.get(t))},t}(),rt=new(function(){return function(){this.startInInsertMode=!1,this.ignoreCase=!1,this.smartCase=!0,this.nmap=new it,this.vmap=new it}}()),st=function(){function t(){}return t.findClosing=function(t,e,n,i){for(var o=t.position.get(e),r=0;!o.isEOF;){var s=o.char;if(s===n[1])if(0===r){if(1===i)return o;i--}else r--;else s===n[0]&&r++;o.forward()}},t.findOpening=function(t,e,n,i){var o=t.position.get(e),r=0;do{var s=o.char;if(s===n[0])if(0===r){if(1===i)return o;i--}else r--;else s===n[1]&&r++}while(o.backward())},t.findOuterPair=function(e,n,i,o){var r=t.findOpening(e,n,i,o);if(!r)return!1;var s=t.findClosing(e,n,i,o);return!(!r||!s)&&{from:r,position:s}},t.findInnerPair=function(e,n,i,o){var r=t.findOpening(e,n,i,o);if(!r)return!1;var s=t.findClosing(e,n,i,o);return!(!r||!s)&&t.getInnerPariRange(r,s)},t.getInnerPariRange=function(t,e){if(t.forward(),!i.Position.isBefore(t,e))return!1;var n=!1;4===t.kind&&t.lineNumber+1<e.lineNumber&&(t.clone().setColumn("^").column===e.column&&(t.forward(),e.setColumn(1),n=!0));return e.backward(),{from:t,position:e,linewise:n}},t}(),at=function(t,e,n){return{lineNumber:e.lineNumber,column:1}},ut={left:function(t,e,n){return 1!==e.column&&t.position.get(e.lineNumber,e.column-n)},right:function(t,e,n,i){var o=t.position.get(e).shouldWrap(!1);if("Move"===i){if(o.isLineLastChar)return!1}else if("Select"===i&&4===o.kind)return!1;return t.position.get(o.lineNumber,o.column+n)},EOL:function(t,e,n,i){return{position:t.position.get(e.lineNumber+n-1,"Select"===i?"eol":"$"),inclusive:!0,desiredColumnAtEol:!0}},word:function(t,e,n,i){return $.findNextWordStart(t.editor,e,n,!1,!1,"Operator"===i)},fullWord:function(t,e,n,i){return $.findNextWordStart(t.editor,e,n,!0,!1,"Operator"===i)},altWord:function(t,e,n){return $.findNextWordStart(t.editor,e,n,!1,!0)},altFullWord:function(t,e,n){return $.findNextWordStart(t.editor,e,n,!0,!0)}};var ct=function(t){var e=[],n=function(n){var i=t[n];n.split(", ").map(function(t){return D(t)}).forEach(function(t){return e.push({seq:t,val:i})})};for(var i in t)n(i);return Z(e)}({"h, <Left>, <BS>":ut.left,"l, <Right>, <Space>":ut.right,"<Home>":at,"^":function(t,e,n){return t.position.get(e.lineNumber,"^")},"$, <End>":ut.EOL,g_:function(t,e,n){return{position:t.position.get(e.lineNumber+n-1,"g_"),inclusive:!0}},"k, <Up>":function(t,e,n,i){return 1!==e.lineNumber&&{position:t.position.get(e.lineNumber-n,t.vimState.desiredColumn),keepPrevDesiredColumn:!0,linewise:!0}},"j, <Down>":function(t,e,n,i){return e.lineNumber!==t.model.getLineCount()&&{position:t.position.get(e.lineNumber+n,t.vimState.desiredColumn),keepPrevDesiredColumn:!0,linewise:!0}},"gk, g<Up>":function(t,e,n){return t.editor.trigger("vim","cursorMove",{to:"up",select:!1,by:"wrappedLine",value:n}),t.editor.getPosition()},"gj, g<Down>":function(t,e,n){return t.editor.trigger("vim","cursorMove",{to:"down",select:!1,by:"wrappedLine",value:n}),t.editor.getPosition()},"-":function(t,e,n,i){return{position:t.position.get(e.lineNumber-n,"^"),linewise:!0}},"+, <CR>, <C-M>":function(t,e,n,i){return{position:t.position.get(e.lineNumber+n,"^"),linewise:!0}},_:function(t,e,n,i){return{position:t.position.get(e.lineNumber+n-1,"^"),linewise:!0}},G:function(t,e,n,i,o){return{position:t.position.get(o?"$":n,"^"),linewise:!0}},"<C-End>":function(t,e,n,i,o){return{position:t.position.get(o?"$":n,"$"),inclusive:!0}},"gg, <C-Home>":function(t,e,n,i,o){return{position:t.position.get(o?1:n,"^"),linewise:!0}},w:ut.word,W:ut.fullWord,e:function(t,e,n){var i=$.findNextWordEnd(t.editor,e,n);return!!i&&{position:i,inclusive:!0}},E:function(t,e,n){var i=$.findNextWordEnd(t.editor,e,n,!0);return!!i&&{position:i,inclusive:!0}},b:function(t,e,n){return $.findPrevWordStart(t.editor,e,n)},B:function(t,e,n){return $.findPrevWordStart(t.editor,e,n,!0)},ge:function(t,e,n){var i=$.findPrevWordEnd(t.editor,e,n);return!!i&&{position:i,inclusive:!0}},gE:function(t,e,n){var i=$.findPrevWordEnd(t.editor,e,n,!0);return!!i&&{position:i,inclusive:!0}},H:function(t,e,n,i){var o,r=t.editor.getVisibleRanges()[0];o=1===r.startColumn?r.startLineNumber:r.startLineNumber!==r.endLineNumber?r.startLineNumber+1:r.startLineNumber;var s=Math.min(r.endLineNumber,o+n-1);return{position:t.position.get(s,"^"),linewise:!0}},M:function(t,e,n,i){var o=t.editor.getVisibleRanges()[0],r=o.startLineNumber,s=o.endLineNumber,a=r+Math.floor((s-r)/2);return{position:t.position.get(a,"^"),linewise:!0}},L:function(t,e,n,i){var o,r=t.editor.getVisibleRanges()[0];o=1===r.startColumn?r.startLineNumber:r.startLineNumber!==r.endLineNumber?r.startLineNumber+1:r.startLineNumber;var s=Math.max(r.endLineNumber-n+1,o);return{position:t.position.get(s,"^"),linewise:!0}},"*":function(t,e,n){var i=$.getWordToSearch(t.editor,e),o=i.start,r=i.searchString;if(r){var s={searchString:r,wholeWord:!0,isRegex:!1,matchCase:!rt.ignoreCase};t.globalState.lastSearch={direction:"forward",pattern:s};var a=nt.searchNext(t,o,s,n);if(a)return a}return!1},"g*":function(t,e,n){var i=$.getWordToSearch(t.editor,e),o=i.start,r=i.searchString;if(r){var s={searchString:r,wholeWord:!1,isRegex:!1,matchCase:!rt.ignoreCase};t.globalState.lastSearch={direction:"forward",pattern:s};var a=nt.searchNext(t,o,s,n);if(a)return a}return!1},"#":function(t,e,n){var i=$.getWordToSearch(t.editor,e),o=i.start,r=i.searchString;if(r){var s={searchString:r,wholeWord:!0,isRegex:!1,matchCase:!rt.ignoreCase};t.globalState.lastSearch={direction:"backward",pattern:s};var a=nt.searchPrev(t,o,s,n);if(a)return a}return!1},"g#":function(t,e,n){var i=$.getWordToSearch(t.editor,e),o=i.start,r=i.searchString;if(r){var s={searchString:r,wholeWord:!1,isRegex:!1,matchCase:!rt.ignoreCase};t.globalState.lastSearch={direction:"backward",pattern:s};var a=nt.searchPrev(t,o,s,n);if(a)return a}return!1},n:function(t,e,n){var i=t.globalState.lastSearch;if(!i)return t.vimState.outputError("No previous regular expression"),!1;var o=nt.search(t,e,i.pattern,"forward"===i.direction?"forward":"backward",n);return o||!1},N:function(t,e,n){var i=t.globalState.lastSearch;if(!i)return t.vimState.outputError("No previous regular expression"),!1;var o=nt.search(t,e,i.pattern,"forward"===i.direction?"backward":"forward",n);return o||!1}}),dt={f:function(t){return function(e,n,i,o){e.globalState.lastCharMotion={kind:"f",char:t};var r=n.lineNumber,s=(n.column,e.model.getLineContent(r));if(n.column>=s.length)return!1;for(var a=n.column-1;i&&-1!==a;)a=s.indexOf(t,a+1),i--;return-1!==a&&{position:{lineNumber:r,column:a+1},inclusive:!0}}},F:function(t){return function(e,n,i,o){e.globalState.lastCharMotion={kind:"F",char:t};var r=n.lineNumber,s=(n.column,e.model.getLineContent(r));if(1===n.column)return!1;for(var a=n.column-1;i&&-1!==a;)a=0===a?-1:s.lastIndexOf(t,a-1),i--;return-1!==a&&{lineNumber:r,column:a+1}}},t:function(t){return function(e,n,i,o){e.globalState.lastCharMotion={kind:"t",char:t};var r=n.lineNumber,s=n.column,a=e.model.getLineContent(r);if(s>=a.length)return!1;for(var u=n.column-1;i&&-1!==u;)u=a.indexOf(t,u+1),i--;return-1!==u&&{position:{lineNumber:r,column:s=u+1-1},inclusive:!0}}},T:function(t){return function(e,n,i,o){e.globalState.lastCharMotion={kind:"T",char:t};for(var r=n.lineNumber,s=(n.column,e.model.getLineContent(r)),a=n.column-1;i&&-1!==a;)a=0===a?-1:s.lastIndexOf(t,a-1),i--;return-1!==a&&{lineNumber:r,column:a+1+1}}}},lt=x({kind:"Char"},function(t,e,n){var i=String.fromCharCode(e[n]);t.motion=dt.f(i)}),ht=x({kind:"Char"},function(t,e,n){var i=String.fromCharCode(e[n]);t.motion=dt.F(i)}),ft=x({kind:"Char"},function(t,e,n){var i=String.fromCharCode(e[n]);t.motion=dt.t(i)}),pt=x({kind:"Char"},function(t,e,n){var i=String.fromCharCode(e[n]);t.motion=dt.T(i)}),gt=S(function(t,e,n,i,o){var r=t.globalState.lastCharMotion;return!!r&&dt[r.kind](r.char)(t,e,n,i,o)}),mt=S(function(t,e,n,i){var o=t.globalState.lastCharMotion;if(!o)return!1;return dt[{f:"F",F:"f",t:"T",T:"t"}[o.kind]](o.char)(t,e,n,i)}),vt=y([g(f("0"),S(at)),g(s.countPart,y([b(ct,function(t,e){return t.motion=e}),g(f("f"),lt),g(f("F"),ht),g(f("t"),ft),g(f("T"),pt),g(f(";"),gt),g(f(","),mt)])),m([s.explicitCountPart,f("%"),S(function(t,e,n){var i=t.model.getLineCount(),o=Math.floor((n*i+99)/100);return{position:t.position.get(o,"^"),linewise:!0}})])]);function yt(t){return!1!==t&&(t.inclusive=!0,t)}var At={aw:function(t,e,n){return yt($.findOuterWord(t.editor,e,n))},aW:function(t,e,n){return yt($.findOuterWord(t.editor,e,n,!0))},iw:function(t,e,n){return yt($.findInnerWord(t.editor,e,n))},iW:function(t,e,n){return yt($.findInnerWord(t.editor,e,n,!0))},"a'":function(t,e){return yt($.findOuterQuote(t.editor,e,"'"))},'a"':function(t,e){return yt($.findOuterQuote(t.editor,e,'"'))},"a`":function(t,e){return yt($.findOuterQuote(t.editor,e,"`"))},"i'":function(t,e){return yt($.findInnerQuote(t.editor,e,"'"))},'i"':function(t,e){return yt($.findInnerQuote(t.editor,e,'"'))},"i`":function(t,e){return yt($.findInnerQuote(t.editor,e,"`"))},"a(, a), ab":function(t,e,n){return yt(st.findOuterPair(t,e,["(",")"],n))},"i(, i), ib":function(t,e,n){return yt(st.findInnerPair(t,e,["(",")"],n))},"a{, a}, aB":function(t,e,n){return yt(st.findOuterPair(t,e,["{","}"],n))},"i{, i}, iB":function(t,e,n){return yt(st.findInnerPair(t,e,["{","}"],n))},"a[, a]":function(t,e,n){return yt(st.findOuterPair(t,e,["[","]"],n))},"i[, i]":function(t,e,n){return yt(st.findInnerPair(t,e,["[","]"],n))},"a<, a>":function(t,e,n){return yt(st.findOuterPair(t,e,["<",">"],n))},"i<, i>":function(t,e,n){return yt(st.findInnerPair(t,e,["<",">"],n))}};var bt,Ct=g(s.countPart,b(function(t){var e=[],n=function(n){var i=t[n];n.split(", ").map(function(t){return D(t)}).forEach(function(t){return e.push({seq:t,val:i})})};for(var i in t)n(i);return Z(e)}(At),function(t,e){return t.motion=e})),St=function(){function t(t,e){this.text=t,this.linewise=e}return t.prototype.repeatText=function(t){if(!this.linewise)return this.text.repeat(t);for(var e="";t>0;)e+=this.text+(1===t?"":"\n"),t--;return e},t}(),kt=new(function(){function t(){this.numbered=[],this.named=[]}return t.prototype.convertToId=function(e){return e==='"'.charCodeAt(0)?t.UNNAMED_ID:e==="_".charCodeAt(0)?t.BLACKHOLD_ID:e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)?e-"0".charCodeAt(0):e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)?e-"a".charCodeAt(0)+10:e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)?e-"A".charCodeAt(0)+100:void 0},t.prototype.storeText=function(e,n,i){if(i!==t.BLACKHOLD_ID){var o=new St(e,n);if(this.unnamed=o,"yank"===i||i===t.UNNAMED_ID)this.numbered[0]=o;else if("delete"===i){for(var r=9;r>1;r--)this.numbered[r]=this.numbered[r-1];this.numbered[1]=o}else if(i>=0&&i<=9)this.numbered[i]=o;else if(i>=10&&i<=35)this.named[i-10]=o;else{if(!(i>=100&&i<=125))throw new Error("Invalid id.");var s=this.named[i-100];s&&(s.linewise||o.linewise?(o.linewise=!0,o.text=s.text+"\n"+o.text):o.text=s.text+o.text),this.named[i-100]=o}}},t.prototype.getText=function(e){if(e!==t.BLACKHOLD_ID){if(void 0===e||e===t.UNNAMED_ID)return this.unnamed;if(e>=0&&e<=9)return this.numbered[e];if(e>=10&&e<=35)return this.named[e-10];if(e>=100&&e<=125)return this.named[e-10];throw new Error("Invalid id.")}},t.UNNAMED_ID=-1,t.BLACKHOLD_ID=-2,t}()),xt=new(function(){function t(){this.list=[],this.map=new Map}return t.prototype.put=function(t){var e=this.map.get(t);if(void 0!==e)return e;this.list.push(t);var n=this.list.length-1;return this.map.set(t,n),n},t.prototype.get=function(t){return this.list[t]},t}()),wt=function(){function t(){this._ref=1,this.positions=[]}return t.prototype.ref=function(){return this._ref+=1,this},t.prototype.cloneIfNeed=function(){if(this._ref>1){var e=new t;return e.command=this.command,e.count=this.count,e.motion=this.motion,e.linewise=this.linewise,e.positions=this.positions.slice(),e.keyMap=this.keyMap,e.register=this.register,this._ref--,e}return this},t.prototype.setCommand=function(t){var e=this.cloneIfNeed();return e.command=t,e},t.prototype.setMotion=function(t){var e=this.cloneIfNeed();return e.motion=t,e},t.prototype.setCount=function(t){var e=this.cloneIfNeed();return e.count=t,e},t.prototype.setLinewise=function(t){var e=this.cloneIfNeed();return e.linewise=t,e},t.prototype.setRegister=function(t){var e=this.cloneIfNeed();return e.register=t,e},t.prototype.pushPositon=function(t){var e=this.cloneIfNeed();return e.positions.push(t),e},t.prototype.popPositon=function(){var t=this.cloneIfNeed(),e=t.positions.pop();if(void 0===e)throw new Error("Array.pop fail.");return{value:e,state:t}},t.prototype.setMap=function(t){var e=this.cloneIfNeed();return e.keyMap=t,e},t.prototype.resetMap=function(){var t=this.cloneIfNeed();return t.keyMap=void 0,t},t}(),Pt=function(){return function(t,e){this.pc=t,this.state=e}}(),Nt=function(){function t(t){this.inputs=[],this.threads=[],this.source=null,this.code=new Int16Array(function t(e){switch(e.kind){case"Key":return 2;case"Digit":case"Char":case"Reg":return 1;case"Cat":return t(e.left)+t(e.right);case"Alt":return 4+t(e.left)+t(e.right);case"Opt":case"Plus":return 2+t(e.child);case"Star":return 4+t(e.child);case"Seq":return 3;case"Set":return 2;case"Cap":return 3+t(e.child)}}(t)+1);var e=function t(e,n,i){var o;var r;switch(i.kind){case"Key":return e[n]=bt.Key,e[n+1]=i.key,2;case"Digit":return e[n]=i.nonZero?bt.NonZeroDigit:bt.Digit,1;case"Char":return e[n]=bt.Char,1;case"Reg":return e[n]=bt.Register,1;case"Cat":return(o=t(e,n,i.left))+t(e,n+o,i.right);case"Alt":return o=t(e,n+2,i.left),r=t(e,n+o+4,i.right),e[n]=bt.Split,e[n+1]=o+4,e[n+o+2]=bt.Jump,e[n+o+3]=r+2,o+r+4;case"Opt":return o=t(e,n+2,i.child),e[n]=bt.Split,e[n+1]=o+2,o+2;case"Plus":return o=t(e,n,i.child),e[n+o]=bt.Split,e[n+o+1]=-o,o+2;case"Star":return o=t(e,n+2,i.child),e[n]=bt.Split,e[n+1]=o+4,e[n+o+2]=bt.Jump,e[n+o+3]=-(o+2),o+4;case"Seq":return e[n]=bt.Seq,e[n+1]=xt.put(i.target),e[n+2]=xt.put(i.action),3;case"Set":switch(i.target.which){case"command":e[n]=bt.SetCommand,e[n+1]=xt.put(i.target.value);break;case"motion":e[n]=bt.SetMotion,e[n+1]=xt.put(i.target.value);break;case"linewise":e[n]=bt.SetLinewise,e[n+1]=i.target.value?1:0}return 2;case"Cap":return e[n]=bt.Push,o=t(e,n+1,i.child),e[n+o+1]=bt.Pop,e[n+o+2]=xt.put(i.action),o+3}}(this.code,0,t);this.code[e]=bt.End,this.execNextInst(new Pt(0,new wt))}return t.prototype.getInputs=function(){return this.inputs},t.prototype.getSource=function(){return this.source},t.prototype.isWaiting=function(){return 0!==this.inputs.length},t.prototype.step=function(t,e){this.source&&this.source!==t&&(this.reset(),this.source=t),this.inputs.push(e);var n=this.threads;this.threads=[];for(var i=0;i<n.length;i++){var o=n[i];switch(this.code[o.pc]){case bt.Key:if(this.code[o.pc+1]===e&&(o.pc+=2,this.execNextInst(o)))return this.matched(o);break;case bt.Digit:if(e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)&&(o.pc+=1,this.execNextInst(o)))return this.matched(o);break;case bt.NonZeroDigit:if(e>="1".charCodeAt(0)&&e<="9".charCodeAt(0)&&(o.pc+=1,this.execNextInst(o)))return this.matched(o);break;case bt.Char:if(P(e)&&(o.pc+=1,this.execNextInst(o)))return this.matched(o);break;case bt.Register:var r=kt.convertToId(e);if(void 0!==r&&(o.state=o.state.setRegister(r),o.pc+=1,this.execNextInst(o)))return this.matched(o);break;case bt.Seq:var s=(o.state.keyMap||xt.get(this.code[o.pc+1])).get(e);if(void 0!==s)if(s instanceof Map)o.state=o.state.setMap(s),this.threads.push(o);else{if(o.state=o.state.resetMap(),!0===xt.get(this.code[o.pc+2])(o.state,s))return this.matched(o);if(o.pc+=3,this.execNextInst(o))return this.matched(o)}break;default:throw new Error("Unexpected behavior.")}}var a=this.inputs;return 0===this.threads.length?(this.reset(),{kind:"Fail",inputs:a}):{kind:"Waiting",inputs:a}},t.prototype.reset=function(){this.inputs=[],this.threads=[],this.source=null,this.execNextInst(new Pt(0,new wt))},t.prototype.matched=function(t){var e=this.inputs;return this.reset(),{kind:"Matched",inputs:e,capture:t.state}},t.prototype.execNextInst=function(t){var e=t.pc;switch(this.code[e]){case bt.End:return!0;case bt.Key:case bt.Digit:case bt.Char:case bt.NonZeroDigit:case bt.Register:case bt.Seq:this.threads.push(t);break;case bt.SetCommand:return t.state=t.state.setCommand(xt.get(this.code[e+1])),t.pc+=2,this.execNextInst(t);case bt.SetMotion:return t.state=t.state.setMotion(xt.get(this.code[e+1])),t.pc+=2,this.execNextInst(t);case bt.SetLinewise:return t.state=t.state.setLinewise(1===this.code[e+1]),t.pc+=2,this.execNextInst(t);case bt.Push:return t.state=t.state.pushPositon(this.inputs.length),t.pc+=1,this.execNextInst(t);case bt.Pop:var n=t.state.popPositon();return t.state=n.state,xt.get(this.code[e+1])(t.state,this.inputs,n.value),t.pc+=2,this.execNextInst(t);case bt.Jump:return t.pc=e+this.code[e+1],this.execNextInst(t);case bt.Split:t.pc+=2;var i=this.execNextInst(t),o=this.execNextInst(new Pt(e+this.code[e+1],t.state.ref()));if(i||o)throw new Error('"Split" direct to end state.')}return!1},t}();function It(t){return 1===t.endColumn&&t.startLineNumber!==t.endLineNumber?[t.startLineNumber,t.endLineNumber-1]:[t.startLineNumber,t.endLineNumber]}function Lt(t){if("LineRange"===t.kind)return t.lines;if("CharRange"===t.kind)return It(t.range);throw new Error}function Mt(t,e){if("LineRange"===e.kind)return function(t,e){var n={lineNumber:e[0],column:1},o={lineNumber:e[1],column:t.model.getLineMaxColumn(e[1])};return i.Range.fromPositions(n,o)}(t,e.lines);if("CharRange"===e.kind)return i.Range.lift(e.range);throw new Error}function Et(t){return{kind:"General",commandArgs:t}}function Rt(t,e){return{kind:"CharRange",commandArgs:t,range:e}}function _t(t,e){var n,i;return Array.isArray(e)?n=e:(n=It(e),i=e),{kind:"LineRange",commandArgs:t,range:i,lines:n}}!function(t){t[t.End=0]="End",t[t.Key=1]="Key",t[t.Digit=2]="Digit",t[t.NonZeroDigit=3]="NonZeroDigit",t[t.Char=4]="Char",t[t.Register=5]="Register",t[t.Split=6]="Split",t[t.Jump=7]="Jump",t[t.Push=8]="Push",t[t.Pop=9]="Pop",t[t.Seq=10]="Seq",t[t.SetCommand=11]="SetCommand",t[t.SetMotion=12]="SetMotion",t[t.SetLinewise=13]="SetLinewise"}(bt||(bt={}));var Ot=function(t,e,n){return{position:t.position.get(e.lineNumber+n-1,1),linewise:!0}};function Bt(t){return i.Selection.createWithDirection(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn,i.SelectionDirection.RTL)}function Vt(t,e){return t<1?1:t>e?e:t}function Dt(t,e,n){var o;Array.isArray(e)||(e=[e]),t.model.pushEditOperations(t.editor.getSelections(),e,function(){var t=n();return o=[i.Selection.fromPositions(t,t)]}),t.editor.setSelections(o)}for(var Wt=function(t,e,n){var o,r,s=t.vimState.getMode();if("LineRange"===e.kind){var a=t.position.get(e.lines[0],1),u=a.clone().shouldWrap(!1);0===u.kind&&u.stepTo(function(t){return 0!==t.kind});var c=t.position.get(e.lines[1],"eol"),d=i.Range.fromPositions(a,c);kt.storeText(t.model.getValueInRange(d),!0,e.commandArgs.register||"delete"),d=i.Range.fromPositions(u,c),n&&("Visual"!==s&&"VisualLine"!==s||(r=e.lines[1]-e.lines[0]+1,n=l(function(t,e){var n=t.position.get().lineNumber,i=Math.min(t.model.getLineCount(),n+r-1);Wt(t,_t(e,[n,i]))}))),Dt(t,{range:d,text:""},function(){return u}),n&&t.vimState.toInsert({command:n,args:e.commandArgs},"none")}else{if("CharRange"!==e.kind)throw new Error;var h=i.Range.lift(e.range);if(kt.storeText(t.model.getValueInRange(h),!1,e.commandArgs.register||"delete"),n&&("Visual"===s||"VisualLine"===s)){var f=t.model.getValueLengthInRange(h);o=f,n=l(function(t,e){var n=t.position.get(),r=n.clone().move(o),s=i.Range.fromPositions(n,r);Wt(t,Rt(e,s))})}Dt(t,{range:h,text:""},function(){return h.getStartPosition()}),n&&t.vimState.toInsert({command:n,args:e.commandArgs},"none")}},Tt=function(t,e){Wt(t,e,this)},Kt=function(t,e,n){if("General"===e.kind){var o=t.position.get(),r=t.position.get(o.lineNumber,o.column+(e.commandArgs.count||1));Dt(t,[{range:i.Range.fromPositions(o,r),text:n.repeat(r.column-o.column)}],function(){return r.move(-1)})}else{var s=Mt(t,e);Dt(t,function(t,e){if(e.startLineNumber==e.endLineNumber)return[i.Range.lift(e)];var n=[],o=e.startLineNumber;for(n.push(new i.Range(o,e.startColumn,o,t.getLineMaxColumn(o))),o+=1;o<e.endLineNumber;o++)n.push(new i.Range(o,1,o,t.getLineMaxColumn(o)));return 1!==e.endColumn&&n.push(new i.Range(o,1,o,e.endColumn)),n}(t.model,s).map(function(t){return{range:t,text:n.repeat(t.endColumn-t.startColumn)}}),function(){return s.getStartPosition()})}},jt=function(t,e,n){var o=Lt(e),r=t.model.getLineCount();if(o[0]!==r){o[0]===o[1]&&(o[1]=o[1]+1);var s=o[1]-o[0],a=o[0],u=0;if(n){for(;0!==s;){var c=t.position.get(a,"eol");1===s&&(u=c.column);var d=i.Range.fromPositions(c,{lineNumber:a+1,column:1});t.editor.executeEdits("vim",[{range:d,text:""}]),s--}t.editor.setPosition(t.position.get(o[0],u).soft())}else{for(;0!==s;){var l=(c=t.position.get(a,"$")).isBlank;c.setColumn("eol"),1===s&&(u=c.column);var h=t.position.get(a+1,1).shouldWrap(!1);0===h.kind&&h.stepTo(function(t){return 0!==t.kind});d=i.Range.fromPositions(c,h);var f=l||")"===h.char?"":" ";t.editor.executeEdits("vim",[{range:d,text:f}]),s--}t.editor.setPosition(t.position.get(a,u).soft())}}},Ut=function(t,e,n){var o=kt.getText(e.commandArgs.register);if(o){var r,s=t.model.getLineCount(),a=t.model.getValueLength(),u=o.repeatText(e.commandArgs.count||1);if("LineRange"===e.kind){var c=t.position.get(e.lines[0],0),d=t.position.get(e.lines[1],"eol");r=i.Range.fromPositions(c,d),kt.storeText(t.model.getValueInRange(r),!0,"delete")}else if("CharRange"===e.kind)r=i.Range.lift(e.range),kt.storeText(t.model.getValueInRange(r),!1,"delete"),o.linewise&&(u="\n"+u+"\n");else{var l=t.position.get();if(o.linewise){var h=t.position.get(l.lineNumber,"eol");r=i.Range.fromPositions(h,h),u="\n"+u}else{h=t.position.get(l.lineNumber,l.column+1);r=i.Range.fromPositions(h,h)}}Dt(t,{range:r,text:u},function(){var e,i=r.getStartPosition();if(o.linewise){var u=i.lineNumber+1,c="^";if(!0===n)u+=t.model.getLineCount()-s,c=1;e=t.position.get(u,c)}else{var d=t.model.getOffsetAt(i),l=t.model.getValueLength()-a;!0===n?d+=l+1:t.model.getLineCount()===s?d+=l:d+=1,e=t.model.getPositionAt(d-1)}return e})}},Ft=function(t,e,n){var o=kt.getText(e.commandArgs.register);if(o){var r=t.position.get(),s=t.model.getLineCount(),a=t.model.getValueLength(),u=e.commandArgs.count||1;if(o.linewise){for(var c="";u>0;)c+=o.text+"\n",u--;var d={lineNumber:r.lineNumber,column:1},l=i.Range.fromPositions(d,d);Dt(t,{range:l,text:c},function(){var e=r.lineNumber,i="^";!0===n&&(e+=t.model.getLineCount()-s,i=1);return t.position.get(e,i).soft()})}else{c="";for(var h=e.commandArgs.count||1;h>0;)c+=o.text,h--;l=i.Range.fromPositions(r,r);Dt(t,{range:l,text:c},function(){var e=t.model.getOffsetAt(r);return e+=t.model.getValueLength()-a,!0===n&&(e+=1),t.position.soften(t.model.getPositionAt(e-1))})}}},Qt=[],qt=[],Zt=[],Gt=function(t){var e=t.action,n=void 0,i=!1!==t.isEdit,o=i&&!1!==t.shouldRecord;if(t.ncmd){var r={action:e,isEdit:i,shouldRecord:o,acceptMotion:!1};"string"==typeof t.ncmd?Qt.push({seq:D(t.ncmd),val:r}):Array.isArray(t.ncmd)&&t.ncmd.forEach(function(t){return Qt.push({seq:D(t),val:r})})}if(t.nkey){n=D(t.nkey),Qt.push({seq:n,val:{action:e,isEdit:i,shouldRecord:o,acceptMotion:!0}});var s=t.nline;if(s){var a=m(n.map(function(t){return f(t)}));!0===s?qt.push([a,a,e,i,o]):"string"==typeof s?qt.push([a,W(s),e,i,o]):s.forEach(function(t){qt.push([a,W(t),e,i,o])})}}if(t.synonym)for(var u in t.synonym){var c=t.synonym[u];Qt.push({seq:D(u),val:{action:e,isEdit:i,shouldRecord:o,acceptMotion:c}})}t.vkey&&("string"==typeof t.vkey?Zt.push({seq:D(t.vkey),val:{action:e,isEdit:i,shouldRecord:o,linewise:!1}}):t.vkey.forEach(function(t){return Zt.push({seq:D(t),val:{action:e,isEdit:i,shouldRecord:o,linewise:!1}})})),t.vline&&("string"==typeof t.vline?Zt.push({seq:D(t.vline),val:{action:e,isEdit:i,shouldRecord:o,linewise:!0}}):t.vline.forEach(function(t){return Zt.push({seq:D(t),val:{action:e,isEdit:i,shouldRecord:o,linewise:!0}})}))},Ht=0,Yt=[{action:function(t,e){if("LineRange"===e.kind)!function(t,e,n,o){var r=t.model.getLineCount();n=Vt(n,r),o=Vt(o,r);var s=t.model.getLineMaxColumn(o);if(1===r&&1===o&&1===s)return 1;var a,u=i.Range.fromPositions({lineNumber:n,column:1},t.position.get(o,"eol"));if(kt.storeText(t.model.getValueInRange(u),!0,e||"delete"),1===n&&o===r)return t.editor.setValue(""),1;a=o!==r?new i.Range(n,1,o+1,1):i.Range.fromPositions(t.position.get(n-1,"eol"),t.position.get(o,"eol"));var c=o===r?n-1:n;Dt(t,{range:a,text:""},function(){return t.position.get(c,"^")})}(t,e.commandArgs.register,e.lines[0],e.lines[1]);else{if("CharRange"!==e.kind)throw new Error;kt.storeText(t.model.getValueInRange(e.range),!1,e.commandArgs.register||"delete");var n=t.position.get(e.range.startLineNumber,e.range.startColumn);4===t.position.get(e.range.endLineNumber,e.range.endColumn).kind&&n.shouldWrap(!1).move(-1),Dt(t,{range:i.Range.lift(e.range),text:""},function(){return n})}},nkey:"d",nline:!0,vkey:["d","x","<Del>","<BS>"],vline:["X","D"],synonym:{x:ut.right,"<Del>":ut.right,X:ut.left,D:ut.EOL}},{action:jt,vkey:"J",synonym:{J:Ot}},{action:Tt,shouldRecord:!1,nkey:"c",nline:!0,vkey:["c","s"],vline:["C","S","R"],synonym:{C:ut.EOL,s:ut.right,S:Ot}},{action:function(t,e){jt(t,e,!0)},vkey:"gJ",synonym:{gJ:Ot}},{action:function(t,e){var n=Mt(t,e),i=t.model.getValueInRange(n);i=i.toLowerCase(),Dt(t,{range:n,text:i},function(){return t.position.soften(n.getStartPosition())})},nkey:"gu",nline:["gu","u"],vkey:["gu","u"]},{action:function(t,e){var n=Mt(t,e),i=t.model.getValueInRange(n);i=i.toUpperCase(),Dt(t,{range:n,text:i},function(){return t.position.soften(n.getStartPosition())})},nkey:"gU",nline:["gU","U"],vkey:["gU","U"]},{action:function(t,e){var n,o;if("General"===e.kind){var r=t.position.get(),s=t.position.get(r.lineNumber,r.column+(e.commandArgs.count||1));n=i.Range.fromPositions(r,s),o=s.soft()}else n=Mt(t,e),o=t.position.soften(n.getStartPosition());for(var a="",u=t.model.getValueInRange(n),c=0;c<u.length;c++){var d=u[c],l=d.toLowerCase();l===d&&(l=d.toUpperCase()),a+=l}Dt(t,{range:n,text:a},function(){return o})},ncmd:"~",nkey:"g~",nline:["g~","~"],vkey:["g~","~"]},{action:function(t,e){var n=t.model.getAlternativeVersionId(),o=t.position.get(),r=t.vimState.getMode(),s=Lt(e);if("Visual"!==r&&"VisualLine"!==r){var a=i.Range.fromPositions(t.position.get(),t.position.get(s[1],"eol"));t.editor.setSelection(Bt(a))}var u=1;for("Visual"!==r&&"VisualLine"!==r||(u=e.commandArgs.count||1);0!==u;)t.editor.trigger("vim","editor.action.indentLines",null),u--;var c=t.model.getAlternativeVersionId(),d=t.position.get(s[0],"^");t.editor.setPosition(d),t.vimState.addHistoryPatch(n,c,o,d)},nkey:">",vkey:">",nline:!0},{action:function(t,e){var n=t.model.getAlternativeVersionId(),o=t.position.get(),r=t.vimState.getMode(),s=Lt(e);if("Visual"!==r&&"VisualLine"!==r){var a=i.Range.fromPositions(t.position.get(),t.position.get(s[1],"eol"));t.editor.setSelection(Bt(a))}var u=1;for("Visual"!==r&&"VisualLine"!==r||(u=e.commandArgs.count||1);0!==u;)t.editor.trigger("vim","editor.action.outdentLines",null),u--;var c=t.model.getAlternativeVersionId(),d=t.position.get(s[0],"^");t.editor.setPosition(d),t.vimState.addHistoryPatch(n,c,o,d)},nkey:"<",vkey:"<",nline:!0},{action:function(t,e){var n=t.vimState.getMode(),o=Lt(e);if("Visual"!==n&&"VisualLine"!==n){var r=i.Range.fromPositions(t.position.get(),t.position.get(o[1],"eol"));t.editor.setSelection(Bt(r))}var s=t.editor.getAction("editor.action.formatSelection");if(!s)throw new Error;return s.run().then(function(){t.editor.setPosition(t.position.get(o[0],"^"))})},nkey:"=",vkey:"=",nline:!0},{action:function(t,e){var n=Mt(t,e),i=t.model.getValueInRange(n);kt.storeText(i,"LineRange"===e.kind,e.commandArgs.register||"yank"),"Visual"!==t.vimState.getMode()&&"VisualLine"!==t.vimState.getMode()||t.editor.setPosition(n.getStartPosition())},isEdit:!1,nkey:"y",nline:!0,vkey:"y",vline:"Y",synonym:{Y:Ot}},{action:Ut,ncmd:"p",vkey:"p"},{action:function(t,e){Ut(t,e,!0)},ncmd:"gp",vkey:"gp"},{action:Ft,ncmd:"P"},{action:function(t,e){Ft(t,e,!0)},ncmd:"gP",vkey:"gP"}];Ht<Yt.length;Ht++){Gt(Yt[Ht])}var Jt=b(Z(Qt),function(t,e){var n=e,r=n.shouldRecord;return t.command=l({shouldRecord:r,run:function(t,e){var r;if("boolean"!=typeof n.acceptMotion&&(e.motion=n.acceptMotion),!1!==n.acceptMotion){n.action===Tt&&e.motion===ut.word?e.motion=ut.altWord:n.action===Tt&&e.motion===ut.fullWord&&(e.motion=ut.altFullWord);var s=o("Operator",t,e);if(!s.to)return;if(void 0!==e.linewise?e.linewise:!0===s.linewise)r=_t(e,[s.from.lineNumber,s.to.lineNumber]);else r=Rt(e,i.Range.fromPositions(s.from,s.inclusive?t.position.get(s.to).move(1):s.to))}else r=Et(e);return n.isEdit&&t.editor.pushUndoStop(),te(this,n.action,t,r,function(){n.isEdit&&t.editor.pushUndoStop(),t.editor.revealPosition(t.position.get())})}}),!0!==n.acceptMotion});Jt=m([Jt,s.linewisePart,v(vt,Ct)]);var zt=y(qt.map(function(t){return m([t[0],s.countPart,t[1],C((e=t[2],n=t[3],i=t[4],l({shouldRecord:i,run:function(t,i){var o=t.position.get().lineNumber,r=Math.min(t.model.getLineCount(),o+(i.count||1)-1);n&&t.editor.pushUndoStop();var s=_t(i,[o,r]);return te(this,e,t,s,function(){n&&t.editor.pushUndoStop(),t.editor.revealPosition(t.position.get())})}})))]);var e,n,i})),Xt=y([Jt,zt,g(f("r"),x({kind:"Char"},function(t,e,n){var i=String.fromCharCode(e[n]);t.command=l({shouldRecord:!0,run:function(t,e){var n=Et(e);t.editor.pushUndoStop(),Kt(t,n,i),t.editor.pushUndoStop(),t.editor.revealPosition(t.position.get())}})}))]),$t=v(g(f("r"),x({kind:"Char"},function(t,e,n){var i=String.fromCharCode(e[n]);t.command=l(function(t,e){t.position.get();var n=t.editor.getSelection();if(!n)throw new Error;var o="VisualLine"===t.vimState.getMode()?_t(e,n):Rt(e,n);t.editor.pushUndoStop(),Kt(t,o,i),t.editor.pushUndoStop(),t.editor.revealPosition(t.position.get())})})),b(Z(Zt),function(t,e){var n=e.isEdit;t.command=l(function(t,o){var r,s,a,u=this,c=e.action,h=(t.position.get(),t.editor.getSelection());if(!h)throw new Error;if(r="VisualLine"===t.vimState.getMode()?_t(o,[h.startLineNumber,h.endLineNumber]):!0===e.linewise?_t(o,h):Rt(o,h),n&&t.editor.pushUndoStop(),c!==Tt){var f,p=Object.assign({},o);if("LineRange"===r.kind)a=r.lines[1]-r.lines[0]+1,f=l(function(t,e){var n=t.position.get().lineNumber,i=Math.min(t.model.getLineCount(),n+a-1);return c.apply(u,[t,_t(e,[n,i])])});else{if("CharRange"!==r.kind)throw new Error;s=t.model.getValueLengthInRange(r.range),f=l(function(t,e){var n=t.position.get(),o=n.clone().move(s),r=i.Range.fromPositions(n,o);return c.apply(u,[t,Rt(e,r)])})}d.setLast(f,p)}return te(this,c,t,r,function(){n&&t.editor.pushUndoStop(),t.editor.revealPosition(t.position.get()),c!==Tt&&t.vimState.toNormal()})})}));function te(t,e,n,i,o){return r(e.apply(t,[n,i]),o)}var ee={"z<CR>":function(t){var e=t.vimState.isVisual()?2:1;t.position.get().setColumn("^").reveal(3).live(e)},zt:function(t){t.position.get().reveal(3)},"z.":function(t){var e=t.vimState.isVisual()?2:1;t.position.get().setColumn("^").reveal(1).live(e)},zz:function(t){t.position.get().reveal(1)},"z-":function(t){var e=t.vimState.isVisual()?2:1;t.position.get().setColumn("^").reveal(4).live(e)},zb:function(t){t.position.get().reveal(4)}},ne=[];for(var ie in ee){var oe=C(l(ee[ie]));ne.push(g(W(ie),oe))}var re=y(ne),se=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ae=(w(9),{i:function(t,e){t.editor.revealPosition(t.editor.getPosition()),t.vimState.toInsert({command:this,args:e},"text")},I:function(t,e){var n=t.editor.getPosition(),i=t.position.get(n.lineNumber,"^");t.editor.setPosition(i),t.editor.revealPosition(i),t.vimState.toInsert({command:this,args:e},"text")},a:function(t,e){t.editor.getPosition();var n=t.position.get().shouldWrap(!1).move(1);t.editor.setPosition(n),t.editor.revealPosition(n),t.vimState.toInsert({command:this,args:e},"text")},A:function(t,e){var n=t.editor.getPosition(),i=t.position.get(n.lineNumber,"eol");t.editor.setPosition(i),t.editor.revealPosition(i),t.vimState.desiredColumn="eol",t.vimState.toInsert({command:this,args:e},"text")},o:function(t,e){t.editor.getAction("editor.action.insertLineAfter").run();t.editor.getPosition();t.vimState.toInsert({command:this,args:e},"command")},O:function(t,e){t.editor.getAction("editor.action.insertLineBefore").run();t.editor.getPosition();t.vimState.toInsert({command:this,args:e},"command")},v:function(t,e){var n=e.count||0,o=t.position.get(),r=o.clone().shouldWrap(!1).move(n);t.vimState.toVisual(i.Selection.fromPositions(o,r))},V:function(t,e){var n=e.count||1,i=t.editor.getPosition().lineNumber,o=i+n-1;t.vimState.toVisualLine({first:i,last:o})},gv:function(t,e){var n=t.vimState.previousVisual;if(void 0===n)t.vimState.beep();else if("char"===n.kind){var o=t.position.get(n.start),r=t.position.get(n.end);t.vimState.toVisual(i.Selection.fromPositions(o,r))}else t.vimState.toVisualLine(n)},u:function(t,e){for(var n=e.count||1,i=t.model.getAlternativeVersionId();0!==n;){var o=t.vimState.undo();if(i===o){t.vimState.beep();break}i=o,n--}var r=t.editor.getSelection();if(r&&!r.isEmpty()){var s=t.position.get(r.positionLineNumber,r.positionColumn).soft();t.editor.setPosition(s)}},"<C-R>":function(t,e){for(var n=e.count||1,i=t.model.getAlternativeVersionId();0!==n;){var o=t.vimState.redo();if(i===o){t.vimState.beep();break}i=o,n--}},".":function(t,e){d.repeatLast(t,e.count)},gd:function(t,e){t.editor.trigger("vim","editor.action.goToDeclaration",null)},gh:function(t,e){t.editor.trigger("vim","editor.action.showHover",null)},"/":function(t,e){ue(t,e,"forward","/")},"?":function(t,e){ue(t,e,"backward","?")}});function ue(t,e,n,i){t.vimState.requestExternalInput(i,function(){}).then(function(i){if(i){var o=!rt.ignoreCase;if(i.startsWith("\\c"))o=!1,i=i.substring(2);else if(i.startsWith("\\C"))o=!0,i=i.substring(2);else if(rt.ignoreCase&&rt.smartCase)for(var r=0;r<i.length;r++){var s=i.charCodeAt(r);if(s==="\\".charCodeAt(0))r++;else if(s>="A".charCodeAt(0)&&s<="Z".charCodeAt(0)){o=!0;break}}if(0!==i.length){var a={searchString:i,wholeWord:!1,isRegex:!0,matchCase:o};t.globalState.lastSearch={direction:n,pattern:a};var u=t.editor.getPosition(),c=nt.searchNext(t,u,a,e.count);if(c){var d=t.position.soften(c);t.editor.setPosition(d),t.editor.revealPosition(d)}else t.vimState.outputError("找不到模式: "+i)}}})}var ce=l(function(t,e){t.vimState.isMovingCursorByMotion=!0;var n=o("Move",t,e);if(n.to){var i=t.position.get(n.to.lineNumber,n.to.column).soft();t.editor.setPosition(i),t.editor.revealPosition(i),!0!==n.keepPrevDesiredColumn&&(t.vimState.desiredColumn=n.desiredColumnAtEol?"eol":n.to.column)}else t.vimState.beep();t.vimState.isMovingCursorByMotion=!1});var de=function(){var t=[];for(var e in ae){var n=C(l(ae[e]));t.push(g(W(e),n))}var i=v(g(vt,C(ce)),g(s.countPart,y([y(t),Xt,re])));return new Nt(g(s.registerPart,i))}(),le=function(t){function e(e){var n=t.call(this,"Normal","Normal",e)||this;return n.subscriptions=[],n}return se(e,t),Object.defineProperty(e.prototype,"program",{get:function(){return de},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapper",{get:function(){return rt.nmap},enumerable:!0,configurable:!0}),e.prototype.enter=function(){var t=this;this.context.editor.updateOptions({cursorStyle:"block"});var e=this.context.position.get().soft();this.context.editor.setPosition(e),this.subscriptions.push(this.context.editor.onDidChangeCursorPosition(function(e){return t.onCursorChanged(e)})),this.subscriptions.push(this.context.editor.onDidChangeCursorSelection(function(e){return t.onSelectionChanged(e)}))},e.prototype.leave=function(){this.dispose()},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0,n=this.subscriptions;e<n.length;e++){n[e].dispose()}this.subscriptions=[]},e.prototype.onCursorChanged=function(t){},e.prototype.onSelectionChanged=function(t){if(t.reason!==i.editor.CursorChangeReason.Undo&&t.reason!==i.editor.CursorChangeReason.Redo){if(!this.context.vimState.isExecutingCommand)if(t.selection.isEmpty()){e=this.context.position.soften(t.selection.getStartPosition());this.context.editor.setPosition(e)}else this.context.vimState.toInsert()}else{var e=this.context.position.soften(t.selection.getPosition());this.context.editor.setPosition(e)}},e}(Q),he=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),fe=function(){function t(t,e){this.beforeAction=t,this.change=e,this.kind="none"}return t.prototype.setCount=function(t){this.beforeAction&&(this.beforeAction.args.count=t)},t.prototype.getCount=function(){return this.beforeAction&&this.beforeAction.args.count?this.beforeAction.args.count:1},t.prototype.execBeforeAction=function(t){if(this.beforeAction)return h(this.beforeAction.command,t,this.beforeAction.args)},t.prototype.execute=function(t){var e=this;return r(this.execBeforeAction(t),function(){if(e.change){var n=t.model.getOffsetAt(t.editor.getPosition()),o=Math.max(0,n-e.change.deleteBefore),r=t.model.getPositionAt(o),s=t.model.getPositionAt(Math.min(t.model.getValueLength(),n+e.change.deleteAfter)),a=i.Range.fromPositions(r,s),u=e.change.text;t.editor.executeEdits("vim",[{range:a,text:u}]);var c=t.model.getPositionAt(o+u.length);t.editor.setPosition(c)}t.editor.pushUndoStop(),me(t)})},t.prototype.commitInsertion=function(t){},t}(),pe=function(){function t(t,e,n){void 0===n&&(n=1),this.beforeAction=t,this.change=e,this.count=n,this.kind="text"}return t.prototype.setCount=function(t){this.count=t},t.prototype.getCount=function(){return this.count},t.prototype.execBeforeAction=function(t){if(this.beforeAction)return h(this.beforeAction.command,t,this.beforeAction.args)},t.prototype.execute=function(t){var e=this;return r(this.execBeforeAction(t),function(){if(e.change)for(var n=e.count;0!==n;){var o=t.model.getOffsetAt(t.editor.getPosition()),r=Math.max(0,o-e.change.deleteBefore),s=t.model.getPositionAt(r),a=t.model.getPositionAt(Math.min(t.model.getValueLength(),o+e.change.deleteAfter)),u=i.Range.fromPositions(s,a),c=e.change.text;t.editor.executeEdits("vim",[{range:u,text:c}]);var d=t.model.getPositionAt(r+c.length);t.editor.setPosition(d),n--}t.editor.pushUndoStop(),me(t)})},t.prototype.commitInsertion=function(t){if(this.change){for(var e=this.count-1;0!==e;){var n=t.model.getOffsetAt(t.editor.getPosition()),o=Math.max(0,n-this.change.deleteBefore),r=t.model.getPositionAt(o),s=t.model.getPositionAt(Math.min(t.model.getValueLength(),n+this.change.deleteAfter)),a=i.Range.fromPositions(r,s),u=this.change.text;t.editor.executeEdits("vim",[{range:a,text:u}]);var c=t.model.getPositionAt(o+u.length);t.editor.setPosition(c),e--}t.editor.pushUndoStop()}},t}(),ge=function(){function t(t,e,n){void 0===n&&(n=1),this.beforeAction=t,this.change=e,this.count=n,this.kind="command"}return t.prototype.setCount=function(t){this.count=t},t.prototype.getCount=function(){return this.count},t.prototype.execBeforeAction=function(t){if(this.beforeAction)return h(this.beforeAction.command,t,this.beforeAction.args)},t.prototype.execute=function(t){for(var e=this,n=this.count;0!==n;)r(this.execBeforeAction(t),function(){if(e.change){var n=t.model.getOffsetAt(t.editor.getPosition()),o=Math.max(0,n-e.change.deleteBefore),r=t.model.getPositionAt(o),s=t.model.getPositionAt(Math.min(t.model.getValueLength(),n+e.change.deleteAfter)),a=i.Range.fromPositions(r,s),u=e.change.text;t.editor.executeEdits("vim",[{range:a,text:u}]);var c=t.model.getPositionAt(o+u.length);t.editor.setPosition(c)}}),n--;t.editor.pushUndoStop(),me(t)},t.prototype.commitInsertion=function(t){for(var e=this,n=this.count-1;0!==n;)r(this.execBeforeAction(t),function(){if(e.change){var n=t.model.getOffsetAt(t.editor.getPosition()),o=Math.max(0,n-e.change.deleteBefore),r=t.model.getPositionAt(o),s=t.model.getPositionAt(Math.min(t.model.getValueLength(),n+e.change.deleteAfter)),a=i.Range.fromPositions(r,s),u=e.change.text;t.editor.executeEdits("vim",[{range:a,text:u}]);var c=t.model.getPositionAt(o+u.length);t.editor.setPosition(c)}}),n--;t.editor.pushUndoStop()},t}();function me(t,e){e=e||t.editor.getPosition();var n=t.position.get(e).shouldWrap(!1).move(-1);t.editor.setPosition(n),t.editor.revealPosition(n),t.vimState.toNormal()}var ve=function(t){function e(e){var n=t.call(this,"Insert","Insert")||this;return n.context=e,n.repeatable="none",n.subscriptions=[],n.insertionPoint=e.model.getOffsetAt(e.editor.getPosition()),n}return he(e,t),e.prototype.enter=function(t,e){var n=this;void 0===e&&(e="none"),this.context.editor.updateOptions({cursorStyle:"line"}),this.context.vimState.isRepeating||(this.beforeAction=t,this.repeatable=e,this.insertionPoint=this.context.model.getOffsetAt(this.context.editor.getPosition()),this.subscriptions.push(this.context.editor.onDidChangeCursorPosition(function(t){return n.onCursorPositionChanged(t)})),this.subscriptions.push(this.context.editor.onDidChangeCursorSelection(function(t){return n.onSelectionChanged(t)})),this.subscriptions.push(this.context.model.onDidChangeContent(function(t){return n.onContentChanged(t)})))},e.prototype.leave=function(){this.change=void 0,this.repeatable="none",this.dispose()},e.prototype.dispose=function(){for(var t=0,e=this.subscriptions;t<e.length;t++){e[t].dispose()}this.subscriptions=[]},e.prototype.discardInputBuffer=function(){},e.prototype.handleInput=function(t,e){return t===w(9)?(this.commitChangeRecord(),me(this.context),!0):!(e||!P(t))&&(this.context.editor.trigger("vim","type",{text:String.fromCharCode(t)}),!0)},e.prototype.onCursorPositionChanged=function(t){t.reason===i.editor.CursorChangeReason.Explicit&&(this.stageChangeRecord(),this.insertionPoint=this.context.model.getOffsetAt(this.context.editor.getPosition()),this.repeatable="text")},e.prototype.onSelectionChanged=function(t){},e.prototype.onContentChanged=function(t){if(0!==t.changes.length){if(t.changes.length>1)return this.stageChangeRecord(),void(this.insertionPoint=this.context.model.getOffsetAt(this.context.editor.getPosition()));this.change||(this.change={textStart:this.insertionPoint,textEnd:this.insertionPoint,deletionBefore:0,deletionAfter:0});var e=t.changes[0].rangeOffset,n=t.changes[0].rangeOffset+t.changes[0].rangeLength,i=t.changes[0].rangeLength,o=t.changes[0].text.length,r=this.change.textEnd-this.change.textStart;if(e>this.change.textEnd||n<this.change.textStart)return this.stageChangeRecord(),void(this.insertionPoint=this.context.model.getOffsetAt(this.context.editor.getPosition()));if(this.stagedRepeatAction=void 0,e<this.change.textStart){var s=this.change.textStart-e;this.change.deletionBefore+=s,this.change.textStart=e,i-=s}if(n>this.change.textEnd){s=n-this.change.textEnd;this.change.deletionAfter+=s,i-=s}this.change.textEnd=this.change.textStart+r+o-i}},e.prototype.commitChangeRecord=function(){if(this.stageChangeRecord(),this.stagedRepeatAction){var t=this.stagedRepeatAction;t.commitInsertion(this.context),d.setLastAction(t),this.stagedRepeatAction=void 0}},e.prototype.stageChangeRecord=function(){if(!this.stagedRepeatAction){var t=this.beforeAction;this.beforeAction=void 0;var e=(t?t.args.count:1)||1,n=this.change;this.change=void 0;var o,r=this.repeatable;if(this.repeatable="none",n){var s="";if(n.textStart!==n.textEnd){var a=this.context.model.getPositionAt(n.textStart),u=this.context.model.getPositionAt(n.textEnd),c=i.Range.fromPositions(a,u);s=this.context.model.getValueInRange(c)}o={text:s,deleteBefore:n.deletionBefore,deleteAfter:n.deletionBefore}}return"none"===r?this.stagedRepeatAction=new fe(t,o):"command"===r?this.stagedRepeatAction=new ge(t,o,e):"text"===r&&(this.stagedRepeatAction=new pe(t,o,e)),this.stagedRepeatAction}},e}(F),ye=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ae=(w(9),l(function(t,e){t.vimState.isMovingCursorByMotion=!0;var n=t.editor.getSelection(),r={lineNumber:n.selectionStartLineNumber,column:n.selectionStartColumn},s=o("Select",t,e,{lineNumber:n.positionLineNumber,column:n.positionColumn});if(s.to){var a=s.inclusive?t.position.get(s.to).move(1):s.to;!0!==s.keepPrevDesiredColumn&&(t.vimState.desiredColumn=s.desiredColumnAtEol?"eol":s.to.column),t.vimState.previousVisual={kind:"char",start:r,end:a};var u=i.Selection.fromPositions(r,a);t.editor.setSelection(u),t.editor.revealPosition(a),t.vimState.isMovingCursorByMotion=!1}else t.vimState.beep()})),be=l(function(t,e){t.vimState.isMovingCursorByMotion=!0;var n=t.editor.getSelection(),r=o("Select",t,e,{lineNumber:n.positionLineNumber,column:n.positionColumn});if(r.to){var s=t.position.get(r.to).move(1);!0!==r.keepPrevDesiredColumn&&(t.vimState.desiredColumn=r.desiredColumnAtEol?"eol":r.to.column);var a=i.Range.fromPositions(r.from,s);i.Range.areIntersectingOrTouching(n,a)&&(a=i.Range.plusRange(n,a)),t.vimState.previousVisual={kind:"char",start:a.getStartPosition(),end:a.getEndPosition()},t.editor.setSelection(a),t.editor.revealPosition(s),t.vimState.isMovingCursorByMotion=!1}else t.vimState.beep()}),Ce=l(function(t,e){var n=t.editor.getSelection(),o={lineNumber:n.positionLineNumber,column:n.positionColumn},r={lineNumber:n.selectionStartLineNumber,column:n.selectionStartColumn},s=i.Selection.fromPositions(o,r);t.vimState.previousVisual={kind:"char",start:o,end:r},t.editor.setSelection(s),t.editor.revealRange(s)}),Se=l(function(t,e){t.vimState.toNormal()}),ke=l(function(t,e){var n=t.editor.getSelection();t.vimState.toVisualLine({first:n.selectionStartLineNumber,last:n.positionLineNumber})});var xe,we=(xe=y([g(vt,C(Ae)),g(Ct,C(be)),g(s.countPart,y([$t,re,g(f("o"),C(Ce)),g(W("<ESC>"),C(Se)),g(f("v"),C(Se)),g(f("V"),C(ke))]))]),new Nt(xe)),Pe=function(t){function e(e){var n=t.call(this,"Visual","Visual",e)||this;return n.subscriptions=[],n}return ye(e,t),Object.defineProperty(e.prototype,"program",{get:function(){return we},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapper",{get:function(){return rt.vmap},enumerable:!0,configurable:!0}),e.prototype.enter=function(t){var e=this;t&&(this.context.editor.setSelection(t),this.context.editor.revealRange(t),this.updateDecoration(t)),this.context.editor.updateOptions({cursorStyle:"line"}),this.subscriptions.push(this.context.editor.onDidChangeCursorSelection(function(t){return e.onSelectionChanged(t)}))},e.prototype.leave=function(){this.decorations&&(this.decorations=this.context.editor.deltaDecorations(this.decorations,[])),this.dispose()},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0,n=this.subscriptions;e<n.length;e++){n[e].dispose()}this.subscriptions=[]},e.prototype.onSelectionChanged=function(t){var e=t.selection;this.context.vimState.isMovingCursorByMotion||e.isEmpty()&&this.context.vimState.toNormal(),this.updateDecoration(e)},e.prototype.updateDecoration=function(t){if(t.isEmpty()&&this.decorations)this.decorations=this.context.editor.deltaDecorations(this.decorations,[]);else{var e=t.getDirection()===i.SelectionDirection.LTR,n=t.getPosition();this.decorations=this.context.editor.deltaDecorations(this.decorations||[],[{range:{startLineNumber:n.lineNumber,startColumn:Math.max(1,e?n.column-1:n.column),endLineNumber:n.lineNumber,endColumn:e?n.column:n.column+1},options:{stickiness:i.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,className:"visual-mode-fake-cursor"}}])}},e}(Q),Ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ie=(w(9),l(function(t,e){t.vimState.isMovingCursorByMotion=!0;var n=t.editor.getSelection();if(n){var r={lineNumber:n.selectionStartLineNumber,column:n.selectionStartColumn},s=o("Select",t,e,{lineNumber:n.positionLineNumber,column:n.positionColumn});if(s.to){var a,u=s.inclusive?t.position.get(s.to).move(1):s.to;if(!0!==s.keepPrevDesiredColumn&&(t.vimState.desiredColumn=s.desiredColumnAtEol?"eol":s.to.column),r.lineNumber<=u.lineNumber){var c=t.position.get(r.lineNumber,1);a=t.position.get(u.lineNumber,"eol"),t.editor.setSelection(i.Selection.fromPositions(c,a))}else{c=t.position.get(r.lineNumber,"eol");a=t.position.get(u.lineNumber,1),t.editor.setSelection(i.Selection.fromPositions(c,a))}t.editor.revealPosition(a),t.vimState.isMovingCursorByMotion=!1,t.vimState.previousVisual={kind:"line",first:r.lineNumber,last:u.lineNumber}}else t.vimState.beep()}})),Le=l(function(t,e){var n=t.editor.getSelection();if(n){var o,r,s=n.positionLineNumber,a=n.selectionStartLineNumber;s<=a?(o=t.position.get(s,1),r=t.position.get(a,"eol")):(o=t.position.get(s,"eol"),r=t.position.get(a,1)),t.vimState.previousVisual={kind:"line",first:o.lineNumber,last:r.lineNumber};var u=i.Selection.fromPositions(o,r);t.editor.setSelection(u),t.editor.revealRange(u)}}),Me=l(function(t,e){t.vimState.toNormal()}),Ee=l(function(t,e){var n=t.editor.getSelection();n&&t.vimState.toVisual(n)});var Re=function(){var t=y([g(vt,C(Ie)),g(s.countPart,y([$t,re,g(f("o"),C(Le)),g(W("<ESC>"),C(Me)),g(f("V"),C(Me)),g(f("v"),C(Ee))]))]);return new Nt(g(s.registerPart,t))}(),_e=function(t){function e(e){var n=t.call(this,"VisualLine","Visual Line",e)||this;return n.subscriptions=[],n}return Ne(e,t),Object.defineProperty(e.prototype,"program",{get:function(){return Re},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapper",{get:function(){return rt.vmap},enumerable:!0,configurable:!0}),e.prototype.enter=function(t){var e,n,o=this;if(this.context.editor.updateOptions({cursorStyle:"block"}),t)t.first<=t.last?(e=this.context.position.get(t.first,1),n=this.context.position.get(t.last,"eol")):(e=this.context.position.get(t.first,"eol"),n=this.context.position.get(t.last,1));else{var r=this.context.editor.getPosition().lineNumber;e=this.context.position.get(r,1),n=this.context.position.get(r,"eol")}this.context.vimState.previousVisual={kind:"line",first:e.lineNumber,last:n.lineNumber},this.context.editor.setSelection(i.Selection.fromPositions(e,n)),this.subscriptions.push(this.context.editor.onDidChangeCursorPosition(function(t){return o.onCursorPositionChanged(t)}))},e.prototype.leave=function(){this.dispose()},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0,n=this.subscriptions;e<n.length;e++){n[e].dispose()}this.subscriptions=[]},e.prototype.onCursorPositionChanged=function(t){this.context.vimState.isMovingCursorByMotion||this.context.editor.getSelection().isEmpty()&&this.context.vimState.toNormal()},e}(Q),Oe=function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function s(t){try{u(i.next(t))}catch(t){r(t)}}function a(t){try{u(i.throw(t))}catch(t){r(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,a)}u((i=i.apply(t,e||[])).next())})},Be=function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},Ve=new(function(){return function(){}}()),De=function(){function t(t){this.vimState=t,this.editor=t.editor,this.position=new X(this.editor)}return Object.defineProperty(t.prototype,"model",{get:function(){var t=this.editor.getModel();if(!t)throw new Error("ICodeEditor.getModel() returns null.");return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalState",{get:function(){return Ve},enumerable:!0,configurable:!0}),t}(),We=function(){function t(t,e,n){void 0===n&&(n="Normal");var i=this;switch(this.editor=t,this.eventSink=e,this.desiredColumn=1,this.isMovingCursorByMotion=!1,this.isExecutingCommand=!1,this.isRepeating=!1,this.subscriptions=[],this.historyPatches=new Map,this.editorId=t.getId(),this.commandContext=new De(this),this.normalMode=new le(this.commandContext),this.insertMode=new ve(this.commandContext),this.visualMode=new Pe(this.commandContext),this.visualLineMode=new _e(this.commandContext),n){case"Normal":this.toNormal();break;case"Insert":this.toInsert();break;case"Visual":this.toVisual();break;case"VisualLine":this.toVisualLine()}this.subscriptions.push(this.editor.onKeyDown(function(t){return i.handleKeyDown(t)})),this.subscriptions.push(this.editor.onDidChangeCursorPosition(function(t){return i.handleCursorChanged(t)})),this.subscriptions.push(this.editor.onDidBlurEditorText(function(){return i.handleLostFocus()})),this.subscriptions.push(this.editor.onDidDispose(function(){return i.dispose()}))}return t.create=function(e,n){var i=e.getId();if(t.instances.has(i))throw new Error('already created for "'+i+'"');var o=new t(e,n,rt.startInInsertMode?"Insert":"Normal");return t.instances.set(i,o),o},t.getInstance=function(e){return t.instances.get(e)},t.disposeAllInstances=function(){t.instances.forEach(function(t){return t.dispose()}),t.instances.clear()},t.prototype.dispose=function(){this.currentMode.leave(),this.normalMode.dispose(),this.insertMode.dispose(),this.visualMode.dispose(),this.visualLineMode.dispose();for(var e=0,n=this.subscriptions;e<n.length;e++){n[e].dispose()}t.instances.delete(this.editorId),this.editor.updateOptions({cursorStyle:"line"})},Object.defineProperty(t.prototype,"model",{get:function(){var t=this.editor.getModel();if(!t)throw new Error("ICodeEditor.getModel() returns null.");return t},enumerable:!0,configurable:!0}),t.prototype.isVisual=function(){return"Visual"===this.currentModeName||"VisualLine"===this.currentModeName},t.prototype.getMode=function(){return this.currentModeName},t.prototype.getModeDisplayName=function(){return this.currentMode.displayName},t.prototype.toNormal=function(){"Normal"!==this.currentModeName&&(this.currentMode&&this.currentMode.leave(),this.normalMode.enter(),this.currentModeName="Normal",this.currentMode=this.normalMode,this.onModeChanged())},t.prototype.toInsert=function(t,e){void 0===e&&(e="none"),"Insert"!==this.currentModeName&&(this.currentMode&&this.currentMode.leave(),this.insertMode.enter(t,e),this.currentModeName="Insert",this.currentMode=this.insertMode,this.onModeChanged())},t.prototype.toVisual=function(t){"Visual"!==this.currentModeName&&(this.currentMode&&this.currentMode.leave(),this.visualMode.enter(t),this.currentModeName="Visual",this.currentMode=this.visualMode,this.onModeChanged())},t.prototype.toVisualLine=function(t){"VisualLine"!==this.currentModeName&&(this.currentMode&&this.currentMode.leave(),this.visualLineMode.enter(t),this.currentModeName="VisualLine",this.currentMode=this.visualLineMode,this.onModeChanged())},t.prototype.outputInfo=function(t){this.eventSink&&this.eventSink.onCommandOuput&&this.eventSink.onCommandOuput(this,"info",t)},t.prototype.outputError=function(t){this.eventSink&&this.eventSink.onCommandOuput&&this.eventSink.onCommandOuput(this,"error",t)},t.prototype.beep=function(){this.eventSink&&this.eventSink.onCommandBeep&&this.eventSink.onCommandBeep(this)},t.prototype.notifyKeyBufferChanged=function(t){this.eventSink&&this.eventSink.onKeyBufferChanged&&("string"!=typeof t&&(t=t.map(function(t){return T(t)}).join("")),this.eventSink.onKeyBufferChanged(this,t))},t.prototype.notifyKeyWaiting=function(t){this.eventSink&&this.eventSink.onKeyWaiting&&("string"!=typeof t&&(t=t.map(function(t){return T(t)}).join("")),this.eventSink.onKeyWaiting(this,t))},t.prototype.notifyKeyMatched=function(t){this.eventSink&&this.eventSink.onKeyMatched&&("string"!=typeof t&&(t=t.map(function(t){return T(t)}).join("")),this.eventSink.onKeyMatched(this,t))},t.prototype.notifyKeyFailed=function(t){this.eventSink&&this.eventSink.onKeyFailed&&("string"!=typeof t&&(t=t.map(function(t){return T(t)}).join("")),this.eventSink.onKeyFailed(this,t))},t.prototype.notifyKeyCanceled=function(t){this.eventSink&&this.eventSink.onKeyCanceled&&("string"!=typeof t&&(t=t.map(function(t){return T(t)}).join("")),this.eventSink.onKeyCanceled(this,t))},t.prototype.onModeChanged=function(){t.instances.has(this.editorId)&&this.eventSink&&this.eventSink.onModeChanged&&this.eventSink.onModeChanged(this,this.getMode(),this.getModeDisplayName())},t.prototype.requestExternalInput=function(t,e){if(this.eventSink&&this.eventSink.onRequestExternalInput)return this.eventSink.onRequestExternalInput(this,t,e);var n=window.prompt(t);return Promise.resolve(n)},t.prototype.handleKeyDown=function(t){var e=t.keyCode;if(5!=e&&4!==e&&6!==e&&57!==e){var n=function(t){return t.ctrlKey||t.altKey||t.metaKey||1!==t.browserEvent.key.length?w(t.keyCode,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey):t.browserEvent.key.charCodeAt(0)}(t),i=this.handleInput(n,!0);i.handled&&(t.preventDefault(),t.stopPropagation(),i.job&&i.job())}},t.prototype.handleInput=function(t,e){var n=this.currentMode.handleInput(t,e);return"boolean"==typeof n&&(n={handled:n}),n},t.prototype.sendInput=function(t){return Oe(this,void 0,void 0,function(){var e,n,i,o,r,s;return Be(this,function(a){switch(a.label){case 0:return"number"!=typeof t?[3,3]:(s=this.handleInput(t,!1)).job?[4,s.job()]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2,s.handled];case 3:e=!0,n="string"==typeof t?D(t):t,i=0,o=n,a.label=4;case 4:return i<o.length?(r=o[i],!(s=this.handleInput(r,!1)).handled||s.failed?(e=!1,[3,7]):s.job?[4,s.job()]:[3,6]):[3,7];case 5:a.sent(),a.label=6;case 6:return i++,[3,4];case 7:return[2,e]}})})},t.prototype.handleCursorChanged=function(t){this.isMovingCursorByMotion||(this.desiredColumn=t.position.column)},t.prototype.handleLostFocus=function(){this.currentMode.discardInputBuffer()},t.prototype.addHistoryPatch=function(t,e,n,o){var r={beforeVersionId:t,afterVersionId:e};n&&(r.beforeCursor=i.Position.lift(n)),o&&(r.afterCursor=i.Position.lift(o)),this.historyPatches.set(t,r),this.historyPatches.set(e,r)},t.prototype.undo=function(){var t=this.model,e=t.getAlternativeVersionId(),n=this.historyPatches.get(e);if(n&&n.afterVersionId==e){for(;e!==n.beforeVersionId;){this.editor.trigger("vim","undo",null);var i=t.getAlternativeVersionId();if(i===e)return i;e=i}return n.beforeCursor&&this.editor.setPosition(this.commandContext.position.soften(n.beforeCursor)),e}return this.editor.trigger("vim","undo",null),t.getAlternativeVersionId()},t.prototype.redo=function(){var t=this.model,e=t.getAlternativeVersionId(),n=this.historyPatches.get(e);if(n&&n.beforeVersionId==e){for(;e<n.afterVersionId;){this.editor.trigger("vim","redo",null);var i=t.getAlternativeVersionId();if(i===e)return i;e=i}return e===n.afterVersionId&&n.afterCursor&&this.editor.setPosition(this.commandContext.position.soften(n.afterCursor)),e}return this.editor.trigger("vim","redo",null),t.getAlternativeVersionId()},t.instances=new Map,t}();function Te(t,e){return We.create(t,e)}function Ke(t){return We.getInstance(t.getId())}var je='function Greeter(greeting) {\n    this.greeting = greeting;\n}\n\nGreeter.prototype.greet = function() {\n    return "Hello, " + this.greeting;\n}\n\n// Oops, we\'re passing an object when we want a string. This will print "Hello, [object Object]" instead of "Hello, world" without error.\nlet greeter = new Greeter({message: "world"});\n\nlet button = document.createElement(\'button\');\nbutton.textContent = "Say Hello";\nbutton.onclick = function() {\n    alert(greeter.greet());\n};\n\ndocument.body.appendChild(button);',Ue='class Greeter {\n    greeting: string;\n    constructor(message: string) {\n        this.greeting = message;\n    }\n    greet() {\n        return "Hello, " + this.greeting;\n    }\n}\n\nlet greeter = new Greeter("world");\n\nlet button = document.createElement(\'button\');\nbutton.textContent = "Say Hello";\nbutton.onclick = function() {\n    alert(greeter.greet());\n}\n\ndocument.body.appendChild(button);',Fe='class Animal {\n    constructor(public name: string) { }\n    move(distanceInMeters: number = 0) {\n        console.log(`${this.name} moved ${distanceInMeters}m.`);\n    }\n}\n\nclass Snake extends Animal {\n    constructor(name: string) { super(name); }\n    move(distanceInMeters = 5) {\n        console.log("Slithering...");\n        super.move(distanceInMeters);\n    }\n}\n\nclass Horse extends Animal {\n    constructor(name: string) { super(name); }\n    move(distanceInMeters = 45) {\n        console.log("Galloping...");\n        super.move(distanceInMeters);\n    }\n}\n\nlet sam = new Snake("Sammy the Python");\nlet tom: Animal = new Horse("Tommy the Palomino");\n\nsam.move();\ntom.move(34);',Qe="data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=",qe=function(){var t=void 0;return function(){var e;void 0===t&&(e=new Audio(Qe),t=function(){e.play()}),t()}}();(new(function(){function t(){this._activeTabIndex=-1,this._mode="",this._text="",this._enabled=!0,this._tid=null,this.editors=[],this._running=!1}return t.prototype.onKeyBufferChanged=function(t,e){this.text=e},t.prototype.onKeyMatched=function(t,e){console.log("Matched: "+e)},t.prototype.onKeyFailed=function(t,e){console.log("Failed: "+e),qe()},t.prototype.onKeyCanceled=function(t,e){console.log("Canceled: "+e)},t.prototype.onCommandBeep=function(){qe()},t.prototype.onCommandOuput=function(t,e,n){"info"===e?(console.log("info: "+n),this.text=n):(console.error("error: "+n),this.text="ERROR: "+n)},t.prototype.onModeChanged=function(t,e,n){t.editor===this.activeEditor&&(this.mode=n)},t.prototype.didMountEditor=function(t){var e=this;Te(t,this),t.addAction({id:"vim.toggle",label:"Toggle Vim Mode",keybindings:[i.KeyMod.CtrlCmd|i.KeyCode.F10],run:function(){e.enabled=!e.enabled}})},t.prototype.didChangeActiveEditor=function(t){var e=Ke(t);if(!e)throw new Error("something goes wrong.");this.mode=e.getModeDisplayName(),this.text=""},t.prototype.config=function(){var t=this;rt.nmap.addEditorAction(",xm","editor.action.showContextMenu"),rt.nmap.addUserAction(",p",function(){return t.prevTab()}),rt.nmap.addUserAction(",n",function(){return t.nextTab()}),rt.nmap.addString(",f","=iB")},Object.defineProperty(t.prototype,"activeTabIndex",{get:function(){return this._activeTabIndex},set:function(t){this._activeTabIndex!==t&&(this._activeTabIndex=t,this.didChangeActiveEditor(this.activeEditor),this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode!==t&&(this._mode=t,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(t){this._text!==t&&(this._text=t,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled!==t&&this.toggle()},enumerable:!0,configurable:!0}),t.prototype.toggle=function(){var t=this;if(this._enabled=!this._enabled,this._enabled){this.editors.forEach(function(e){return Te(e,t)});var e=Ke(this.activeEditor);if(!e)throw new Error("something goes wrong.");this.mode=e.getModeDisplayName(),this.text=""}else this.mode="",this.text="",We.disposeAllInstances();this.render()},t.prototype.render=function(){var t=this;this._tid&&clearTimeout(this._tid),this._tid=setTimeout(function(){document.getElementById("mode").innerText=""===t.mode?"":"-- "+t.mode.toUpperCase()+" --";var e=document.getElementById("text");e.innerText=t.text,e.classList.toggle("error",t.text.startsWith("ERROR")),document.getElementById("enable").checked=t.enabled,t._tid=null},0)},t.prototype.activate=function(t){var e=this,n=this.editors.length-1;t<0||t>n||t===this.activeTabIndex||(this.activeTabIndex=t,document.querySelectorAll("#tabs>div").forEach(function(t,n){t.classList.toggle("active",n===e.activeTabIndex)}),document.querySelectorAll("#editors>div").forEach(function(t,n){t.classList.toggle("active",n===e.activeTabIndex)}),this.editors[this.activeTabIndex].focus())},t.prototype.prevTab=function(){var t=this.editors.length-1;this.activate(0===this.activeTabIndex?t:this.activeTabIndex-1)},t.prototype.nextTab=function(){var t=this.editors.length-1;this.activate(this.activeTabIndex===t?0:this.activeTabIndex+1)},t.prototype.bindDomEvents=function(){var t=this;document.querySelectorAll("#tabs>div").forEach(function(e,n){e.addEventListener("click",function(){return t.activate(n)})});var e=document.getElementById("enable");e.addEventListener("change",function(){t.enabled!==e.checked&&(t.enabled=e.checked,t.activeEditor.focus())})},Object.defineProperty(t.prototype,"activeEditor",{get:function(){return this.editors[this.activeTabIndex]},enumerable:!0,configurable:!0}),t.prototype.createEditor=function(t,e,n){var o=i.editor.create(document.getElementById(t),{value:e,language:n,minimap:{enabled:!1},wordWrap:"on"});return window.addEventListener("resize",function(){o.layout()}),this.didMountEditor(o),o},t.prototype.run=function(){var t=this;this._running||(this._running=!0,this.config(),this.editors=[["editor-1",je,"javascript"],["editor-2",Ue,"typescript"],["editor-3",Fe,"typescript"]].map(function(e){return t.createEditor(e[0],e[1],e[2])}),this.bindDomEvents(),this.activate(0))},t}())).run()}]);