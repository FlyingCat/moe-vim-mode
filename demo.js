!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=monaco},function(t,e,n){"use strict";n.r(e);var i=n(0);function r(t,e){var n={lineNumber:e[0],column:1},r={lineNumber:e[1],column:t.model.getLineMaxColumn(e[1])};return i.Range.fromPositions(n,r)}function o(t){if(0===t.length)return[];for(var e=t.map(function(t){return i.Range.lift(t)}),n=0;n<e.length;n++)for(var r=n+1;r<e.length;){i.Range.intersectRanges(e[n],e[r])?(e[n]=i.Range.plusRange(e[n],e[r]),e.splice(r,1)):r++}return e}function s(t,e){if(0===t.length)return[];for(var n=Array.from(t),i=e?1:0,r=0;r<n.length;r++)for(var o=r+1;o<n.length;)if(n[o].first<=n[r].last+i&&n[o].last>=n[r].first-i){var s=Math.min(n[r].first,n[o].first),a=Math.max(n[r].last,n[o].last);n[r]={first:s,last:a},n.splice(o,1)}else o++;return n}function a(t,e){if(e.startLineNumber==e.endLineNumber)return[i.Range.lift(e)];var n=[],r=e.startLineNumber;for(n.push(new i.Range(r,e.startColumn,r,t.getLineMaxColumn(r))),r+=1;r<e.endLineNumber;r++)n.push(new i.Range(r,1,r,t.getLineMaxColumn(r)));return 1!==e.endColumn&&n.push(new i.Range(r,1,r,e.endColumn)),n}function u(t,e){return"object"==typeof(n=t)&&n.then?t.then(e):e(t);var n}var c,l,h,f,d=function(){function t(t,e){this.command=t,this.args=e}return t.prototype.setCount=function(t){this.args.count=t},t.prototype.execute=function(t){return m(this.command,t,this.args)},t}(),p=new(function(){function t(){}return t.prototype.setLast=function(t,e){this.last=new d(t,e)},t.prototype.setLastAction=function(t){this.last=t},t.prototype.repeatLast=function(t,e){if(this.last)return void 0!==e&&this.last.setCount(e),t.vimState.isRepeating=!0,u(this.last.execute(t),function(){t.vimState.isRepeating=!1})},t}());function g(t,e,n,r){var o=n.motion;if(!o)throw new Error;var s=n.count;r||(r=e.editor.getPosition());var a,u=o.linewise,c=o.run(e,r,s||1,t,void 0===s,n);return c?(i.Position.isIPosition(c)?a=c:(r=c.from,a=c.to,void 0!==c.linewise&&(u=c.linewise)),{from:r,to:a,linewise:u,inclusive:o.inclusive,keepPrevDesiredColumn:o.keepPrevDesiredColumn,desiredColumnAtEol:o.desiredColumnAtEol,isJump:o.isJump}):null}function m(t,e,n){return e.vimState.isExecutingCommand=!0,u(t.run(e,n),function(){e.vimState.isExecutingCommand=!1,t.shouldRecord&&p.setLast(t,n)})}function v(t,e){return void 0===e&&(e=0),{kind:"Key",key:"number"==typeof t?t:t.charCodeAt(e)}}function b(t){return void 0===t&&(t=!1),{kind:"Digit",nonZero:t}}function y(t,e){return{kind:"Cat",left:t,right:e}}function S(t){var e=t.length;if(e<1)throw new Error("empty arg.");return 1===e?t[0]:t.reduce(function(t,e){return y(t,e)})}function A(t,e){return{kind:"Alt",left:t,right:e}}function C(t){var e=t.length;if(e<1)throw new Error("empty arg.");return 1===e?t[0]:t.reduce(function(t,e){return A(t,e)})}function x(t){return{kind:"Opt",child:t}}function k(t){return{kind:"Routine",child:t}}function w(t){return{kind:"WriteLinewise",value:t}}function P(t,e){return{kind:"Cap",child:t,action:e}}function N(t,e,n,i,r){var o=t;return o|=512,e&&(o|=1024),n&&(o|=2048),i&&(o|=4096),r&&(o|=8192),o}function E(t){return t<256}function L(t){return 0!=(1024&t)}function I(t){return 0!=(4096&t)}function R(t){return 0!=(8192&t)}!function(t){t.motion={kind:"MotionHolder"},t.TextObject={kind:"TextObjectHolder"},t.OperatorMotion={kind:"OperatorMotionHolder"}}(c||(c={})),function(t){var e,n;function i(t,e,n){for(var i=0,r=n;r<e.length;r++)i=10*i+(e[r]-"0".charCodeAt(0));t.count=i*(t.count||1)}t.integer=y(b(!0),(e=b(),n?{kind:"Plus",child:e}:{kind:"Star",child:e})),t.countPart=x(P(t.integer,i)),t.explicitCountPart=P(t.integer,i),t.linewisePart=x(A(y(v("v"),w(!1)),y(v("V"),w(!0)))),t.registerPart=x(S([t.countPart,v('"'),{kind:"Reg"}]))}(l||(l={}));var M={space:" ",lt:">",bslash:"\\",bar:"|"},O={space:10,bs:1,tab:2,cr:3,return:3,enter:3,esc:9,del:20,up:16,down:18,left:15,right:17,f1:59,f2:60,f3:61,f4:62,f5:63,f6:64,f7:65,f8:66,f9:67,f10:68,f11:69,f12:70,insert:19,home:14,end:13,pageup:11,pagedown:12,k0:93,k1:94,k2:95,k3:96,k4:97,k5:98,k6:99,k7:100,k8:101,k9:102,kplus:104,kminus:106,kmultiply:103,kdivide:108,kpoint:107},_=((h={})[1]="BS",h[2]="Tab",h[3]="CR",h[9]="Esc",h[20]="Del",h[16]="Up",h[18]="Down",h[15]="Left",h[17]="Right",h[59]="F1",h[60]="F2",h[61]="F3",h[62]="F4",h[63]="F5",h[64]="F6",h[65]="F7",h[66]="F8",h[67]="F9",h[68]="F10",h[69]="F11",h[70]="F12",h[19]="Insert",h[14]="Home",h[13]="End",h[11]="PageUp",h[12]="PageDown",h[93]="k0",h[94]="k1",h[95]="k2",h[96]="k3",h[97]="k4",h[98]="k5",h[99]="k6",h[100]="k7",h[101]="k8",h[102]="k9",h[104]="kPlus",h[106]="kMinus",h[103]="kMultiply",h[108]="kDivide",h[107]="kPoint",h),W={";":80,"=":81,",":82,"-":83,".":84,"/":85,"~":86,"[":87,"\\":88,"]":89,"'":90},V=((f={})[80]=";",f[81]="=",f[82]=",",f[83]="-",f[84]=".",f[85]="/",f[86]="~",f[87]="[",f[88]="\\",f[89]="]",f[90]="'",f),T="0".charCodeAt(0),D="9".charCodeAt(0),B="a".charCodeAt(0),j="z".charCodeAt(0);function K(t){if(1===t.length){var e=t.charCodeAt(0);if(e>=T&&e<=D)return e-T+21;if(e>=B&&e<=j)return e-B+31;if(W[t])return W[t]}return O[t]}function F(t){for(var e=[],n=0;n<t.length;n++){if("<"===t[n]){var i=t.indexOf(">",n+1);if(-1!==i){var r=t.substring(n+1,i).toLowerCase();if(void 0!==M[r])e.push(M[r].charCodeAt(0));else{var o=!1,s=!1,a=!1,u=!1;r.startsWith("c-")?(o=!0,r=r.substring(2)):r.startsWith("s-")?(s=!0,r=r.substring(2)):r.startsWith("a-")?(a=!0,r=r.substring(2)):r.startsWith("m-")&&(u=!0,r=r.substring(2));var c=K(r);if(void 0===c)throw new Error('Invalid vkey "'+r+'"');e.push(N(c,o,s,a,u))}n=i;continue}}e.push(t[n].charCodeAt(0))}return e}function U(t){if(E(t))return String.fromCharCode(t);var e="";L(t)&&(e+="C-"),function(t){return 0!=(2048&t)}(t)&&(e+="S-"),I(t)&&(e+="A-"),R(t)&&(e+="M-");var n=255&t,r=i.KeyCode[n];return V[n]?r=V[n]:_[n]?r=_[n]:r.startsWith("KEY_")&&(r=r.substring("KEY_".length)),e+r}var Q,H=(Q=function(t,e){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Q(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),q=N(9),z=function(){return function(t,e){this.name=t,this.displayName=e}}(),Z=function(t){function e(e,n,i){var r=t.call(this,e,n)||this;return r.context=i,r.inputs=[],r.remapping=null,r}return H(e,t),e.prototype.dispose=function(){this.program.reset()},e.prototype.reset=function(){this.inputs=[],this.remapping=null,this.program.reset()},e.prototype.discardInputBuffer=function(){this.reset()},e.prototype.handleInput=function(t,e){var n=this,i=0!==this.inputs.length;if(t===q&&i)return this.context.vimState.notifyKeyCanceled(this.inputs),this.reset(),this.context.vimState.notifyKeyBufferChanged(""),!0;if(this.inputs.push(t),i&&this.remapping?"Waiting"===this.remapping.status&&this.remapping.next(t):this.remapping=this.mapper.getRemapping(t),"End"===this.remapping.status){var r=this.remapping.value;return this.reset(),i&&this.context.vimState.notifyKeyBufferChanged(""),this.context.vimState.sendInput(r),!0}if("UserAction"===this.remapping.status){var o=this.remapping.userAction;return this.reset(),i&&this.context.vimState.notifyKeyBufferChanged(""),{handled:!0,job:function(){return o(n.context.editor)}}}var s=!0,a=!1,u=void 0,c=this.program.step(this.context.editor.getId(),t);if("Fail"===c.kind&&"Failed"===this.remapping.status){var l=this.inputs;this.reset(),i?(a=!0,this.context.vimState.notifyKeyFailed(l)):(s=function(t){if(E(t))return!0;var e=255&t;return!(10!==e&&3!==e&&2!==e&&20!==e&&1!==e||L(t)||I(t)||R(t))}(t))&&(a=!0,this.context.vimState.notifyKeyFailed(l)),i&&this.context.vimState.notifyKeyBufferChanged("")}else if("Waiting"===c.kind||"Waiting"===this.remapping.status)this.context.vimState.notifyKeyWaiting(this.inputs),this.context.vimState.notifyKeyBufferChanged(this.inputs);else{if("Matched"!==c.kind)throw new Error;this.context.vimState.notifyKeyMatched(this.inputs),this.reset(),i&&this.context.vimState.notifyKeyBufferChanged("");var h=c.capture,f=h.command;if(!f)throw new Error("No command is set.");u=function(){return m(f,n.context,h)}}return{handled:s,failed:a,job:u}},e}(z);function G(t,e,n){var i=t;if(0!==e.length){for(var r=0;r<e.length-1;r++){var o=e[r],s=i.get(o);if(s){if(!(s instanceof Map))throw new Error("conflict: should be container node.")}else s=new Map,i.set(o,s);i=s}var a=e[e.length-1];if(i.has(a))throw new Error("conflict: key already exists.");i.set(a,n)}}var J=function(){function t(){this.seqMap=function(t){for(var e=new Map,n=0,i=t;n<i.length;n++){var r=i[n];G(e,r.seq,r.val)}return e}([])}return t.prototype.add=function(t,e){try{G(this.seqMap,t,e)}catch(t){}},t.prototype.addString=function(t,e){try{this.add(F(t),F(e))}catch(t){}},t.prototype.addUserAction=function(t,e){try{G(this.seqMap,F(t),e)}catch(t){}},t.prototype.addEditorAction=function(t,e){try{G(this.seqMap,F(t),function(t){var n=t.getAction(e);if(n)return n.run()})}catch(t){}},t.prototype.clear=function(){this.seqMap.clear()},t.prototype.getRemapping=function(t){return new Y(t,this.seqMap.get(t))},t}(),Y=function(){function t(t,e){this._keys=[t],this._status=this.statusFromSearch(e)}return t.prototype.statusFromSearch=function(t){return void 0===t?{kind:"Failed"}:"function"==typeof t?{kind:"UserAction",value:t}:Array.isArray(t)?{kind:"End",value:t}:{kind:"Waiting",value:t}},Object.defineProperty(t.prototype,"status",{get:function(){return this._status.kind},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){if("End"===this._status.kind)return this._status.value;throw new Error},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAction",{get:function(){if("UserAction"===this._status.kind)return this._status.value;throw new Error},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalKeys",{get:function(){return this._keys},enumerable:!0,configurable:!0}),t.prototype.next=function(t){if("Waiting"!==this._status.kind)throw new Error;this._keys.push(t),this._status=this.statusFromSearch(this._status.value.get(t))},t}(),X=new(function(){function t(){this.callbacks={},this.startInInsertMode=!1,this.enterInsertModeIfSelectOutsideVim=!1,this._ignoreCase=!1,this._smartCase=!0,this._incrementalSearch=!0,this._highlightSearch=!0,this.whichWrap="b,s",this.nmap=new J,this.vmap=new J}return t.prototype.invokeCallback=function(t){var e=this.callbacks[t];if(e)for(var n=0,i=e;n<i.length;n++){(0,i[n])()}},t.prototype.onOptionChanged=function(t,e){var n=this.callbacks[t];n||(n=[e],this.callbacks[t]=n),n.push(e)},Object.defineProperty(t.prototype,"ignoreCase",{get:function(){return this._ignoreCase},set:function(t){this._ignoreCase!==t&&(this._ignoreCase=t,this.invokeCallback("ignoreCase"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"smartCase",{get:function(){return this._smartCase},set:function(t){this._smartCase!==t&&(this._smartCase=t,this.invokeCallback("smartCase"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"incrementalSearch",{get:function(){return this._incrementalSearch},set:function(t){this._incrementalSearch!==t&&(this._incrementalSearch=t,this.invokeCallback("incrementalSearch"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"highlightSearch",{get:function(){return this._highlightSearch},set:function(t){this._highlightSearch!==t&&(this._highlightSearch=t,this.invokeCallback("highlightSearch"))},enumerable:!0,configurable:!0}),t}()),$=function(){function t(t,e){this.texts=t,this.linewise=e}return t.prototype.repeatTextRespectively=function(t,e){return void 0===e&&(e=!1),this.linewise||e?this.texts.map(function(e){for(var n=t,i="";n>0;)i+=e+(1===n?"":"\n"),n--;return i}):this.texts.map(function(e){return e.repeat(t)})},t.prototype.getJoinedText=function(t,e){if(void 0===e&&(e=!1),this.linewise||e||this.texts.length>1){for(var n=this.texts.join("\n"),i=t,r="";i>0;)r+=n+(1===i?"":"\n"),i--;return r}return this.texts[0].repeat(t)},t}(),tt=new(function(){function t(){this.numbered=[],this.named=[]}return t.prototype.convertToId=function(e){return e==='"'.charCodeAt(0)?t.UNNAMED_ID:e==="_".charCodeAt(0)?t.BLACKHOLD_ID:e==="-".charCodeAt(0)?t.SMALLDELETE_ID:e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)?e-"0".charCodeAt(0):e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)?e-"a".charCodeAt(0)+10:e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)?e-"A".charCodeAt(0)+100:void 0},t.prototype.idToString=function(e){if(e===t.BLACKHOLD_ID)return"_";if(void 0===e||e===t.UNNAMED_ID)return'"';if(e===t.SMALLDELETE_ID)return"-";if(e>=0&&e<=9)return String.fromCharCode("0".charCodeAt(0)+e);if(e>=10&&e<=35)return String.fromCharCode("a".charCodeAt(0)+(e-10));if(e>=100&&e<=125)return String.fromCharCode("A".charCodeAt(0)+(e-10));throw new Error("Invalid id.")},t.prototype.storeText=function(e,n,i){if(i!==t.BLACKHOLD_ID){var r=new $("string"==typeof e?[e]:e,n);if(this.unnamed=r,"yank"===i||i===t.UNNAMED_ID)this.numbered[0]=r;else if("delete"===i)if(!r.linewise&&r.texts.every(function(t){return t.indexOf("\n")<0}))this.smallDelete=r;else{for(var o=9;o>1;o--)this.numbered[o]=this.numbered[o-1];this.numbered[1]=r}else if(i>=0&&i<=9)this.numbered[i]=r;else if(i>=10&&i<=35)this.named[i-10]=r;else{if(!(i>=100&&i<=125))throw new Error("Invalid id.");var s=this.named[i-100];s&&(s.linewise||r.linewise?(r.linewise=!0,r.texts=[s.texts.join("\n")+"\n"+r.texts.join("\n")]):r.texts=[s.texts.join("\n")+r.texts.join("\n")]),this.named[i-100]=r}}},t.prototype.getText=function(e){if(e!==t.BLACKHOLD_ID){if(void 0===e||e===t.UNNAMED_ID)return this.unnamed;if(e===t.SMALLDELETE_ID)return this.smallDelete;if(e>=0&&e<=9)return this.numbered[e];if(e>=10&&e<=35)return this.named[e-10];if(e>=100&&e<=125)return this.named[e-10];throw new Error("Invalid id.")}},t.UNNAMED_ID=-1,t.BLACKHOLD_ID=-2,t.SMALLDELETE_ID=-3,t}());function et(t){if(t<128){var e=String.fromCharCode(t);if("`"===e||"'"===e)return"LAST";if("<"===e||">"===e||t>="a".charCodeAt(0)&&t<="z".charCodeAt(0))return e}return null}var nt=new(function(){function t(){this.list=[],this.map=new Map}return t.prototype.put=function(t){var e=this.map.get(t);if(void 0!==e)return e;this.list.push(t);var n=this.list.length-1;return this.map.set(t,n),n},t.prototype.get=function(t){return this.list[t]},t}()),it=function(){function t(t){void 0===t&&(t=!1),this.positions=[],this.callStack=[],this._ref=t?null:1}return t.prototype.freeze=function(){this._ref=null},t.prototype.isFrozen=function(){return null===this._ref},t.prototype.ref=function(){return null!==this._ref&&(this._ref+=1),this},t.prototype.cloneIfNeed=function(){if(null===this._ref||this._ref>1){var e=new t;return e.command=this.command,e.count=this.count,e.motion=this.motion,e.linewise=this.linewise,e.positions=this.positions.slice(),e.callStack=this.callStack.slice(),e.register=this.register,e.char=this.char,e.mark=this.mark,null!==this._ref&&this._ref--,e}return this},t.prototype.setCommand=function(t){var e=this.cloneIfNeed();return e.command=t,e},t.prototype.setMotion=function(t){var e=this.cloneIfNeed();return e.motion=t,e},t.prototype.setCount=function(t){var e=this.cloneIfNeed();return e.count=t,e},t.prototype.setLinewise=function(t){var e=this.cloneIfNeed();return e.linewise=t,e},t.prototype.setRegister=function(t){var e=this.cloneIfNeed();return e.register=t,e},t.prototype.setChar=function(t){var e=this.cloneIfNeed();return e.char=t,e},t.prototype.setMark=function(t){var e=this.cloneIfNeed();return e.mark=t,e},t.prototype.pushPositon=function(t){var e=this.cloneIfNeed();return e.positions.push(t),e},t.prototype.popPositon=function(){var t=this.cloneIfNeed(),e=t.positions.pop();if(void 0===e)throw new Error("Array.pop fail.");return{value:e,state:t}},t.prototype.pushCall=function(t){var e=this.cloneIfNeed();return e.callStack.push(t),e},t.prototype.popCall=function(){var t=this.cloneIfNeed(),e=t.callStack.pop();if(void 0===e)throw new Error("Array.pop fail.");return{pc:e,state:t}},t}(),rt=function(){function t(t,e){this._pc=t,this._state=e,this.frozen=!1}return Object.defineProperty(t.prototype,"pc",{get:function(){return this._pc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),t.prototype.freeze=function(){this.state.freeze(),this.frozen=!0},t.prototype.update=function(e,n){return e=e||this.pc,n=n||this.state,e===this.pc&&n===this.state?this:this.frozen?new t(e,n):(this._pc=e,this._state=n,this)},t}(),ot=function(){function t(){this.literalKeys=new Map,this.others=[],this.frozen=!1}return t.prototype.push=function(t){if(this.frozen)throw new Error;this.others.push(t)},t.prototype.pushKey=function(t,e){if(this.frozen)throw new Error;var n=this.literalKeys.get(t);n?Array.isArray(n)?n.push(e):this.literalKeys.set(t,[n,e]):this.literalKeys.set(t,e)},t.prototype.getMatchedKeyThreads=function(t){var e=this.literalKeys.get(t);return e?Array.isArray(e)?e:[e]:[]},t.prototype.getCommonThreads=function(){return this.others},t.prototype.empty=function(){return 0===this.others.length&&0===this.literalKeys.size},t.prototype.freeze=function(){this.literalKeys.forEach(function(t){if(Array.isArray(t))for(var e=0,n=t;e<n.length;e++){n[e].freeze()}else t.freeze()});for(var t=0,e=this.others;t<e.length;t++){e[t].freeze()}return this.frozen=!0,this},t}(),st=function(){function t(t){this.inputs=[],this.threads=new ot,this.source=null;for(var e=[],n=function t(e,n){switch(e.kind){case"Key":return 2;case"Range":return 3;case"Digit":case"Char":case"Reg":case"Mark":return 1;case"Cat":return t(e.left,n)+t(e.right,n);case"Alt":return 4+t(e.left,n)+t(e.right,n);case"Opt":case"Plus":return 2+t(e.child,n);case"Star":return 4+t(e.child,n);case"WriteCommand":case"WriteMotion":case"WriteLinewise":return 2;case"Cap":return 3+t(e.child,n);case"Routine":if(n.findIndex(function(t){return t.pattern===e.child})<0){var i={pattern:e.child,size:0};n.push(i),i.size=t(e.child,n)}return 2;default:throw new Error}}(t,e)+1,i=0,r=e;i<r.length;i++){(u=r[i]).start=n,n+=u.size+1}this.code=new Int16Array(n);var o=at(this.code,0,t,e);this.code[o++]=0;for(var s=0,a=e;s<a.length;s++){var u=a[s];o+=at(this.code,o,u.pattern,e),this.code[o++]=2}this.execNextInst(new rt(0,new it(!0))),this.startupThreads=this.threads.freeze()}return t.prototype.getInputs=function(){return this.inputs},t.prototype.getSource=function(){return this.source},t.prototype.isWaiting=function(){return 0!==this.inputs.length},t.prototype.step=function(t,e){this.source&&this.source!==t&&(this.reset(),this.source=t),this.inputs.push(e);var n=this.threads;this.threads=new ot;for(var i=n.getMatchedKeyThreads(e),r=void 0,o=0;o<i.length;o++){var s=i[o];if(3!==this.code[s.pc])throw new Error;if(r=this.execNextInst(s.update(s.pc+2)))return this.matched(r)}var a=n.getCommonThreads();for(o=0;o<a.length;o++){s=a[o];switch(this.code[s.pc]){case 4:if(e>=this.code[s.pc+1]&&e<=this.code[s.pc+2]&&(r=this.execNextInst(s.update(s.pc+3))))return this.matched(r);break;case 5:if(e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)&&(r=this.execNextInst(s.update(s.pc+1))))return this.matched(r);break;case 6:if(e>="1".charCodeAt(0)&&e<="9".charCodeAt(0)&&(r=this.execNextInst(s.update(s.pc+1))))return this.matched(r);break;case 7:if(E(e)&&(r=this.execNextInst(s.update(s.pc+1,s.state.setChar(String.fromCharCode(e))))))return this.matched(r);break;case 8:var u=tt.convertToId(e);if(void 0!==u&&(r=this.execNextInst(s.update(s.pc+1,s.state.setRegister(u)))))return this.matched(r);break;case 9:var c=et(e);if(c&&(r=this.execNextInst(s.update(s.pc+1,s.state.setMark(c)))))return this.matched(r);break;default:throw new Error("Unexpected behavior.")}}var l=this.inputs;return this.threads.empty()?(this.reset(),{kind:"Fail",inputs:l}):{kind:"Waiting",inputs:l}},t.prototype.reset=function(){this.inputs=[],this.source=null,this.threads=this.startupThreads},t.prototype.matched=function(t){var e=this.inputs;return this.reset(),{kind:"Matched",inputs:e,capture:t}},t.prototype.execNextInst=function(t){var e=t.pc;switch(this.code[e]){case 0:return t.state;case 1:return this.execNextInst(t.update(this.code[e+1],t.state.pushCall(e+2)));case 2:var n=t.state.popCall();return this.execNextInst(t.update(n.pc,n.state));case 3:this.threads.pushKey(this.code[e+1],t);break;case 4:case 5:case 7:case 6:case 8:case 9:this.threads.push(t);break;case 14:return this.execNextInst(t.update(t.pc+2,t.state.setCommand(nt.get(this.code[e+1]))));case 15:return this.execNextInst(t.update(t.pc+2,t.state.setMotion(nt.get(this.code[e+1]))));case 16:return this.execNextInst(t.update(t.pc+2,t.state.setLinewise(1===this.code[e+1])));case 12:return this.execNextInst(t.update(t.pc+1,t.state.pushPositon(this.inputs.length)));case 13:var i=t.state.popPositon();return nt.get(this.code[e+1])(i.state,this.inputs,i.value),this.execNextInst(t.update(t.pc+2,i.state));case 11:return this.execNextInst(t.update(e+this.code[e+1]));case 10:var r=t.state.ref(),o=this.execNextInst(t.update(t.pc+2)),s=this.execNextInst(new rt(e+this.code[e+1],r));if(o||s)throw new Error('"Split" direct to end state.')}},t}();function at(t,e,n,i){var r,o;switch(n.kind){case"Key":return t[e]=3,t[e+1]=n.key,2;case"Range":return t[e]=4,t[e+1]=n.from,t[e+2]=n.to,3;case"Digit":return t[e]=n.nonZero?6:5,1;case"Char":return t[e]=7,1;case"Reg":return t[e]=8,1;case"Mark":return t[e]=9,1;case"Cat":return(r=at(t,e,n.left,i))+at(t,e+r,n.right,i);case"Alt":return r=at(t,e+2,n.left,i),o=at(t,e+r+4,n.right,i),t[e]=10,t[e+1]=r+4,t[e+r+2]=11,t[e+r+3]=o+2,r+o+4;case"Opt":return r=at(t,e+2,n.child,i),t[e]=10,t[e+1]=r+2,r+2;case"Plus":return t[e+(r=at(t,e,n.child,i))]=10,t[e+r+1]=-r,r+2;case"Star":return r=at(t,e+2,n.child,i),t[e]=10,t[e+1]=r+4,t[e+r+2]=11,t[e+r+3]=-(r+2),r+4;case"WriteCommand":return t[e]=14,t[e+1]=nt.put(n.value),2;case"WriteMotion":return t[e]=15,t[e+1]=nt.put(n.value),2;case"WriteLinewise":return t[e]=16,t[e+1]=n.value?1:0,2;case"Cap":return t[e]=12,t[e+(r=at(t,e+1,n.child,i))+1]=13,t[e+r+2]=nt.put(n.action),r+3;case"Routine":var s=i.find(function(t){return t.pattern===n.child});if(!s)throw new Error;return t[e]=1,t[e+1]=s.start,2;default:throw new Error}}function ut(t){return C(t.split(", ").map(function(t){return S(F(t).map(function(t){return v(t)}))}))}function ct(t){return"string"==typeof t?ut(t):Array.isArray(t)?S(t.map(function(t){return"string"==typeof t?ut(t):t})):t}var lt={optionalCount:[],noCount:[],requiredCount:[]};function ht(t,e,n){if(void 0===n&&(n="optional"),!lt)throw new Error;var i=ct(t),r={kind:"WriteMotion",value:"function"==typeof e?{run:e}:e};("optional"===n?lt.optionalCount:"no"===n?lt.noCount:lt.requiredCount).push(y(i,r))}var ft=[];function dt(t,e){if(!ft)throw new Error;var n=ct(t),i={kind:"WriteMotion",value:"function"==typeof e?{run:e}:e};ft.push(y(n,i))}var pt=[];function gt(t,e,n){if(pt){var i="function"==typeof n?{run:n}:n,r=ct(t),o={kind:"WriteCommand",value:i},s=0;if(e.indexOf("~")>=0&&(s|=1),e.indexOf("n")>=0&&(s|=2),e.indexOf("v")>=0&&(s|=12),e.indexOf("V")>=0&&(s|=4),e.indexOf("L")>=0&&(s|=8),s<=0)throw new Error;pt.push([s,y(r,o)])}}var mt=null;function vt(){if(mt)return mt;if(!ft||!pt)throw new Error;for(var t=k(function(){if(!lt)throw new Error;var t=y(l.countPart,C(lt.optionalCount)),e=y(l.explicitCountPart,C(lt.requiredCount)),n=C(lt.noCount);return C([t,e,n])}()),e=k(C(ft)),n=k(y(l.linewisePart,A(t,y(l.countPart,e)))),i=[],r=[],o=[],s=[],a=[],u=[],c=0,h=pt;c<h.length;c++){var f=h[c],d=f[0],p=f[1];p=bt(p,t,e,n);var g=0!=(1&d);0!=(2&d)&&(g?r.push(p):i.push(p)),0!=(4&d)&&(g?s.push(p):o.push(p)),0!=(8&d)&&(g?u.push(p):a.push(p))}var m=A(C(r),y(l.countPart,C(i))),v=new st(y(l.registerPart,m));m=A(C(s),y(l.countPart,C(o)));var b=new st(y(l.registerPart,m));m=A(C(u),y(l.countPart,C(a)));var S=new st(y(l.registerPart,m));return lt=null,ft=null,pt=null,mt={forNormal:v,forVisual:b,forVisualLine:S}}function bt(t,e,n,i){return"MotionHolder"===t.kind?e:"TextObjectHolder"===t.kind?n:"OperatorMotionHolder"===t.kind?i:(t.child?t.child=bt(t.child,e,n,i):t.left&&t.right&&(t.left=bt(t.left,e,n,i),t.right=bt(t.right,e,n,i)),t)}var yt={};function St(t,e){if(yt[t])throw new Error;yt[t]=e}var At=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ct=function(t){function e(e){var n=t.call(this,"Normal","Normal",e)||this;return n.subscriptions=[],n.checkCursorsScheduled=!1,n}return At(e,t),Object.defineProperty(e.prototype,"program",{get:function(){return vt().forNormal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapper",{get:function(){return X.nmap},enumerable:!0,configurable:!0}),e.prototype.enter=function(){var t=this;this.context.editor.updateOptions({cursorStyle:"block"});var e=this.context.editor.getSelections();e&&this.context.editor.setSelections(e.map(function(e){return t.context.position.soften(e.getPosition()).toSelection()})),this.subscriptions.push(this.context.editor.onDidChangeCursorSelection(function(e){return t.onSelectionChanged(e)})),this.subscriptions.push(this.context.editor.onDidChangeModelContent(function(e){return t.onContentChanged()}))},e.prototype.leave=function(){this.dispose()},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0,n=this.subscriptions;e<n.length;e++){n[e].dispose()}this.subscriptions=[]},e.prototype.onContentChanged=function(){var t=this;this.context.vimState.isExecutingCommand||(this.checkCursorsScheduled=!0,requestAnimationFrame(function(){if(t.checkCursorsScheduled){var e=t.context.editor,n=e.getSelections();n&&e.setSelections(n.map(function(e){return t.context.position.soften(e.getPosition()).toSelection()}))}}))},e.prototype.onSelectionChanged=function(t){var e=this;if(!this.context.vimState.isExecutingCommand)if(this.checkCursorsScheduled=!1,t.reason===i.editor.CursorChangeReason.Undo||t.reason===i.editor.CursorChangeReason.Redo||t.selection.isEmpty()&&t.secondarySelections.every(function(t){return t.isEmpty()})){var n=this.context.position.soften(t.selection.getPosition()),r=[i.Selection.fromPositions(n,n)];t.secondarySelections.forEach(function(t){var n=e.context.position.soften(t.getPosition());r.push(i.Selection.fromPositions(n,n))}),this.context.editor.setSelections(r)}else X.enterInsertModeIfSelectOutsideVim?this.context.vimState.toInsert():this.context.vimState.toVisual()},e}(Z),xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),kt=function(){function t(t,e){this.beforeAction=t,this.change=e,this.kind="none"}return t.prototype.setCount=function(t){this.beforeAction&&(this.beforeAction.args.count=t)},t.prototype.getCount=function(){return this.beforeAction&&this.beforeAction.args.count?this.beforeAction.args.count:1},t.prototype.execBeforeAction=function(t){if(this.beforeAction)return this.beforeAction.command.run(t,this.beforeAction.args)},t.prototype.execute=function(t){var e=this;return u(this.execBeforeAction(t),function(n){if(!1!==n){if(e.change){var r=t.editor.getSelections();if(r){var o=r.map(function(n){var r=t.model.getOffsetAt(n.getPosition()),o=Math.max(0,r-e.change.deleteBefore),s=t.model.getPositionAt(o),a=t.model.getPositionAt(Math.min(t.model.getValueLength(),r+e.change.deleteAfter));return{range:i.Range.fromPositions(s,a),text:e.change.text}}),s=t.model.pushEditOperations(r,o,function(t){return t.map(function(t){return i.Selection.fromPositions(t.range.getEndPosition())})});s&&t.editor.setSelections(s),t.editor.pushUndoStop()}}Nt(t)}})},t.prototype.commitInsertion=function(t){},t}(),wt=function(){function t(t,e,n){void 0===n&&(n=1),this.beforeAction=t,this.change=e,this.count=n,this.kind="text"}return t.prototype.setCount=function(t){this.count=t},t.prototype.getCount=function(){return this.count},t.prototype.execBeforeAction=function(t){if(this.beforeAction)return this.beforeAction.command.run(t,this.beforeAction.args)},t.prototype.execute=function(t){var e=this;return u(this.execBeforeAction(t),function(n){if(!1!==n){if(e.change){var r=e.count;if(0===e.change.deleteBefore&&0===e.change.deleteAfter){var o=e.change.text.repeat(r);if(!(a=t.editor.getSelections()))throw new Error;var s=a.map(function(t){return{range:i.Range.fromPositions(t.getPosition()),text:o}});(u=t.model.pushEditOperations(a,s,function(t){return t.map(function(t){return i.Selection.fromPositions(t.range.getEndPosition())})}))&&t.editor.setSelections(u)}else for(;0!==r;){var a;if(!(a=t.editor.getSelections()))throw new Error;var u;s=a.map(function(n){var r=t.model.getOffsetAt(n.getPosition()),o=Math.max(0,r-e.change.deleteBefore),s=t.model.getPositionAt(o),a=t.model.getPositionAt(Math.min(t.model.getValueLength(),r+e.change.deleteAfter));return{range:i.Range.fromPositions(s,a),text:e.change.text}});(u=t.model.pushEditOperations(a,s,function(t){return t.map(function(t){return i.Selection.fromPositions(t.range.getEndPosition())})}))&&t.editor.setSelections(u),r--}t.editor.pushUndoStop()}Nt(t)}})},t.prototype.commitInsertion=function(t){var e=this,n=this.count-1;if(this.change&&0!==n){if(0===this.change.deleteBefore&&0===this.change.deleteAfter){var r=this.change.text.repeat(n);if(!(s=t.editor.getSelections()))throw new Error;var o=s.map(function(t){return{range:i.Range.fromPositions(t.getPosition()),text:r}});(a=t.model.pushEditOperations(s,o,function(t){return t.map(function(t){return i.Selection.fromPositions(t.range.getEndPosition())})}))&&t.editor.setSelections(a)}else for(;0!==n;){var s;if(!(s=t.editor.getSelections()))throw new Error;var a;o=s.map(function(n){var r=t.model.getOffsetAt(n.getPosition()),o=Math.max(0,r-e.change.deleteBefore),s=t.model.getPositionAt(o),a=t.model.getPositionAt(Math.min(t.model.getValueLength(),r+e.change.deleteAfter));return{range:i.Range.fromPositions(s,a),text:e.change.text}});(a=t.model.pushEditOperations(s,o,function(t){return t.map(function(t){return i.Selection.fromPositions(t.range.getEndPosition())})}))&&t.editor.setSelections(a),n--}t.editor.pushUndoStop()}},t}(),Pt=function(){function t(t,e,n){void 0===n&&(n=1),this.beforeAction=t,this.change=e,this.count=n,this.kind="command"}return t.prototype.setCount=function(t){this.count=t},t.prototype.getCount=function(){return this.count},t.prototype.execBeforeAction=function(t){if(this.beforeAction)return this.beforeAction.command.run(t,this.beforeAction.args)},t.prototype.execute=function(t){for(var e=this,n=this.count;0!==n;)u(this.execBeforeAction(t),function(n){if(!1!==n&&e.change){var r=t.editor.getSelections();if(!r)throw new Error;var o=r.map(function(n){var r=t.model.getOffsetAt(n.getPosition()),o=Math.max(0,r-e.change.deleteBefore),s=t.model.getPositionAt(o),a=t.model.getPositionAt(Math.min(t.model.getValueLength(),r+e.change.deleteAfter));return{range:i.Range.fromPositions(s,a),text:e.change.text}}),s=t.model.pushEditOperations(r,o,function(t){return t.map(function(t){return i.Selection.fromPositions(t.range.getEndPosition())})});s&&t.editor.setSelections(s)}}),n--;t.editor.pushUndoStop(),Nt(t)},t.prototype.commitInsertion=function(t){for(var e=this,n=this.count-1;0!==n;)u(this.execBeforeAction(t),function(){if(e.change){var n=t.editor.getSelections();if(!n)throw new Error;var r=n.map(function(n){var r=t.model.getOffsetAt(n.getPosition()),o=Math.max(0,r-e.change.deleteBefore),s=t.model.getPositionAt(o),a=t.model.getPositionAt(Math.min(t.model.getValueLength(),r+e.change.deleteAfter));return{range:i.Range.fromPositions(s,a),text:e.change.text}}),o=t.model.pushEditOperations(n,r,function(t){return t.map(function(t){return i.Selection.fromPositions(t.range.getEndPosition())})});o&&t.editor.setSelections(o)}}),n--;t.editor.pushUndoStop()},t}();function Nt(t){var e=t.editor.getSelections();if(e&&e.length>0){var n=e.map(function(e){return t.position.get(e.getPosition()).shouldWrap(!1).move(-1).toSelection()});t.editor.setSelections(n),t.editor.revealRange(n[0])}t.vimState.toNormal()}for(var Et=function(t){function e(e){var n=t.call(this,"Insert","Insert")||this;return n.context=e,n.repeatable="none",n.subscriptions=[],n.insertionPoint=n.getInsertionPoint(),n}return xt(e,t),e.prototype.getInsertionPoint=function(){var t=this.context.editor.getSelections();if(!t||0===t.length)throw new Error;for(var e=t[0],n=1;n<t.length;n++)i.Range.compareRangesUsingStarts(t[n],e)<0&&(e=t[n]);return this.context.model.getOffsetAt(e.getPosition())},e.prototype.enter=function(t,e){var n=this;void 0===e&&(e="none"),this.context.editor.updateOptions({cursorStyle:"line"}),this.context.vimState.isRepeating||(this.beforeAction=t,this.repeatable=e,this.insertionPoint=this.getInsertionPoint(),this.subscriptions.push(this.context.editor.onDidChangeCursorPosition(function(t){return n.onCursorPositionChanged(t)})),this.subscriptions.push(this.context.editor.onDidChangeCursorSelection(function(t){return n.onSelectionChanged(t)})),this.subscriptions.push(this.context.model.onDidChangeContent(function(t){return n.onContentChanged(t)})))},e.prototype.leave=function(){this.change=void 0,this.repeatable="none",this.dispose()},e.prototype.dispose=function(){for(var t=0,e=this.subscriptions;t<e.length;t++){e[t].dispose()}this.subscriptions=[]},e.prototype.discardInputBuffer=function(){},e.prototype.handleInput=function(t,e){return t===N(9)?(this.commitChangeRecord(),Nt(this.context),!0):!(e||!E(t))&&(this.context.editor.trigger("vim","type",{text:String.fromCharCode(t)}),!0)},e.prototype.onCursorPositionChanged=function(t){t.reason===i.editor.CursorChangeReason.Explicit&&(this.stageChangeRecord(),this.insertionPoint=this.getInsertionPoint(),this.repeatable="text")},e.prototype.onSelectionChanged=function(t){},e.prototype.onContentChanged=function(t){if(0!==t.changes.length){var e=0,n=this.context.editor.getSelections();if(n&&(e=n.length),t.changes.length!==e)return this.stageChangeRecord(),void(this.insertionPoint=this.getInsertionPoint());this.change||(this.change={textStart:this.insertionPoint,textEnd:this.insertionPoint,deletionBefore:0,deletionAfter:0});for(var i=t.changes[0],r=1;r<t.changes.length;r++)t.changes[r].rangeOffset<i.rangeOffset&&(i=t.changes[r]);var o=i.rangeOffset,s=i.rangeOffset+i.rangeLength,a=i.rangeLength,u=i.text.length,c=this.change.textEnd-this.change.textStart;if(o>this.change.textEnd||s<this.change.textStart)return this.stageChangeRecord(),void(this.insertionPoint=this.context.model.getOffsetAt(this.context.editor.getPosition()));if(this.stagedRepeatAction=void 0,o<this.change.textStart){var l=this.change.textStart-o;this.change.deletionBefore+=l,this.change.textStart=o,a-=l}if(s>this.change.textEnd){l=s-this.change.textEnd;this.change.deletionAfter+=l,a-=l}this.change.textEnd=this.change.textStart+c+u-a}},e.prototype.commitChangeRecord=function(){if(this.stageChangeRecord(),this.stagedRepeatAction){var t=this.stagedRepeatAction;t.commitInsertion(this.context),p.setLastAction(t),this.stagedRepeatAction=void 0}},e.prototype.stageChangeRecord=function(){if(!this.stagedRepeatAction){var t=this.beforeAction;this.beforeAction=void 0;var e=(t?t.args.count:1)||1,n=this.change;this.change=void 0;var r,o=this.repeatable;if(this.repeatable="none",n){var s="";if(n.textStart!==n.textEnd){var a=this.context.model.getPositionAt(n.textStart),u=this.context.model.getPositionAt(n.textEnd),c=i.Range.fromPositions(a,u);s=this.context.model.getValueInRange(c)}r={text:s,deleteBefore:n.deletionBefore,deleteAfter:n.deletionAfter}}return"none"===o?this.stagedRepeatAction=new kt(t,r):"command"===o?this.stagedRepeatAction=new Pt(t,r,e):"text"===o&&(this.stagedRepeatAction=new wt(t,r,e)),this.stagedRepeatAction}},e}(z),Lt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),It=function(t){function e(e){var n=t.call(this,"Visual","Visual",e)||this;return n.subscriptions=[],n}return Lt(e,t),Object.defineProperty(e.prototype,"program",{get:function(){return vt().forVisual},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapper",{get:function(){return X.vmap},enumerable:!0,configurable:!0}),e.prototype.enter=function(t){var e=this;t&&(this.context.editor.setSelections(t),this.context.editor.revealRange(t[0]),this.updateDecoration()),this.context.editor.updateOptions({cursorStyle:"line"}),this.subscriptions.push(this.context.editor.onDidChangeCursorSelection(function(t){return e.onSelectionChanged(t)}))},e.prototype.leave=function(){this.decorations&&(this.decorations=this.context.editor.deltaDecorations(this.decorations,[])),this.dispose()},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0,n=this.subscriptions;e<n.length;e++){n[e].dispose()}this.subscriptions=[]},e.prototype.onSelectionChanged=function(t){var e=t.selection;this.context.vimState.isExecutingCommand||!e.isEmpty()||0!==t.secondarySelections.length?this.updateDecoration():this.context.vimState.toNormal()},e.prototype.updateDecoration=function(){var t=this.context.editor.getSelections();t&&(this.decorations=this.context.editor.deltaDecorations(this.decorations||[],t.filter(function(t){return!t.isEmpty()}).map(function(t){var e=t.getDirection()===i.SelectionDirection.LTR,n=t.getPosition();return{range:{startLineNumber:n.lineNumber,startColumn:Math.max(1,e?n.column-1:n.column),endLineNumber:n.lineNumber,endColumn:e?n.column:n.column+1},options:{stickiness:i.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,className:"visual-mode-fake-cursor"}}})))},e}(Z),Rt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Mt=function(t){function e(e){var n=t.call(this,"VisualLine","Visual Line",e)||this;return n.subscriptions=[],n}return Rt(e,t),Object.defineProperty(e.prototype,"program",{get:function(){return vt().forVisualLine},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapper",{get:function(){return X.vmap},enumerable:!0,configurable:!0}),e.prototype.enter=function(t){var e,n=this;if(this.context.editor.updateOptions({cursorStyle:"block"}),!(t&&t.length>0)){var r=this.context.editor.getPosition().lineNumber,o=this.context.position.get(r,1),s=this.context.position.get(r,"eol");return i.Selection.fromPositions(o,s)}e=t.map(function(t){var e,r;return t.first<=t.last?(e=n.context.position.get(t.first,1),r=n.context.position.get(t.last,"eol")):(e=n.context.position.get(t.first,"eol"),r=n.context.position.get(t.last,1)),i.Selection.fromPositions(e,r)}),this.context.vimState.previousVisual={kind:"line",first:e[0].selectionStartLineNumber,last:e[0].positionLineNumber},this.context.editor.setSelections(e),this.subscriptions.push(this.context.editor.onDidChangeCursorSelection(function(t){return n.onSelectionChanged(t)}))},e.prototype.leave=function(){this.dispose()},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0,n=this.subscriptions;e<n.length;e++){n[e].dispose()}this.subscriptions=[]},e.prototype.onSelectionChanged=function(t){var e=this,n=t.selection;if(!this.context.vimState.isExecutingCommand){if(n.isEmpty()&&0===t.secondarySelections.length)return void this.context.vimState.toNormal();var r=n.selectionStartLineNumber>n.positionLineNumber,o=this.context.editor.getSelections().map(function(t){var n,o,s=t.selectionStartLineNumber,a=t.positionLineNumber;if(r&&a>=s){var u=s;s=a,a=u}return r?(n=e.context.position.get(s,"eol"),o={lineNumber:a,column:1}):(n={lineNumber:s,column:1},o=e.context.position.get(a,"eol")),i.Selection.fromPositions(n,o)});this.context.editor.setSelections(o)}},e}(Z),Ot=" \f\n\r\t\v​  ​᠎ ​ ​ ​ ​  ​ ​ ​  ​ ​\u2028\u2029  ​　\ufeff",_t=new Set,Wt=0;Wt<"/\\()\"':,.;<>~!@#$%^&*|+=[]{}`?-".length;Wt++)_t.add("/\\()\"':,.;<>~!@#$%^&*|+=[]{}`?-".charCodeAt(Wt));var Vt=new Set;for(Wt=0;Wt<Ot.length;Wt++)Vt.add(Ot.charCodeAt(Wt));var Tt=function(){function t(t){this.editor=t,this.wrap=!0;var e=t.getModel();if(!e)throw new Error;this.model=e}return t.create=function(e,n,i){var r=new t(e);return r._lineCount=r.model.getLineCount(),r._line="$"===n?r._lineCount:r.cc(n,r._lineCount),r._lineLength=r.model.getLineLength(r._line),r.setColumn(i),r},t.prototype.clone=function(){var e=new t(this.editor);return e.wrap=this.wrap,e._lineCount=this._lineCount,e._line=this._line,e._index=this._index,e._lineLength=this._lineLength,e._lineText=this._lineText,e._char=this._char,e._kind=this._kind,e},t.prototype.assign=function(t){return this.wrap=t.wrap,this._lineCount=t._lineCount,this._line=t._line,this._index=t._index,this._lineLength=t._lineLength,this._lineText=t._lineText,this._char=t._char,this._kind=t._kind,this},Object.defineProperty(t.prototype,"lineNumber",{get:function(){return this._line},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this._index+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineLength",{get:function(){return this._lineLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineCount",{get:function(){return this._lineCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineText",{get:function(){return void 0===this._lineText&&(this._lineText=this.model.getLineContent(this._line)),this._lineText},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"char",{get:function(){return void 0===this._char&&(this._char=this._index===this._lineLength?"":this.lineText[this._index]),this._char},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kind",{get:function(){var t;return void 0===this._kind&&(this._kind=this._index===this._lineLength?4:function(t){return t>="a".charCodeAt(0)&&t<="z".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t==="_".charCodeAt(0)}(t=this.lineText.charCodeAt(this._index))?1:Vt.has(t)?0:_t.has(t)?2:3),this._kind},enumerable:!0,configurable:!0}),t.prototype.shouldWrap=function(t){return this.wrap=t,this},Object.defineProperty(t.prototype,"isBlank",{get:function(){return 0===this.kind||4===this.kind},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmptyLine",{get:function(){return 0===this._lineLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEOF",{get:function(){return this._line===this._lineCount&&this._index==this._lineLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBOF",{get:function(){return 1===this._line&&0===this._index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFileLastChar",{get:function(){return this._line===this._lineCount&&this._index+1>=this._lineLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLineLastChar",{get:function(){return this._index+1>=this._lineLength},enumerable:!0,configurable:!0}),t.prototype.cc=function(t,e){return t<1?1:t>e?e:t},t.prototype.resetCache=function(t){this._char=void 0,this._kind=void 0,t&&(this._lineText=void 0)},t.prototype.setColumn=function(t){var e;"^"===t?0===(e=this.model.getLineFirstNonWhitespaceColumn(this._line))&&(e=Math.max(1,this.model.getLineLength(this._line))):e="g_"===t?Math.max(1,this.model.getLineLastNonWhitespaceColumn(this._line)-1):"$"===t?Math.max(1,this.model.getLineLength(this._line)):"eol"===t?this.model.getLineMaxColumn(this._line):this.cc(t,this._lineLength+1);var n=e-1;return this._index!==n&&(this._index=n,this.resetCache(!1)),this},t.prototype.forward=function(){if(0===this._lineLength||this._index===this._lineLength){if(this._line===this.lineCount||!this.wrap)return!1;this._line+=1,this._index=0,this._lineLength=this.model.getLineLength(this._line),this.resetCache(!0)}else this._index++,this.resetCache(!1);return!0},t.prototype.backward=function(){if(0===this._index){if(1===this._line||!this.wrap)return!1;this._line-=1,this._lineLength=this.model.getLineLength(this._line),this._index=this._lineLength,this.resetCache(!0)}else this._index--,this.resetCache(!1);return!0},t.prototype.move=function(t){if(t>0)for(;0!==t&&this.forward();)t--;else if(t<0)for(;0!==t&&this.backward();)t++;return this},t.prototype.soft=function(){var t=this._index===this._lineLength?Math.max(0,this._lineLength-1):this._index;return this._index!==t&&(this._index=t,this.resetCache(!1)),this},t.prototype.stepIf=function(t){for(var e=this.clone(),n=this.clone(),i=0;n.forward()&&t(n);)e.assign(n),i++;return this.assign(e),i},t.prototype.stepTo=function(t,e){void 0===e&&(e=!0);for(var n=this.clone(),i=this.clone(),r=!1;i.forward();)if(n.assign(i),t(i)){r=!0;break}return(r||e)&&this.assign(n),r},t.prototype.stepTill=function(t,e){void 0===e&&(e=!0);for(var n=this.clone(),i=this.clone(),r=!1;i.forward();){if(t(i)){r=!0;break}n.assign(i)}return(r||e)&&this.assign(n),r},t.prototype.backIf=function(t){for(var e=this.clone(),n=this.clone(),i=0;n.backward()&&t(n);)e.assign(n),i++;return this.assign(e),i},t.prototype.backTo=function(t,e){void 0===e&&(e=!0);for(var n=this.clone(),i=this.clone(),r=!1;i.backward();)if(n.assign(i),t(i)){r=!0;break}return(r||e)&&this.assign(n),r},t.prototype.backTill=function(t,e){void 0===e&&(e=!0);for(var n=this.clone(),i=this.clone(),r=!1;i.backward();){if(t(i)){r=!0;break}n.assign(i)}return(r||e)&&this.assign(n),r},t.prototype.toRange=function(){return i.Range.fromPositions(this,this)},t.prototype.toSelection=function(t){return t=t||this,i.Selection.fromPositions(t,this)},t.prototype.reveal=function(t){void 0===t&&(t=0);var e=this.toRange();switch(t){case 0:this.editor.revealRange(e);break;case 1:this.editor.revealRangeInCenter(e);break;case 2:this.editor.revealRangeInCenterIfOutsideViewport(e);break;case 3:this.editor.revealRangeAtTop(e);break;case 4:this.editor._revealRange(e,4,!0,0)}return this},t.prototype.live=function(t){switch(void 0===t&&(t=0),t){case 0:this.editor.setPosition(this);break;case 1:this.setEditorPrimaryCurosr();break;case 2:this.setEditorPrimarySelectionActive()}return this},t.prototype.setEditorPrimaryCurosr=function(){var t=this.editor.getSelections();t&&0!==t.length&&(t[0]=this.toSelection(),this.editor.setSelections(t))},t.prototype.setEditorPrimarySelectionActive=function(){var t=this.editor.getSelections();if(t&&0!==t.length){var e={lineNumber:t[0].selectionStartLineNumber,column:t[0].selectionStartColumn};t[0]=this.toSelection(e),this.editor.setSelections(t)}},t}(),Dt=function(){function t(t){this.editor=t}return Object.defineProperty(t.prototype,"model",{get:function(){var t=this.editor.getModel();if(!t)throw new Error;return t},enumerable:!0,configurable:!0}),t.prototype.get=function(t,e){if(void 0===t){var n=this.editor.getPosition();if(!n)throw new Error;return Tt.create(this.editor,n.lineNumber,n.column)}return void 0!==t&&void 0!==e?Tt.create(this.editor,t,e):Tt.create(this.editor,t.lineNumber,t.column)},t.prototype.soften=function(t){return Tt.create(this.editor,t.lineNumber,t.column).soft()},t}(),Bt=function(){function t(t,e,n,r){this.editor=t,this.prefix=e,this.text=n,this.events=r,this.position={preference:i.editor.OverlayWidgetPositionPreference.TOP_CENTER},t.addOverlayWidget(this)}return t.prototype.dispose=function(){var t=this;setTimeout(function(){t.editor.removeOverlayWidget(t),t.editor.focus()},0)},t.prototype.getId=function(){return"vim_external_input_widget"},t.prototype.getDomNode=function(){return this.buildDomNode()},t.prototype.getPosition=function(){return this.position},t.prototype.buildDomNode=function(){var t=this;if(!this.domNode){var e=document.createElement("div");e.style.width="500px",e.style.marginRight="-250px",this.domNode=e,e.innerHTML='\n            <div class="monaco-inputbox">\n                <div class="wrapper" style="position:relative;padding:6px;background:#fff;box-shadow:0 2px 13px rgba(0,0,0,.3);;">\n                    <span style="position:absolute;line-height:20px;margin-top:-10px;left:6px;top:50%;font-size:13px;width:13px;text-align:right;color:#282828">'+this.prefix+'</span>\n                    <input class="input" style="padding-left:15px;background:#fff;color:#282828;border:0 none;"/>\n                </div>\n            </div>\n            ';var n=e.querySelector("input");0!==this.text.length&&(n.value=this.text),n.addEventListener("keydown",function(e){"Escape"===e.key||"Backspace"===e.key&&""===n.value?(t.events.onCancel(),t.dispose()):"Enter"===e.key&&(t.events.onSubmit(n.value),t.dispose())}),n.addEventListener("input",function(e){t.events.onChange(n.value)}),n.addEventListener("blur",function(e){t.events.onCancel(),t.dispose()}),setTimeout(function(){n.focus()},0)}return this.domNode},t}(),jt=function(){function t(t){var e=this;this.editor=t,this.marks=new Map,this.removedMarks=new Map,this.subcriptions=[],this.prevVersionId=this.editor.getModel().getAlternativeVersionId(),this.subcriptions.push(this.editor.onDidChangeModelContent(function(t){0!==t.changes.length&&e.onTextChanged(t),e.prevVersionId=e.editor.getModel().getAlternativeVersionId()}))}return t.prototype.dispose=function(){for(var t=0,e=this.subcriptions;t<e.length;t++){e[t].dispose()}},t.prototype.getMark=function(t){return this.marks.get(t)},t.prototype.setMark=function(t,e){this.marks.set(t,i.Position.lift(e))},t.prototype.onTextChanged=function(t){for(var e,n,i=this,r=t.changes.sort(function(t,e){return t.rangeOffset-e.rangeOffset}),o=[],s=0,a=r;s<a.length;s++){var u=a[s],c=u.range.startLineNumber,l=u.range.endLineNumber,h=l-c,f=(e=u.text,n=void 0,(n=e.match(/\n/g))?n.length:0),d=(o.length?o[o.length-1].diff:0)+f-h;o.push({startLn:c,endLn:l,diff:d})}for(var p=new Set,g=function(t){var e=o[t-1];m.marks.forEach(function(t,n){p.has(n)||(t.lineNumber>=e.endLn?i.marks.set(n,{lineNumber:t.lineNumber+e.diff,column:t.column}):t.lineNumber<e.endLn&&t.lineNumber>=e.startLn&&(i.removedMarks.has(i.prevVersionId)||i.removedMarks.set(i.prevVersionId,[]),i.removedMarks.get(i.prevVersionId).push({name:n,position:t}),i.marks.delete(n)))})},m=this,v=o.length;v>0;v--)g(v);if(t.isUndoing){var b=this.editor.getModel().getAlternativeVersionId();if(this.removedMarks.has(b))for(var y=0,S=this.removedMarks.get(b);y<S.length;y++){var A=S[y];this.marks.has(A.name)||this.marks.set(A.name,A.position)}}},t}();St("mark",function(t){return new jt(t.editor)});var Kt={"<":{get:function(t){var e=t.vimState.previousVisual;if(e)return"char"===e.kind?e.start:e.first<=e.last?t.position.get(e.first,1):t.position.get(e.first,"$")},set:function(t,e){throw new Error("Not implemented")}},">":{get:function(t){var e=t.vimState.previousVisual;if(e)return"char"===e.kind?e.end:e.first<=e.last?t.position.get(e.last,"$"):t.position.get(e.last,1)},set:function(t,e){throw new Error("Not implemented")}}};function Ft(t,e){return Kt[e]?Kt[e].get(t):t.vimState.getContextData("mark").getMark(e)}function Ut(t,e,n){Kt[e]?Kt[e].set(t,n):t.vimState.getContextData("mark").setMark(e,n)}function Qt(t,e,n){if(1===e.length){var i=et(e.charCodeAt(0));if(i)return void Ut(t,i,n)}throw new Error}gt(["m",{kind:"Mark"}],"n",function(t,e){var n=t.position.get();Ut(t,e.mark,n)}),ht(["'",{kind:"Mark"}],{isJump:!0,run:function(t,e,n,i,r,o){var s=Ft(t,o.mark);return s?t.position.get(s.lineNumber,"^"):null}}),ht(["`",{kind:"Mark"}],{isJump:!0,run:function(t,e,n,i,r,o){return Ft(t,o.mark)||null}});var Ht=[{type:"boolean",names:["ignorecase","ic"],getValue:function(){return X.ignoreCase},setValue:function(t){return X.ignoreCase=t}},{type:"boolean",names:["smartcase","scs"],getValue:function(){return X.smartCase},setValue:function(t){return X.smartCase=t}},{type:"boolean",names:["hlsearch","hls"],getValue:function(){return X.highlightSearch},setValue:function(t){return X.highlightSearch=t}},{type:"boolean",names:["incsearch","is"],getValue:function(){return X.incrementalSearch},setValue:function(t){return X.incrementalSearch=t}},{type:"string",names:["whichwrap","ww"],getValue:function(){return X.whichWrap},setValue:function(t){return X.whichWrap=t}}];function qt(t,e,n){var i=Ht.find(function(t){return t.names.indexOf(e)>=0});i?n(i):t.vimState.outputError("Unknown option")}var zt=[{matcher:/^set?\s+no([^=:\s]+)\s*$/,handler:function(t,e){qt(t,e[1],function(e){"boolean"===e.type?(e.setValue(!1),t.vimState.outputInfo("no"+e.names[0])):t.vimState.outputError("Not a toggle option")})}},{matcher:/^set?\s+(?:inv([^=:\s]+)|([^=:\s]+)!)\s*$/,handler:function(t,e){var n=e[1]||e[2];qt(t,n,function(e){if("boolean"===e.type){var n=!e.getValue();e.setValue(n),t.vimState.outputInfo((n?"":"no")+e.names[0])}else t.vimState.outputError("Not a toggle option")})}},{matcher:/^set?\s+([^=:\s]+)\?\s*$/,handler:function(t,e){qt(t,e[1],function(e){"boolean"===e.type?t.vimState.outputInfo((e.getValue()?"":"no")+e.names[0]):t.vimState.outputInfo(e.getValue().toString())})}},{matcher:/^set?\s+([^=:\s]+)\s*$/,handler:function(t,e){qt(t,e[1],function(e){"boolean"===e.type?(e.setValue(!0),t.vimState.outputInfo(e.names[0])):t.vimState.outputInfo(e.getValue().toString())})}},{matcher:/^set?\s+([^=:\s]+)[=:](\S+)\s*$/,handler:function(t,e){var n=e[1],i=e[2];Ht.forEach(function(e){if(e.names.indexOf(n)>=0)if("boolean"===e.type)t.vimState.outputError("Invaid argument");else if("string"===e.type)e.setValue(i);else{var r=parseInt(i);isNaN(r)?t.vimState.outputError("Number required after ="):e.setValue(Math.floor(r))}})}},{matcher:/^(n|v)map\s+(\S+)\s+(\S+)\s*$/,handler:function(t,e){"n"===e[1]?X.nmap.addString(e[2],e[3]):X.vmap.addString(e[2],e[3])}}];var Zt=[];function Gt(t){Zt.push(t)}function Jt(t,e){for(var n=0,i=t;n<i.length;n++){var r=i[n];if("function"==typeof r.matcher){var o=r.matcher(e);if(null!==o)return{command:r,matchedValues:o}}else{var s=e.match(r.matcher);if(s)return{command:r,matchedValues:s}}}}function Yt(t,e){e=e.replace(/^\s+/,"");var n=null;try{n=new $t(e).match()}catch(n){return void t.vimState.outputError("Invalid command range: "+e)}if(n){var i=function(t,e){for(var n=t.position.get().lineNumber,i=[],r=0,o=e;r<o.length;r++){var s=o[r],a=Xt(t,s,n);if("string"==typeof a)return a;i.push(a),s.updateCursorLine&&(n=a)}var u=i.length;if(u>1)return[i[u-2],i[u-1]];if(1===u)return[i[0],i[0]];throw new Error}(t,n.range);if("string"==typeof i)return void t.vimState.outputError(i);if(""===(e=e.substring(n.next)))return void t.position.get(i[1],"^").live();if(a=Jt(Zt,e)){var r=i[0],o=i[1];if(r>o){var s=r;r=o,o=s}return a.command.handler(t,{first:r,last:o},a.matchedValues)}}else{if(a=Jt(zt,e))return a.command.handler(t,a.matchedValues);var a=Jt(Zt,e),u=t.editor.getPosition().lineNumber;if(a)return a.command.handler(t,{first:u,last:u},a.matchedValues)}t.vimState.outputError("Invalid command: "+e)}function Xt(t,e,n){var i,r=t.model.getLineCount();if("number"===e.kind)i=e.value;else if("cursor"===e.kind)i=n;else if("last"===e.kind)i=r;else{var o=function(t,e){if(1===e.length){var n=et(e.charCodeAt(0));if(n)return Ft(t,n)}}(t,e.name);if(!o)return"Invalid mark";i=o.lineNumber}return e.offset&&(i+=e.offset),i>r?r:i<1?1:i}var $t=function(){function t(t){this.input=t,this.pos=0,this.len=t.length}return t.prototype.match=function(){var t,e=[];if(this.matchOne(e))for(;(t=this.tryMatchCharSet(",;"))&&(";"===t&&(e[e.length-1].updateCursorLine=!0),this.skipWhiteSpace(),this.matchOne(e)););return 0===e.length?null:{range:e,next:this.pos}},t.prototype.matchOne=function(t){var e,n=null;if(null!==(e=this.tryMatchNumber())){var i={kind:"number",value:e};return this.matchOffset(i),t.push(i),this.skipWhiteSpace(),!0}if(n=this.tryMatchCharSet(".$")){i={kind:"."===n?"cursor":"last"};return this.matchOffset(i),t.push(i),this.skipWhiteSpace(),!0}if(this.peekSet("+-")){i={kind:"cursor"};return this.matchOffset(i),t.push(i),this.skipWhiteSpace(),!0}if(this.tryMatchString("%")){var r={kind:"number",value:1},o={kind:"last"};return this.matchOffset(),t.push(r),t.push(o),this.skipWhiteSpace(),!0}if(this.tryMatchString("*")){r={kind:"mark",name:"<"},o={kind:"mark",name:">"};return this.matchOffset(),t.push(r),t.push(o),this.skipWhiteSpace(),!0}if(this.tryMatchString("'")){i={kind:"mark",name:this.matchChar()};return this.matchOffset(i),t.push(i),this.skipWhiteSpace(),!0}return!1},t.prototype.matchOffset=function(t){for(var e,n=0,i=function(){var t,i,o="+"===e?1:-1;t=r.tryMatchNumber(),i=function(t){return o*=t},null!==t&&i(t),n+=o},r=this;e=this.tryMatchCharSet("+-");)i();0!==n&&t&&(t.offset=n)},t.prototype.peekSet=function(t){var e=this.input.charAt(this.pos);return t.indexOf(e)>=0},t.prototype.skipWhiteSpace=function(){for(;this.pos<this.len;){var t=this.input.charCodeAt(this.pos);if(32!==t&&9!==t)break;this.pos++}},t.prototype.matchChar=function(){if(this.pos>=this.len)throw new Error;return this.input.charAt(this.pos++)},t.prototype.tryMatchString=function(t){return this.pos+t.length-1<this.len&&this.input.substring(this.pos,this.pos+t.length)===t?(this.pos+=t.length,t):null},t.prototype.tryMatchCharSet=function(t){if(this.pos<this.len){var e=this.input[this.pos];if(t.indexOf(e)>=0)return this.pos++,e}return null},t.prototype.tryMatchNumber=function(){for(var t=this.pos,e=this.pos;e<this.len;){var n=this.input.charCodeAt(e);if(!(n>=48&&n<=57))break;e++}return t!==e?(this.pos=e,parseInt(this.input.substring(t,e))):null},t}();function te(t,e,n,i){var r=t.position.get(),o=e.count||1;t.editor.trigger("vim","editorScroll",{to:n,by:i,value:o});var s=t.editor.getVisibleRanges();if(s.length>0){var a=s[0].startLineNumber,u=s[0].endLineNumber;if(!(r.lineNumber>=a&&r.lineNumber<=u)){r=t.position.get("down"===n?a:u,r.column);var c=t.vimState.isVisual()?2:1;r.live(c)}}}function ee(t,e,n){var i=t.position.get(),r=0,o=t.editor.getVisibleRanges();if(o.length>0){var s=o[0].startLineNumber,a=o[0].endLineNumber;i.lineNumber>=s&&i.lineNumber<a&&(r=i.lineNumber-s)}var u=e.count||1;if(t.editor.trigger("vim","editorScroll",{to:n,by:"halfPage",value:u}),(o=t.editor.getVisibleRanges()).length>0){i=t.position.get(o[0].startLineNumber+r,i.column);var c=t.vimState.isVisual()?2:1;i.live(c)}}gt("i","n",function(t,e){t.editor.revealPosition(t.editor.getPosition()),t.vimState.toInsert({command:this,args:e},"text")}),gt("I","n",function(t,e){var n=t.editor.getSelections();if(n){var r=n.map(function(e){var n=t.position.get(e.getPosition().lineNumber,"^");return i.Selection.fromPositions(n)});t.editor.setSelections(r),t.editor.revealRange(r[0]),t.vimState.toInsert({command:this,args:e},"text")}}),gt("a","n",function(t,e){var n=t.editor.getSelections();if(n){var r=n.map(function(e){var n=t.position.get(e.getPosition()).shouldWrap(!1).move(1);return i.Selection.fromPositions(n)});t.editor.setSelections(r),t.editor.revealRange(r[0]),t.vimState.toInsert({command:this,args:e},"text")}}),gt("A","n",function(t,e){var n=t.editor.getSelections();if(n){var r=n.map(function(e){var n=t.position.get(e.getPosition().lineNumber,"eol");return i.Selection.fromPositions(n)});t.editor.setSelections(r),t.editor.revealRange(r[0]),t.vimState.desiredColumn="eol",t.vimState.toInsert({command:this,args:e},"text")}}),gt("o","n",function(t,e){t.editor.getAction("editor.action.insertLineAfter").run(),t.vimState.toInsert({command:this,args:e},"command")}),gt("O","n",function(t,e){t.editor.getAction("editor.action.insertLineBefore").run(),t.vimState.toInsert({command:this,args:e},"command")}),gt("v","n",function(t,e){var n=t.editor.getSelections();if(n){var r=e.count||0,o=n.map(function(e){var n=t.position.get(e.getPosition()),o=n.clone().shouldWrap(!1).move(r);return i.Selection.fromPositions(n,o)});o=function(t){if(0===t.length)return[];for(var e=Array.from(t),n=0;n<e.length;n++)for(var r=e[n].getDirection(),o=n+1;o<e.length;)if(i.Range.intersectRanges(e[n],e[o])){var s=i.Range.plusRange(e[n],e[o]);e[n]=i.Selection.createWithDirection(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn,r),e.splice(o,1)}else o++;return e}(o),t.vimState.toVisual(o)}}),gt("V","n",function(t,e){var n=t.editor.getSelections();if(n){var i=e.count||1,r=n.map(function(t){var e=t.getPosition().lineNumber;return{first:e,last:e+i-1}});r=s(r),t.vimState.toVisualLine(r)}}),gt("gv","n",function(t,e){var n=t.vimState.previousVisual;if(void 0===n)t.vimState.beep();else if("char"===n.kind){var r=t.position.get(n.start),o=t.position.get(n.end);t.vimState.toVisual([i.Selection.fromPositions(r,o)])}else t.vimState.toVisualLine([n])}),gt(".","n",function(t,e){p.repeatLast(t,e.count)}),gt(c.motion,"~n",function(t,e){var n=t.editor.getSelections();if(n){if(!e.motion)throw new Error;t.vimState.isMovingCursorByMotion=!0;var r=0,o=t.editor.getPosition();if(!0!==e.motion.makeSelection){var s=n.map(function(n,s){var a=g("Move",t,e,n.getPosition());if(a){var u=t.position.get(a.to.lineNumber,a.to.column).soft();return 0===s&&(a.isJump&&!i.Position.equals(o,u)&&Qt(t,"'",o),!0!==a.keepPrevDesiredColumn&&(t.vimState.desiredColumn=a.desiredColumnAtEol?"eol":a.to.column)),u}return r++,n.getPosition()});r===s.length&&t.vimState.beep(),t.editor.setSelections(function(t){if(0===t.length)return[];for(var e=t.map(function(t){return{lineNumber:t.lineNumber,column:t.column}}),n=0;n<e.length;n++)for(var r=n+1;r<e.length;)i.Position.equals(e[n],e[r])?e.splice(r,1):r++;return e}(s).map(function(t){return i.Selection.fromPositions(t,t)})),t.editor.revealPosition(s[0])}else{var a=[];n.forEach(function(n){var r=g("Move",t,e,n.getPosition());if(r){var o=i.Position.isBeforeOrEqual(r.from,r.to),s=o||!r.inclusive?r.from:t.position.get(r.from).move(1),u=o&&r.inclusive?t.position.get(r.to).move(1):r.to;a.push(i.Selection.fromPositions(s,u))}}),a.length>0?(!0!==e.motion.keepPrevDesiredColumn&&(t.vimState.desiredColumn=e.motion.desiredColumnAtEol?"eol":a[0].getPosition().column),t.vimState.toVisual(a),t.editor.revealRange(a[0])):t.vimState.beep()}t.vimState.isMovingCursorByMotion=!1}}),gt(c.motion,"~V",function(t,e){var n=t.editor.getSelections();if(n){t.vimState.isMovingCursorByMotion=!0;var r=0,o=t.editor.getPosition(),s=n.map(function(n,s){var a=new i.Position(n.selectionStartLineNumber,n.selectionStartColumn),u=g("Select",t,e,n.getPosition());if(u){var c=i.Position.isBeforeOrEqual(a,u.to)&&u.inclusive?t.position.get(u.to).move(1):u.to;return 0===s&&(u.isJump&&!i.Position.equals(o,c)&&Qt(t,"'",o),!0!==u.keepPrevDesiredColumn&&(t.vimState.desiredColumn=u.desiredColumnAtEol?"eol":u.to.column),t.vimState.previousVisual={kind:"char",start:a,end:c}),i.Selection.fromPositions(a,c)}return r++,n});r===n.length?t.vimState.beep():t.editor.setSelections(s),t.editor.revealPosition(s[0].getPosition()),t.vimState.isMovingCursorByMotion=!1}}),gt(c.TextObject,"V",function(t,e){var n=t.editor.getSelections();if(n){t.vimState.isMovingCursorByMotion=!0;var r=0,o=n.map(function(n,o){var s=g("Select",t,e,n.getPosition());if(s){var a=t.position.get(s.to).move(1);!0!==s.keepPrevDesiredColumn&&(t.vimState.desiredColumn=s.desiredColumnAtEol?"eol":s.to.column);var u=i.Range.fromPositions(s.from,a);return i.Range.areIntersectingOrTouching(n,u)&&(u=i.Range.plusRange(n,u)),0===o&&(!0!==s.keepPrevDesiredColumn&&(t.vimState.desiredColumn=s.desiredColumnAtEol?"eol":s.to.column),t.vimState.previousVisual={kind:"char",start:u.getStartPosition(),end:u.getEndPosition()}),i.Selection.fromPositions(u.getStartPosition(),u.getEndPosition())}return r++,n});r===n.length?t.vimState.beep():t.editor.setSelections(o),t.editor.revealPosition(o[0].getPosition()),t.vimState.isMovingCursorByMotion=!1}}),gt("o","V",function(t,e){var n=t.editor.getSelections();if(n){var r=n.map(function(e,n){var r={lineNumber:e.positionLineNumber,column:e.positionColumn},o={lineNumber:e.selectionStartLineNumber,column:e.selectionStartColumn};return 0===n&&(t.vimState.previousVisual={kind:"char",start:r,end:o}),i.Selection.fromPositions(r,o)});t.editor.setSelections(r),t.editor.revealRange(r[0])}}),gt("<ESC>, v","V",function(t,e){t.vimState.toNormal()}),gt("V","V",function(t,e){var n=t.editor.getSelections();n&&t.vimState.toVisualLine(n.map(function(t){return{first:t.selectionStartLineNumber,last:t.positionLineNumber}}))}),gt(c.motion,"~L",function(t,e){var n=t.editor.getSelections();if(n){t.vimState.isMovingCursorByMotion=!0;var r=0,o=n.map(function(n,o){var s={lineNumber:n.selectionStartLineNumber,column:n.selectionStartColumn},a={lineNumber:n.positionLineNumber,column:n.positionColumn},u=g("Move",t,e,a);if(u){var c=i.Position.isBeforeOrEqual(s,u.to)&&u.inclusive?t.position.get(u.to).move(1):u.to;return!0!==u.keepPrevDesiredColumn&&(t.vimState.desiredColumn=u.desiredColumnAtEol?"eol":u.to.column),{start:s.lineNumber,target:c.lineNumber}}return r++,{start:s.lineNumber,target:a.lineNumber}});r===n.length?t.vimState.beep():(o=function(t){for(var e=t.map(function(t){var e=t.target<t.start;return{inverse:e,first:e?t.target:t.start,last:e?t.start:t.target,get start(){return this.inverse?this.last:this.first},get target(){return this.inverse?this.first:this.last}}}),n=0;n<e.length;n++)for(var i=n+1;i<e.length;)e[i].first-1<=e[n].last&&e[i].last+1>=e[n].first?(e[n].first=Math.min(e[n].first,e[i].first),e[n].last=Math.max(e[n].last,e[i].last),e.splice(i,1)):i++;return e}(o),n=o.map(function(e){var n;if(e.start<=e.target){var r=t.position.get(e.start,1);return n=t.position.get(e.target,"eol"),i.Selection.fromPositions(r,n)}r=t.position.get(e.start,"eol");return n=t.position.get(e.target,1),i.Selection.fromPositions(r,n)}),t.editor.setSelections(n)),t.editor.revealRange(n[0]),t.vimState.isMovingCursorByMotion=!1,t.vimState.previousVisual={kind:"line",first:n[0].selectionStartLineNumber,last:n[0].positionLineNumber}}}),gt("o","L",function(t,e){var n=t.editor.getSelections();if(n){var r=n.map(function(e,n){var r,o,s=e.positionLineNumber,a=e.selectionStartLineNumber;return s<=a?(r=t.position.get(s,1),o=t.position.get(a,"eol")):(r=t.position.get(s,"eol"),o=t.position.get(a,1)),0===n&&(t.vimState.previousVisual={kind:"line",first:r.lineNumber,last:o.lineNumber}),i.Selection.fromPositions(r,o)});t.editor.setSelections(r),t.editor.revealRange(r[0])}}),gt("<ESC>, V","L",function(t,e){t.vimState.toNormal()}),gt("v","L",function(t,e){var n=t.editor.getSelections();n&&t.vimState.toVisual(n)});var ne={"<C-E>":function(t,e){te(t,e,"down","line")},"<C-D>":function(t,e){ee(t,e,"down")},"<C-F>":function(t,e){te(t,e,"down","page")},"z+":function(t,e){var n=t.vimState.isVisual()?2:1,i=e.count||t.editor.getVisibleRanges()[0].endLineNumber+1,r=t.position.get(i,"^");t.editor.trigger("vim","revealLine",{lineNumber:r.lineNumber-1,at:"top"}),r.reveal().live(n)},"<C-Y>":function(t,e){te(t,e,"up","line")},"<C-U>":function(t,e){ee(t,e,"up")},"<C-B>":function(t,e){te(t,e,"up","page")},"z^":function(t,e){var n=t.vimState.isVisual()?2:1,i=e.count||t.editor.getVisibleRanges()[0].startLineNumber-1,r=t.position.get(i,"^");t.editor.trigger("vim","revealLine",{lineNumber:r.lineNumber-1,at:"bottom"}),r.reveal().live(n)},"z<CR>":function(t,e){var n=t.vimState.isVisual()?2:1,i=t.position.get();e.count?i=t.position.get(e.count,"^"):i.setColumn("^"),t.editor.trigger("vim","revealLine",{lineNumber:i.lineNumber-1,at:"top"}),i.reveal().live(n)},zt:function(t,e){var n=t.vimState.isVisual()?2:1,i=t.position.get();e.count&&(i=t.position.get(e.count,i.column)),t.editor.trigger("vim","revealLine",{lineNumber:i.lineNumber-1,at:"top"}),i.reveal().live(n)},"z.":function(t,e){var n=t.vimState.isVisual()?2:1,i=t.position.get();e.count?i=t.position.get(e.count,"^"):i.setColumn("^"),t.editor.trigger("vim","revealLine",{lineNumber:i.lineNumber-1,at:"center"}),i.reveal().live(n)},zz:function(t,e){var n=t.vimState.isVisual()?2:1,i=t.position.get();e.count&&(i=t.position.get(e.count,i.column)),t.editor.trigger("vim","revealLine",{lineNumber:i.lineNumber-1,at:"center"}),i.reveal().live(n)},"z-":function(t,e){var n=t.vimState.isVisual()?2:1,i=t.position.get();e.count?i=t.position.get(e.count,"^"):i.setColumn("^"),t.editor.trigger("vim","revealLine",{lineNumber:i.lineNumber-1,at:"bottom"}),i.reveal().live(n)},zb:function(t,e){var n=t.vimState.isVisual()?2:1,i=t.position.get();e.count&&(i=t.position.get(e.count,i.column)),t.editor.trigger("vim","revealLine",{lineNumber:i.lineNumber-1,at:"bottom"}),i.reveal().live(n)}};for(var ie in ne)gt(ie,"nv",ne[ie]);gt("gd","n",function(t,e){t.editor.trigger("vim","editor.action.goToDeclaration",null)}),gt("gh","n",function(t,e){t.editor.trigger("vim","editor.action.showHover",null)}),gt("gl","n",function(t,e){t.editor.trigger("vim","editor.action.wordHighlight.trigger",null)}),gt("gb","nv",function(t,e){t.editor.trigger("vim","editor.action.addSelectionToNextFindMatch",null);var n=t.editor.getSelections();n&&n.every(function(t){return!t.isEmpty()})&&t.vimState.toVisual()}),gt(":","nv",function(t,e){var n="";t.vimState.isVisual()?n="'<,'>":1===e.count?n=".":e.count&&(n=".,.+"+(e.count-1).toString()),t.vimState.requestExternalInput(":",n,function(){}).then(function(e){e&&Yt(t,e)})});var re=function(){function t(){}return t.findNextWordStart=function(t,e,n,i,r,o){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=!1);t.getModel();var s=Tt.create(t,e.lineNumber,e.column),a=!s.isBlank;if(i)for(;n&&!s.isEOF;)s.isBlank||s.stepTo(function(t){return t.isBlank}),a&&1===n&&r||s.stepTo(function(t){return!t.isBlank||t.isEmptyLine}),n--;else for(;n&&!s.isEOF;)s.isBlank||s.stepTo(function(t){return t.kind!=s.kind}),a&&1===n&&r||s.isBlank&&s.stepTo(function(t){return!t.isBlank||t.isEmptyLine}),n--;if(o&&s.lineNumber!==e.lineNumber){for(var u=!0,c=s.clone();c.backward();)if(0!==c.kind){4!==c.kind&&(u=!1);break}return u?c:s}return s},t.findNextWordEnd=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();for(var r=Tt.create(t,e.lineNumber,e.column);n&&!r.isEOF;)r.forward(),r.isBlank&&r.stepTo(function(t){return!t.isBlank}),r.stepIf(i?function(t){return!t.isBlank}:function(t){return t.kind===r.kind}),n--;return r},t.findPrevWordStart=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();var r=Tt.create(t,e.lineNumber,e.column);if(r.isBOF)return null;for(;n&&!r.isBOF;)r.backward(),r.isBlank&&r.backTo(function(t){return!t.isBlank||t.isEmptyLine}),r.isEmptyLine||r.backIf(i?function(t){return!t.isBlank}:function(t){return t.kind===r.kind}),n--;return r},t.findPrevWordEnd=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();var r=Tt.create(t,e.lineNumber,e.column);if(r.isBOF)return null;if(i)for(;n&&!r.isBOF;)r.isBlank&&!r.isEmptyLine||r.backTo(function(t){return t.isBlank}),r.isEmptyLine||r.backTo(function(t){return!t.isBlank||t.isEmptyLine}),n--;else for(;n&&!r.isBOF;)r.isBlank&&!r.isEmptyLine||r.backTo(function(t){return t.kind!=r.kind}),r.isBlank&&!r.isEmptyLine&&r.backTo(function(t){return!t.isBlank||t.isEmptyLine}),n--;return r},t.findOuterWord=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();for(var r=Tt.create(t,e.lineNumber,e.column),o=1,s=!1,a=r.clone();o<=n&&!r.isEOF;)1===o?(0===r.kind?(r.backIf(function(t){return 0===t.kind}),s=!0):r.backIf(i?function(t){return 0!==t.kind}:function(t){return t.kind===r.kind}),a.assign(r)):r.forward(),0===r.kind?r.stepTo(function(t){return!t.isBlank}):s=!1,r.stepIf(i?function(t){return!t.isBlank}:function(t){return t.kind===r.kind}),s||o!==n||0===r.stepIf(function(t){return 0===t.kind})&&0!==a.kind&&a.shouldWrap(!1).backTill(function(t){return!t.isBlank},!1),o++;return{from:a,to:r.soft()}},t.findInnerWord=function(t,e,n,i){void 0===i&&(i=!1);t.getModel();var r=Tt.create(t,e.lineNumber,e.column),o=1,s=r.clone();for(s.shouldWrap(!1).backIf(s.isBlank?function(t){return t.isBlank}:i?function(t){return!t.isBlank}:function(t){return t.kind===r.kind});o<=n&&!r.isEOF;)1!==o&&r.forward(),r.stepIf(r.isBlank?function(t){return 0===t.kind}:i?function(t){return!t.isBlank}:function(t){return t.kind===r.kind}),o++;return{from:s,to:r.soft()}},t.markQuotePairs=function(t,e,n){t.getModel();for(var i,r=Tt.create(t,e.lineNumber,e.column).shouldWrap(!1).setColumn(1),o=[];r.forward();){var s=r.char;s===n?void 0===i?i=r.column:(o.push([i,r.column]),i=void 0):"\\"===s&&r.forward()}return o},t.findOuterQuote=function(e,n,i){e.getModel();for(var r=n.column,o=0,s=t.markQuotePairs(e,n,i);o<s.length;o++){var a=s[o];if(a[1]>=r){var u=n.lineNumber;return{from:{lineNumber:u,column:a[0]},to:{lineNumber:u,column:a[1]}}}}return null},t.findInnerQuote=function(e,n,i){for(var r=n.column,o=0,s=t.markQuotePairs(e,n,i);o<s.length;o++){var a=s[o];if(a[1]>=r){var u=n.lineNumber,c=a[0],l=a[1];return c+1!==l&&(c++,l--),{from:{lineNumber:u,column:c},to:{lineNumber:u,column:l}}}}return null},t.getWordToSearch=function(t,e){var n,r=t.getModel(),o=Tt.create(t,e.lineNumber,e.column).shouldWrap(!1).clone();if(1===o.kind){var s=o.clone();o.backIf(function(t){return 1===t.kind}),s.stepTo(function(t){return 1!==t.kind}),n=r.getValueInRange(i.Range.fromPositions(o,s))}else{if(o.stepTo(function(t){return 1===t.kind},!1))(s=o.clone()).stepTo(function(t){return 1!==t.kind}),n=r.getValueInRange(i.Range.fromPositions(o,s));else if(o.isBlank){if(o.stepTo(function(t){return!t.isBlank}))(s=o.clone()).stepTo(function(t){return t.isBlank}),n=r.getValueInRange(i.Range.fromPositions(o,s))}else{var s=o.clone();o.backIf(function(t){return!t.isBlank}),s.stepTo(function(t){return t.isBlank}),n=r.getValueInRange(i.Range.fromPositions(o,s))}}return{start:o,searchString:n}},t}();function oe(t,e){try{t.forceTokenization(e.lineNumber);var n=t.getLineTokens(e.lineNumber),i=n.findTokenIndexAtOffset(e.column-1);return 0!==n.getStandardTokenType(i)}catch(t){}return!1}var se=function(){function t(){}return t.findClosing=function(t,e,n,i){var r,o=t.position.get(e);if(o.char!==n[0]||(r=!oe(t.model,o),o.forward()))for(var s=0;!o.isEOF;){var a=o.char;if(a!==n[1]||r&&oe(t.model,o))a!==n[0]||r&&oe(t.model,o)||s++;else if(0===s){if(1===i)return o;i--}else s--;o.forward()}},t.findOpening=function(t,e,n,i){var r,o=t.position.get(e);if(o.char!==n[1]||(r=!oe(t.model,o),o.backward())){var s=0;do{var a=o.char;if(a!==n[0]||r&&oe(t.model,o))a!==n[1]||r&&oe(t.model,o)||s++;else if(0===s){if(1===i)return o;i--}else s--}while(o.backward())}},t.findOuterPair=function(e,n,i,r){var o=t.findOpening(e,n,i,r);if(!o)return null;var s=t.findClosing(e,n,i,r);return o&&s?{from:o,to:s}:null},t.findInnerPair=function(e,n,i,r){var o=this.findOuterPair(e,n,i,r);return o?t.getInnerPariRange(e,o.from,o.to):null},t.getInnerPariRange=function(t,e,n){if(e.forward(),!i.Position.isBefore(e,n))return null;var r=!1;4===e.kind&&e.lineNumber+1<n.lineNumber&&(e.clone().setColumn("^").column===n.column&&(e=t.position.get(e.lineNumber+1,1),n=t.position.get(n.lineNumber-1,"$"),r=!0));return r||n.backward(),{from:e,to:n,linewise:r}},t}();function ae(t,e,n,i,r){if(X.whichWrap.indexOf(r)<0)return 1===e.column?null:t.position.get(e.lineNumber,e.column-n);if(1===e.lineNumber&&1===e.column)return null;for(var o=t.position.get(e);n>0&&o.backward();)"Move"===i&&o.soft(),n--;return o}function ue(t,e,n,i,r){var o=t.position.get(e);if(X.whichWrap.indexOf(r)<0){if("Move"===i){if(o.isLineLastChar)return null}else if("Select"===i&&4===o.kind)return null;return t.position.get(o.lineNumber,o.column+n)}if(o.isEOF||"Move"===i&&o.isFileLastChar)return null;for(;n>0&&o.forward();)"Move"===i&&4===o.kind&&o.forward(),n--;return o}var ce={left:{run:function(t,e,n,i){return ae(t,e,n,i,"h")}},right:{run:function(t,e,n,i){return ue(t,e,n,i,"l")}},EOL:{inclusive:!0,desiredColumnAtEol:!0,run:function(t,e,n,i){return t.position.get(e.lineNumber+n-1,"$")}},word:{run:function(t,e,n,i){return re.findNextWordStart(t.editor,e,n,!1,!1,"Operator"===i)}},fullWord:{run:function(t,e,n,i){return re.findNextWordStart(t.editor,e,n,!0,!1,"Operator"===i)}},altWord:{run:function(t,e,n){return re.findNextWordStart(t.editor,e,n,!1,!0)}},altFullWord:{run:function(t,e,n){return re.findNextWordStart(t.editor,e,n,!0,!0)}}};ht("h",ce.left),ht("<Left>",function(t,e,n,i){return ae(t,e,n,i,"<")}),ht("<BS>",function(t,e,n,i){return ae(t,e,n,i,"b")}),ht("l",ce.right),ht("<Right>",function(t,e,n,i){return ue(t,e,n,i,">")}),ht("<Space>",function(t,e,n,i){return ue(t,e,n,i,"s")});var le,he=function(t,e,n){return{lineNumber:e.lineNumber,column:1}};function fe(t){return"f"===t||"t"===t}function de(t){return{f:"F",F:"f",t:"T",T:"t"}[t]}ht("<Home>",he),ht("0",he,"no"),ht("^",function(t,e,n){return t.position.get(e.lineNumber,"^")}),ht("$, <End>",ce.EOL),ht("g_",{inclusive:!0,run:function(t,e,n){return t.position.get(e.lineNumber+n-1,"g_")}}),ht("k, <Up>",{keepPrevDesiredColumn:!0,linewise:!0,run:function(t,e,n,i){return 1===e.lineNumber?null:t.position.get(e.lineNumber-n,t.vimState.desiredColumn)}}),ht("j, <Down>",{keepPrevDesiredColumn:!0,linewise:!0,run:function(t,e,n,i){return e.lineNumber===t.model.getLineCount()?null:t.position.get(e.lineNumber+n,t.vimState.desiredColumn)}}),ht("gk, g<Up>",function(t,e,n){return t.editor.trigger("vim","cursorMove",{to:"up",select:!1,by:"wrappedLine",value:n}),t.editor.getPosition()}),ht("gj, g<Down>",function(t,e,n){return t.editor.trigger("vim","cursorMove",{to:"down",select:!1,by:"wrappedLine",value:n}),t.editor.getPosition()}),ht("-",{linewise:!0,run:function(t,e,n,i){return t.position.get(e.lineNumber-n,"^")}}),ht("+, <CR>, <C-M>",{linewise:!0,run:function(t,e,n,i){return t.position.get(e.lineNumber+n,"^")}}),ht("_",{linewise:!0,run:function(t,e,n,i){return t.position.get(e.lineNumber+n-1,"^")}}),ht("G",{linewise:!0,isJump:!0,run:function(t,e,n,i,r){return t.position.get(r?"$":n,"^")}}),ht("<C-End>",{inclusive:!0,isJump:!0,run:function(t,e,n,i,r){return t.position.get(r?"$":n,"$")}}),ht("gg, <C-Home>",{linewise:!0,isJump:!0,run:function(t,e,n,i,r){return t.position.get(r?1:n,"^")}}),ht("%",{linewise:!0,isJump:!0,run:function(t,e,n){var i=t.model.getLineCount(),r=Math.floor((n*i+99)/100);return t.position.get(r,"^")}},"required"),ht("w",ce.word),ht("W",ce.fullWord),ht("e",{inclusive:!0,run:function(t,e,n){return re.findNextWordEnd(t.editor,e,n)}}),ht("E",{inclusive:!0,run:function(t,e,n){return re.findNextWordEnd(t.editor,e,n,!0)}}),ht("b",function(t,e,n){return re.findPrevWordStart(t.editor,e,n)}),ht("B",function(t,e,n){return re.findPrevWordStart(t.editor,e,n,!0)}),ht("ge",{inclusive:!0,run:function(t,e,n){return re.findPrevWordEnd(t.editor,e,n)}}),ht("gE",{inclusive:!0,run:function(t,e,n){return re.findPrevWordEnd(t.editor,e,n,!0)}}),ht("%",{inclusive:!0,isJump:!0,run:function(t,e){var n,i=t.position.get(e),r=i.char;return[["(",")"],["[","]"],["{","}"]].forEach(function(e){r===e[0]?n=se.findClosing(t,i,e,1):r===e[1]&&(n=se.findOpening(t,i,e,1))}),n}},"no"),ht("[(",function(t,e,n,i){return se.findOpening(t,e,["(",")"],n)}),ht("[{",function(t,e,n,i){return se.findOpening(t,e,["{","}"],n)}),ht("])",function(t,e,n,i){return se.findClosing(t,e,["(",")"],n)}),ht("]}",function(t,e,n,i){return se.findClosing(t,e,["{","}"],n)}),ht("H",{linewise:!0,isJump:!0,run:function(t,e,n,i){var r,o=t.editor.getVisibleRanges()[0];r=1===o.startColumn?o.startLineNumber:o.startLineNumber!==o.endLineNumber?o.startLineNumber+1:o.startLineNumber;var s=Math.min(o.endLineNumber,r+n-1);return t.position.get(s,"^")}}),ht("M",{linewise:!0,isJump:!0,run:function(t,e,n,i){var r=t.editor.getVisibleRanges()[0],o=r.startLineNumber,s=r.endLineNumber,a=o+Math.floor((s-o)/2);return t.position.get(a,"^")}}),ht("L",{linewise:!0,isJump:!0,run:function(t,e,n,i){var r,o=t.editor.getVisibleRanges()[0];r=1===o.startColumn?o.startLineNumber:o.startLineNumber!==o.endLineNumber?o.startLineNumber+1:o.startLineNumber;var s=Math.max(o.endLineNumber-n+1,r);return t.position.get(s,"^")}});var pe={f:function(t,e,n,i){var r=e.lineNumber,o=(e.column,t.model.getLineContent(r));if(e.column>=o.length)return null;for(var s=e.column-1;n&&-1!==s;)s=o.indexOf(i,s+1),n--;return-1===s?null:{lineNumber:r,column:s+1}},F:function(t,e,n,i){var r=e.lineNumber,o=(e.column,t.model.getLineContent(r));if(1===e.column)return null;for(var s=e.column-1;n&&-1!==s;)s=0===s?-1:o.lastIndexOf(i,s-1),n--;return-1===s?null:{lineNumber:r,column:s+1}},t:function(t,e,n,i,r){var o=e.lineNumber,s=e.column,a=t.model.getLineContent(o);if(s>=a.length)return null;var u=e.column-1;for(!0===r&&1===n&&a[u+1]===i&&u++;n&&-1!==u;)u=a.indexOf(i,u+1),n--;return-1===u?null:{lineNumber:o,column:s=u+1-1}},T:function(t,e,n,i,r){var o=e.lineNumber,s=(e.column,t.model.getLineContent(o)),a=e.column-1;for(!0===r&&1===n&&s[a-1]===i&&a--;n&&-1!==a;)a=0===a?-1:s.lastIndexOf(i,a-1),n--;return-1===a?null:{lineNumber:o,column:a+1+1}}};ht(["f",{kind:"Char"}],{inclusive:!0,run:function(t,e,n,i,r,o){if(!o.char)throw new Error;return le={kind:"f",char:o.char},pe.f(t,e,n,o.char)}}),ht(["F",{kind:"Char"}],{run:function(t,e,n,i,r,o){if(!o.char)throw new Error;return le={kind:"F",char:o.char},pe.F(t,e,n,o.char)}}),ht(["t",{kind:"Char"}],{inclusive:!0,run:function(t,e,n,i,r,o){if(!o.char)throw new Error;return le={kind:"t",char:o.char},pe.t(t,e,n,o.char)}}),ht(["T",{kind:"Char"}],{run:function(t,e,n,i,r,o){if(!o.char)throw new Error;return le={kind:"T",char:o.char},pe.T(t,e,n,o.char)}}),ht(";",{get inclusive(){if(le)return fe(le.kind)},run:function(t,e,n,i){return le?pe[le.kind](t,e,n,le.char,!0):null}}),ht(",",{get inclusive(){if(le)return fe(de(le.kind))},run:function(t,e,n,i){return le?pe[de(le.kind)](t,e,n,le.char,!0):null}}),dt("aw",{inclusive:!0,run:function(t,e,n){return re.findOuterWord(t.editor,e,n)}}),dt("aW",{inclusive:!0,run:function(t,e,n){return re.findOuterWord(t.editor,e,n,!0)}}),dt("iw",{inclusive:!0,run:function(t,e,n){return re.findInnerWord(t.editor,e,n)}}),dt("iW",{inclusive:!0,run:function(t,e,n){return re.findInnerWord(t.editor,e,n,!0)}}),dt("a'",{inclusive:!0,run:function(t,e){return re.findOuterQuote(t.editor,e,"'")}}),dt('a"',{inclusive:!0,run:function(t,e){return re.findOuterQuote(t.editor,e,'"')}}),dt("a`",{inclusive:!0,run:function(t,e){return re.findOuterQuote(t.editor,e,"`")}}),dt("i'",{inclusive:!0,run:function(t,e){return re.findInnerQuote(t.editor,e,"'")}}),dt('i"',{inclusive:!0,run:function(t,e){return re.findInnerQuote(t.editor,e,'"')}}),dt("i`",{inclusive:!0,run:function(t,e){return re.findInnerQuote(t.editor,e,"`")}}),dt("a(, a), ab",{inclusive:!0,run:function(t,e,n){return se.findOuterPair(t,e,["(",")"],n)}}),dt("i(, i), ib",{inclusive:!0,run:function(t,e,n){return se.findInnerPair(t,e,["(",")"],n)}}),dt("a{, a}, aB",{inclusive:!0,run:function(t,e,n){return se.findOuterPair(t,e,["{","}"],n)}}),dt("i{, i}, iB",{inclusive:!0,run:function(t,e,n){return se.findInnerPair(t,e,["{","}"],n)}}),dt("a[, a]",{inclusive:!0,run:function(t,e,n){return se.findOuterPair(t,e,["[","]"],n)}}),dt("i[, i]",{inclusive:!0,run:function(t,e,n){return se.findInnerPair(t,e,["[","]"],n)}}),dt("a<, a>",{inclusive:!0,run:function(t,e,n){return se.findOuterPair(t,e,["<",">"],n)}}),dt("i<, i>",{inclusive:!0,run:function(t,e,n){return se.findInnerPair(t,e,["<",">"],n)}});var ge=function(){function t(t,e){this.editor=t,this.position=e,this.historyPatches=new Map}return t.prototype.dispose=function(){},t.prototype.addHistoryPatch=function(t,e,n,i){var r={beforeVersionId:t,afterVersionId:e};n&&(r.beforeCursor=n),i&&(r.afterCursor=i),this.historyPatches.set(t,r),this.historyPatches.set(e,r)},t.prototype.undo=function(){var t=this,e=this.editor.getModel(),n=e.getAlternativeVersionId(),i=this.historyPatches.get(n);if(i&&i.afterVersionId==n){for(;n!==i.beforeVersionId;){this.editor.trigger("vim","undo",null);var r=e.getAlternativeVersionId();if(r===n)return r;n=r}return i.beforeCursor&&this.editor.setSelections(i.beforeCursor.map(function(e){return t.position.soften(e).toSelection()})),n}return this.editor.trigger("vim","undo",null),e.getAlternativeVersionId()},t.prototype.redo=function(){var t=this,e=this.editor.getModel(),n=e.getAlternativeVersionId(),i=this.historyPatches.get(n);if(i&&i.beforeVersionId==n){for(;n<i.afterVersionId;){this.editor.trigger("vim","redo",null);var r=e.getAlternativeVersionId();if(r===n)return r;n=r}return n===i.afterVersionId&&i.afterCursor&&this.editor.setSelections(i.afterCursor.map(function(e){return t.position.soften(e).toSelection()})),n}return this.editor.trigger("vim","redo",null),e.getAlternativeVersionId()},t}();function me(t,e,n,i,r){t.vimState.getContextData("history").addHistoryPatch(e,n,i,r)}St("history",function(t){return new ge(t.editor,t.commandContext.position)}),gt("u","n",function(t,e){for(var n=t.vimState.getContextData("history"),i=e.count||1,r=t.model.getAlternativeVersionId();0!==i;){var o=n.undo();if(r===o){t.vimState.beep();break}r=o,i--}var s=t.editor.getSelections();s&&t.editor.setSelections(s.map(function(e){return t.position.soften(e.getPosition()).toSelection()}))}),gt("<C-R>","n",function(t,e){for(var n=t.vimState.getContextData("history"),i=e.count||1,r=t.model.getAlternativeVersionId();0!==i;){var o=n.redo();if(r===o){t.vimState.beep();break}r=o,i--}});var ve=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),be=function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function s(t){try{u(i.next(t))}catch(t){o(t)}}function a(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,a)}u((i=i.apply(t,e||[])).next())})},ye=function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function Se(t,e){var n={lineNumber:e.first,column:1},r={lineNumber:e.last,column:t.model.getLineMaxColumn(e.last)};return i.Range.fromPositions(n,r)}function Ae(t,e){return 1===e.endColumn&&e.startLineNumber!==e.endLineNumber?{first:e.startLineNumber,last:e.endLineNumber-1}:{first:e.startLineNumber,last:e.endLineNumber}}function Ce(t,e){var n={lineNumber:e.first,column:1},r={lineNumber:e.last,column:t.model.getLineMaxColumn(e.last)};return i.Selection.fromPositions(n,r)}function xe(t,e,n){t.editor.pushUndoStop();var i=t.model.pushEditOperations(t.editor.getSelections()||[],e,n);i&&t.editor.setSelections(i),t.editor.pushUndoStop()}function ke(t,e,n){var i={shouldRecord:!1!==t.isEdit&&!1!==t.shouldRecord,run:function(e,r){if(!t.runWithLineRange)throw new Error;var o=e.editor.getSelections();if(o){var a=o.map(function(t){var n=t.getPosition().lineNumber;return{first:n,last:Math.min(e.model.getLineCount(),n+(r.count||1)-1)}});return a=s(a,t.mergeTouchedLineRanges),u(t.runWithLineRange(e,a,n,r),function(){t.isInserting&&!e.vimState.isRepeating&&e.vimState.toInsert({command:i,args:r},"none"),e.position.get().reveal()})}}};gt(e,"n",i)}function we(t,e){var n=!0===t.isInserting;gt(e,"L",{run:function(e,i){if(!t.runWithLineRange)throw new Error;var r=e.editor.getSelections();if(!r)throw new Error;var o=r.map(function(t){return{first:t.getStartPosition().lineNumber,last:t.getEndPosition().lineNumber}}),a=o[0].last-o[0].first+1;return u(t.runWithLineRange(e,o,3,i),function(){if(!n){Object.assign({},i);p.setLastAction({setCount:function(){},execute:function(e){var n=e.editor.getSelections();if(n){var r=n.map(function(t){var n=t.getPosition().lineNumber;return{first:n,last:Math.min(e.model.getLineCount(),n+a-1)}});return r=s(r,t.mergeTouchedLineRanges),t.runWithLineRange(e,r,3,i)}}})}e.position.get().reveal(),t.isInserting&&!e.vimState.isRepeating?e.vimState.toInsert({command:{run:function(e,n){var i=e.editor.getSelections();if(i){var r=i.map(function(t){var n=t.getPosition().lineNumber;return{first:n,last:Math.min(e.model.getLineCount(),n+a-1)}});return r=s(r,t.mergeTouchedLineRanges),t.runWithLineRange(e,r,3,n)}}},args:Object.assign({},i)},"none"):e.vimState.toNormal()})}})}function Pe(t,e,n){var r=e.motion;if(!r)throw new Error;var a=t.editor.getSelections();if(!a)throw new Error;var u=e.count;if(void 0!==e.linewise?e.linewise:!0===r.linewise){var c=[];return a.forEach(function(n){var o,s=n.getPosition(),a=r.run(t,s,u||1,"Operator",void 0===u,e);a&&(i.Position.isIPosition(a)?o=a:(s=a.from,o=a.to),c.push({first:s.lineNumber,last:o.lineNumber}))}),{kind:"Line",ranges:c=s(c,n)}}var l=0,h=[];if(a.forEach(function(n){var o,s=n.getPosition(),a=r.run(t,s,u||1,"Operator",void 0===u,e);if(a){i.Position.isIPosition(a)?o=a:(s=a.from,o=a.to,!0===a.linewise&&l++);var c=i.Position.isBeforeOrEqual(s,o),f=c?s:o,d=c?o:s;h.push(i.Range.fromPositions(f,r.inclusive?t.position.get(d).move(1):d))}}),l===h.length){var f=h.map(function(t){return{first:t.startLineNumber,last:t.endLineNumber}});return{kind:"Line",ranges:f=s(f,n)}}return h=o(h),{kind:"Char",vary:0!==l,ranges:h}}function Ne(t,e,n){var i={shouldRecord:!1!==t.isEdit&&!1!==t.shouldRecord,run:function(e,r){if(!t.runWithCharRange||!t.runWithLineRange)throw new Error;var o=Pe(e,{count:r.count,motion:n},!0===t.mergeTouchedLineRanges);return 0===o.ranges.length?(e.vimState.beep(),!1):u("Char"===o.kind?t.runWithCharRange(e,o.ranges,2,r):t.runWithLineRange(e,o.ranges,2,r),function(){t.isInserting&&!e.vimState.isRepeating&&e.vimState.toInsert({command:i,args:r},"none"),e.position.get().reveal()})}};gt(e,"n",i)}function Ee(t,e){if(e.ncmdCountChar&&function(t,e){var n=!1!==t.isEdit,r={shouldRecord:n&&!1!==t.shouldRecord,run:function(e,s){if(!t.runWithCharRange)throw new Error;var a=e.editor.getSelections();if(a){var c=a.map(function(t){var n=t.getPosition(),r=e.position.get(n).setColumn(n.column+(s.count||1));return i.Range.fromPositions(n,r)});return c=o(c),n&&e.editor.pushUndoStop(),u(t.runWithCharRange(e,c,0,s),function(){n&&e.editor.pushUndoStop(),t.isInserting&&!e.vimState.isRepeating&&e.vimState.toInsert({command:r,args:s},"none"),e.position.get().reveal()})}}};gt(e,"n",r)}(t,e.ncmdCountChar),e.ncmdCountLine&&ke(t,e.ncmdCountLine,0),e.ncmdCursor&&function(t,e){var n={shouldRecord:!1!==t.isEdit&&!1!==t.shouldRecord,run:function(e,i){if(!t.runWithCursor)throw new Error;var r=e.editor.getSelections();if(!r)throw new Error;var o=r.map(function(t){return t.getPosition()});return u(t.runWithCursor(e,o,i),function(){t.isInserting&&!e.vimState.isRepeating&&e.vimState.toInsert({command:n,args:i},"none"),e.position.get().reveal()})}};gt(e,"n",n)}(t,e.ncmdCursor),e.nkey&&function(t,e){var n={shouldRecord:!1!==t.isEdit&&!1!==t.shouldRecord,run:function(e,i){if(!t.runWithCharRange||!t.runWithLineRange)throw new Error;t.isInserting&&(i.motion===ce.word?i.motion=ce.altWord:i.motion===ce.fullWord&&(i.motion=ce.altFullWord));var r=Pe(e,i,!0===t.mergeTouchedLineRanges);return 0===r.ranges.length?(e.vimState.beep(),!1):u("Char"===r.kind?t.runWithCharRange(e,r.ranges,2,i):t.runWithLineRange(e,r.ranges,2,i),function(){t.isInserting&&!e.vimState.isRepeating&&e.vimState.toInsert({command:n,args:i},"none"),e.position.get().reveal()})}};gt([e,{kind:"OperatorMotionHolder"}],"n",n)}(t,e.nkey),e.nkey&&e.nline){var n=!0===e.nline?e.nkey:e.nline;ke(t,[e.nkey,l.countPart,n],1)}if(e.nsynonym)for(var r in e.nsynonym)Ne(t,r,e.nsynonym[r]);e.vkey&&(!function(t,e){var n=!0===t.isInserting;gt(e,"V",{run:function(e,r){if(!t.runWithCharRange)throw new Error;var s=e.editor.getSelections();if(!s)throw new Error;var a=s.map(function(t){if(t.isEmpty()){var n=t.getPosition(),r=e.position.get(n).move(1);return i.Range.fromPositions(n,r)}return t}),c=Math.max(1,e.model.getValueLengthInRange(a[0]));return u(t.runWithCharRange(e,a,3,r),function(){n||(Object.assign({},r),p.setLastAction({setCount:function(){},execute:function(e){var n=e.editor.getSelections();if(n){var s=n.map(function(t){var n=t.getPosition(),r=e.position.get(n).move(c);return i.Range.fromPositions(n,r)});return s=o(s),t.runWithCharRange(e,s,3,r)}}})),e.position.get().reveal(),t.isInserting&&!e.vimState.isRepeating?e.vimState.toInsert({command:{run:function(e,n){var r=e.editor.getSelections();if(r){var s=r.map(function(t){var n=t.getPosition(),r=e.position.get(n).move(c);return i.Range.fromPositions(n,r)});return s=o(s),t.runWithCharRange(e,s,3,n)}}},args:Object.assign({},r)},"none"):e.vimState.toNormal()})}})}(t,e.vkey),we(t,e.vkey)),e.vline&&we(t,e.vline)}var Le=function(){function t(){}return t.prototype.runWithCharRange=function(t,e,n){var r=this,o=e.filter(function(t){return!i.Range.isEmpty(t)}).map(function(e){return{range:i.Range.lift(e),text:r.transform(t.model.getValueInRange(e))}});if(o.length){var s=e.map(function(e){return t.position.get(e.startLineNumber,e.startColumn).soft().toSelection()});xe(t,o,function(){return s})}},t.prototype.runWithLineRange=function(t,e){var n=this,i=e.map(function(e){var i=Se(t,e);return{range:i,text:n.transform(t.model.getValueInRange(i))}});if(i.length){var r=e.map(function(e){return t.position.get(e.first,"^").toSelection()});xe(t,i,function(){return r})}},t}();Ee(new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ve(e,t),e.prototype.transform=function(t){return t.toLowerCase()},e}(Le)),{nkey:"gu",nline:"gu, u",vkey:"gu, u"}),Ee(new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ve(e,t),e.prototype.transform=function(t){return t.toUpperCase()},e}(Le)),{nkey:"gU",nline:"gU, U",vkey:"gU, U"}),Ee(new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ve(e,t),e.prototype.runWithCursor=function(t,e,n){var r=this,s=n.count||1,a=X.whichWrap.indexOf("~")<0,u=e.map(function(e){var n=t.position.get(e);if(a)n.shouldWrap(!1).move(s);else for(var r=s;r>0&&n.forward();)4===n.kind&&n.forward(),r--;return i.Range.fromPositions(e,n)}),c=(u=o(u)).filter(function(t){return!i.Range.isEmpty(t)}).map(function(e){return{range:e,text:r.transform(t.model.getValueInRange(e))}});if(c.length){var l=u.map(function(e){return t.position.get(e.endLineNumber,e.endColumn).soft().toSelection()});xe(t,c,function(){return l})}},e.prototype.transform=function(t){for(var e="",n=t,i=0;i<n.length;i++){var r=n[i],o=r.toLowerCase();o===r&&(o=r.toUpperCase()),e+=o}return e},e}(Le)),{ncmdCursor:"~",nkey:"g~",nline:"g~, ~",vkey:"g~, ~"});var Ie=function(){function t(t){this.action=t}return t.prototype.runWithLineRange=function(t,e,n,i){var r=t.model.getAlternativeVersionId(),o=t.editor.getSelections().map(function(t){return t.getPosition()}),s=e.map(function(e){return Ce(t,e)});t.editor.setSelections(s);var a=1;for(3===n&&(a=i.count||1);0!==a;)t.editor.trigger("vim",this.action,null),a--;var u=t.model.getAlternativeVersionId(),c=e.map(function(e){return t.position.get(e.first,"^").toSelection()});t.editor.setSelections(c),me(t,r,u,o,c.map(function(t){return t.getPosition()}))},t.prototype.runWithCharRange=function(t,e,n,i){var r=e.map(function(t){return Ae(0,t)});r=s(r),this.runWithLineRange(t,r,n,i)},t}();Ee(new Ie("editor.action.indentLines"),{nkey:">",vkey:">",nline:!0}),Ee(new Ie("editor.action.outdentLines"),{nkey:"<",vkey:"<",nline:!0}),Ee(new(function(){function t(){}return t.prototype.runWithLineRange=function(t,e){return be(this,void 0,void 0,function(){var n,i,r,o,s,a,u,c,l;return ye(this,function(h){switch(h.label){case 0:if(n=t.model.getAlternativeVersionId(),i=t.editor.getSelections().map(function(t){return t.getPosition()}),!(r=t.editor.getAction("editor.action.formatSelection")))throw new Error;o=0,s=e,h.label=1;case 1:return o<s.length?(a=s[o],u=Ce(t,a),t.editor.setSelection(u),[4,r.run()]):[3,4];case 2:h.sent(),h.label=3;case 3:return o++,[3,1];case 4:return c=t.model.getAlternativeVersionId(),l=e.map(function(e){return t.position.get(e.first,"^").toSelection()}),t.editor.setSelections(l),me(t,n,c,i,l.map(function(t){return t.getPosition()})),[2]}})})},t.prototype.runWithCharRange=function(t,e){var n=e.map(function(t){return Ae(0,t)});return n=s(n),this.runWithLineRange(t,n)},t}()),{nkey:"=",vkey:"=",nline:!0});var Re=function(){function t(){}return t.prototype.runWithLineRange=function(t,e){var n=t.model.getLineCount();if(0!==(e=e.filter(function(t){return t.first!==n}).map(function(t){return t.first===t.last?{first:t.first,last:t.first+1}:t})).length){var i=(e=s(e))[0];e=e.sort(function(t,e){return t.first-e.first}),this.run(t,e,e.indexOf(i))}else t.vimState.beep()},t.prototype.runWithCharRange=function(t,e){var n=e.map(function(t){return Ae(0,t)});n=s(n),this.runWithLineRange(t,n)},t}();Ee(new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ve(e,t),e.prototype.run=function(t,e,n){var r=[],o=[],s=0;e.forEach(function(e,a){for(var u=0,c=e.first;c<e.last;c++){var l=t.position.get(c,"eol");u+=t.model.getLineLength(c);var h=i.Range.fromPositions(l,{lineNumber:c+1,column:1});r.push({range:h,text:null})}var f=e.first-s,d=0===t.model.getLineLength(e.last)?u:u+1,p=i.Selection.fromPositions({lineNumber:f,column:d});a===n?o.unshift(p):o.push(p),s+=e.last-e.first}),xe(t,r,function(){return o})},e}(Re)),{ncmdCountLine:"gJ",vkey:"gJ"}),Ee(new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ve(e,t),e.prototype.run=function(t,e,n){var r=[],o=[],s=0;e.forEach(function(e,a){var u=e.first,c=t.model.getLineLength(u),l=1,h=t.position.get(u,"$").isBlank;for(u+=1;u<=e.last;u++){var f=t.position.get(u,1).shouldWrap(!1);0===f.kind&&f.stepTo(function(t){return 0!==t.kind});var d=i.Range.fromPositions(t.position.get(u-1,"eol"),f),p=f.lineLength-(f.column-1),g=h?"":" ";0===p?h=!0:(")"===f.char&&(g=""),h=f.setColumn("$").isBlank),l=c+(0===p?0:1),c+=p+g.length,r.push({range:d,text:g})}var m=e.first-s,v=i.Selection.fromPositions({lineNumber:m,column:l});a===n?o.unshift(v):o.push(v),s+=e.last-e.first}),xe(t,r,function(){return o})},e}(Re)),{ncmdCountLine:"J",vkey:"J"});var Me=function(){function t(t){this.model=t,this.points=[]}return t.prototype.setRelative=function(t,e){var n=this.model.getOffsetAt(t);this.points.push({offset:n,relative:e,delta:0})},t.prototype.applyEdits=function(t){var e=this;t.forEach(function(t){var n=e.model.getOffsetAt(t.range.getStartPosition()),i=(t.text?t.text.length:0)-e.model.getValueLengthInRange(t.range);e.points.forEach(function(t){t.offset>n&&(t.delta+=i)})}),this.points.forEach(function(t){return t.result=t.offset+t.delta+t.relative})},t.prototype.resolve=function(){var t=this;return this.resolved||(this.resolved=this.points.map(function(e){return i.Selection.fromPositions(t.model.getPositionAt(e.result))})),this.resolved},t}(),Oe=function(){function t(t,e){this.type=t,this.sequence=e}return t.prototype.runWithCursor=function(t,e,n){var r=this,o=n.count||1;"subtract"===this.type&&(o=-o);var s=[],a=new Me(t.model);e.map(function(e){var n=t.position.get(e).shouldWrap(!1);if(r.isDigit(n.char)){var u=!1;n.backIf(function(t){return!u&&(r.isDigit(t.char)||"-"===t.char&&(u=!0))})}var c=r.findNumberRange(t,i.Range.fromPositions(n,n.clone().setColumn("eol")));if(c){var l=c.range,h=c.value,f=c.length,d=r.numberToText(h+o,f);s.push({range:l,text:d}),a.setRelative(l.getStartPosition(),d.length-1)}else a.setRelative(e,0)}),s.length>0?(a.applyEdits(s),xe(t,s,function(){return a.resolve()})):t.vimState.beep()},t.prototype.runWithLineRange=function(t,e,n,i){var r=e.map(function(e){return Se(t,e)});this.runWithCharRange(t,r,n,i)},t.prototype.runWithCharRange=function(t,e,n,r){var o=this;if(3!==n)throw new Error;var s=r.count||1;"subtract"===this.type&&(s=-s);var u=[],c=e.map(function(t){return i.Selection.fromPositions({lineNumber:t.startLineNumber,column:t.startColumn})});e.forEach(function(e){var n=1;a(t.model,e).forEach(function(e){var i=o.findNumberRange(t,e);if(i){var r=i.range,a=i.value,c=i.length,l=a+(o.sequence?n++:1)*s,h=o.numberToText(l,c);u.push({range:r,text:h})}})}),u.length>0?xe(t,u,function(){return c}):t.vimState.beep()},t.prototype.isDigit=function(t){var e=t.charCodeAt(0);return e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)},t.prototype.findNumberRange=function(t,e){var n=t.model.getValueInRange(e).match(/-?\d+/);if(n){var r=n[0],o=e.startLineNumber,s=e.startColumn+n.index,a=new i.Range(o,s,o,s+r.length),u=parseInt(r);return{range:a,value:u,text:r,length:r.length-(u<0?1:0)}}},t.prototype.numberToText=function(t,e){if(t>=0){for(var n=e-(i=t.toString()).length;n>0;)i="0"+i,n--;return i}var i;for(n=e-(i=Math.abs(t).toString()).length;n>0;)i="0"+i,n--;return"-"+i},t}();Ee(new Oe("add",!1),{ncmdCursor:"<C-A>",vkey:"<C-A>"}),Ee(new Oe("subtract",!1),{ncmdCursor:"<C-X>",vkey:"<C-X>"}),Ee(new Oe("add",!0),{vkey:"g<C-A>"}),Ee(new Oe("subtract",!0),{vkey:"g<C-X>"});var _e=function(){function t(){this.mergeTouchedLineRanges=!0}return t.prototype.runWithLineRange=function(t,e,n,r){if(0!==t.model.getValueLength()){var o=t.model.getLineCount();if(1!==e.length||1!==e[0].first||e[0].last!==o){var s=e[0],a=(e=e.sort(function(t,e){return t.first-e.first})).indexOf(s),u=[],c=[],l=0,h=[];e.map(function(e,n){var r,s=i.Range.fromPositions({lineNumber:e.first,column:1},t.position.get(e.last,"eol"));if(h.push(t.model.getValueInRange(s)),1===e.first&&e.last===o)throw new Error;r=e.last!==o?new i.Range(e.first,1,e.last+1,1):i.Range.fromPositions(t.position.get(e.first-1,"eol"),t.position.get(e.last,"eol")),u.push({range:r,text:null});var f=t.position.get(e.last===o?e.first-1:e.last+1,"^").column,d=(e.last===o?e.first-1:e.first)-l,p=i.Selection.fromPositions({lineNumber:d,column:f});n===a?c.unshift(p):c.push(p),l+=e.last-e.first+1}),tt.storeText(h,!0,r.register||"delete"),xe(t,u,function(){return c})}else{tt.storeText(t.model.getValue(),!0,r.register||"delete");var f=[new i.Selection(1,1,1,1)];xe(t,[{range:t.model.getFullModelRange(),text:null}],function(){return f})}}},t.prototype.runWithCharRange=function(t,e,n,r){var o=[],s=new Me(t.model),a=[];e.forEach(function(e){var n=i.Range.lift(e);a.push(t.model.getValueInRange(n)),o.push({range:n,text:null});var r=1!==n.startColumn&&4===t.position.get(n.getEndPosition()).kind?-1:0;s.setRelative(n.getStartPosition(),r)}),tt.storeText(a,!1,r.register||"delete"),s.applyEdits(o),xe(t,o,function(){return s.resolve()})},t}();Ee(new _e,{nkey:"d",nline:!0,vkey:"d, x, <Del>, <BS>",vline:"X, D",nsynonym:{"x, <Del>":ce.right,X:ce.left,D:ce.EOL}}),Gt({matcher:/^d(?:e|el|ele|elet|elete)?(?:\s+([^\d]))?(?:\s*(\d+))?\s*$/,handler:function(t,e,n){var i=void 0,r=void 0;!n[1]||(i=tt.convertToId(n[1].charCodeAt(0)))?n[2]&&(r=parseInt(n[2]))<1?t.vimState.outputError("Positive count required"):(r&&(e={first:e.last,last:e.last+r-1}),t.editor.pushUndoStop(),(new _e).runWithLineRange(t,[e],1,{register:i}),t.editor.pushUndoStop(),t.editor.revealPosition(t.position.get()),t.vimState.toNormal()):t.vimState.outputError("Invalid register")}}),Ee(new(function(){function t(){this.isEdit=!1}return t.prototype.runWithLineRange=function(t,e,n,r){var o=(e=e.sort(function(t,e){return t.first-e.first})).map(function(e){return t.model.getValueInRange(Se(t,e))});if(tt.storeText(o,!0,r.register||"yank"),3===n){var s=e.map(function(t){return i.Selection.fromPositions({lineNumber:t.first,column:1})});t.editor.setSelections(s)}},t.prototype.runWithCharRange=function(t,e,n,r){var o=(e=e.sort(function(t,e){return i.Range.compareRangesUsingStarts(t,e)})).map(function(e){return t.model.getValueInRange(e)});if(tt.storeText(o,!1,r.register||"yank"),3===n){var s=e.map(function(t){return i.Selection.fromPositions({lineNumber:t.startLineNumber,column:t.startColumn})});t.editor.setSelections(s)}},t}()),{nkey:"y",nline:!0,ncmdCountLine:"Y",vkey:"y",vline:"Y"});var We=function(){function t(t){this.cursorAtNext=t}return t.prototype.getRegisterItem=function(t,e){var n=tt.getText(e.register);if(!n){var i=tt.idToString(e.register);"_"!==i&&t.vimState.outputError("Nothing in register "+i)}return n},t.prototype.runWithCursor=function(t,e,n){var r=this,o=this.getRegisterItem(t,n);if(o){var s,a=e[0],u=(e=e.sort(function(t,e){return i.Position.compare(t,e)})).indexOf(a),c=[],l=function(t){var e=t.match(/\n/g);return e?e.length+1:1};if(e.length>1&&e.length===o.texts.length){var h=o.repeatTextRespectively(n.count||1);s=function(t){return[h[t],l(h[t])]}}else{var f=o.getJoinedText(n.count||1),d=l(f);s=function(){return[f,d]}}if(o.linewise){var p=[],g=0;e.map(function(e,n){var o=t.position.get(e.lineNumber,"eol"),a=i.Range.fromPositions(o,o),l=s(n),h=l[0],f=l[1],d="\n"+h;c.push({range:a,text:d});var m=e.lineNumber+(r.cursorAtNext?f+1:1)+g;n===u?p.unshift(m):p.push(m),g+=f});var m=null;xe(t,c,function(){return m||(m=r.cursorAtNext?p.map(function(t){return i.Selection.fromPositions({lineNumber:t,column:1})}):p.map(function(e){return t.position.get(e,"^").toSelection()})),m})}else{var v=new Me(t.model);e.map(function(e,n){var o=t.position.get(e.lineNumber,e.column+1),a=i.Range.fromPositions(o,o),u=s(n),l=u[0],h=u[1];c.push({range:a,text:l});var f=r.cursorAtNext?l.length:h>1?0:l.length-1;v.setRelative(o,f)}),v.applyEdits(c),xe(t,c,function(){return v.resolve()})}}},t.prototype.storeLineTexts=function(t,e,n){var r=e.map(function(e){var n=i.Range.fromPositions({lineNumber:e.first,column:1},t.position.get(e.last,"eol"));return t.model.getValueInRange(n)});tt.storeText(r,!0,n.register||"delete")},t.prototype.runWithLineRange=function(t,e,n,r){var o=this,s=this.getRegisterItem(t,r);if(s){this.storeLineTexts(t,e,r);var a,u=e[0],c=(e=e.sort(function(t,e){return t.first-e.first})).indexOf(u),l=[],h=function(t){var e=t.match(/\n/g);return e?e.length+1:1};if(e.length>1&&e.length===s.texts.length){var f=s.repeatTextRespectively(r.count||1,!0);a=function(t){return[f[t],h(f[t])]}}else{var d=s.getJoinedText(r.count||1,!0),p=h(d);a=function(){return[d,p]}}var g=[],m=0;e.map(function(e,n){var i=Se(t,e),r=a(n),s=r[0],u=r[1];l.push({range:i,text:s});var h=e.first+(o.cursorAtNext?u:0)+m;n===c?g.unshift(h):g.push(h),m+=u-(e.last-e.first+1)});var v=null;xe(t,l,function(){return v||(v=o.cursorAtNext?g.map(function(t){return i.Selection.fromPositions({lineNumber:t,column:1})}):g.map(function(e){return t.position.get(e,"^").toSelection()})),v})}},t.prototype.storeCharTexts=function(t,e,n){var i=e.map(function(e){return t.model.getValueInRange(e)});tt.storeText(i,!1,n.register||"delete")},t.prototype.runWithCharRange=function(t,e,n,r){var o=this,s=this.getRegisterItem(t,r);if(s){this.storeCharTexts(t,e,r);var a,u=e[0],c=(e=e.sort(function(t,e){return i.Range.compareRangesUsingStarts(t,e)})).indexOf(u),l=[],h=function(t){var e=t.match(/\n/g);return e?e.length+1:1};if(e.length>1&&e.length===s.texts.length){var f=s.repeatTextRespectively(r.count||1);a=function(t){return[f[t],h(f[t])]}}else{var d=s.getJoinedText(r.count||1),p=h(d);a=function(){return[d,p]}}if(s.linewise){var g=[],m=0;e.map(function(t,e){var n=i.Range.lift(t),r=a(e),s=r[0],u=r[1],h="\n"+s+"\n";l.push({range:n,text:h});var f=t.startLineNumber+(o.cursorAtNext?u+1:1)+m;e===c?g.unshift(f):g.push(f),m+=u+1-(t.endLineNumber-t.startLineNumber)});var v=null;xe(t,l,function(){return v||(v=o.cursorAtNext?g.map(function(t){return i.Selection.fromPositions({lineNumber:t,column:1})}):g.map(function(e){return t.position.get(e,"^").toSelection()})),v})}else{var b=new Me(t.model);e.map(function(t,e){var n=i.Range.lift(t),r=a(e),s=r[0],u=r[1];l.push({range:n,text:s});var c=o.cursorAtNext?s.length:u>1?0:s.length-1;b.setRelative(n.getStartPosition(),c)}),b.applyEdits(l),xe(t,l,function(){return b.resolve()})}}},t}();Ee(new We(!1),{ncmdCursor:"p",vkey:"p"}),Ee(new We(!0),{ncmdCursor:"gp",vkey:"gp"});var Ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ve(e,t),e.prototype.runWithCursor=function(t,e,n){var r=this,o=this.getRegisterItem(t,n);if(o){var s,a=e[0],u=(e=e.sort(function(t,e){return i.Position.compare(t,e)})).indexOf(a),c=[],l=function(t){var e=t.match(/\n/g);return e?e.length+1:1};if(e.length>1&&e.length===o.texts.length){var h=o.repeatTextRespectively(n.count||1);s=function(t){return[h[t],l(h[t])]}}else{var f=o.getJoinedText(n.count||1),d=l(f);s=function(){return[f,d]}}if(o.linewise){var p=[],g=0;e.map(function(e,n){var o=t.position.get(e.lineNumber,1),a=i.Range.fromPositions(o,o),l=s(n),h=l[0],f=l[1],d=h+"\n";c.push({range:a,text:d});var m=e.lineNumber+(r.cursorAtNext?f:0)+g;n===u?p.unshift(m):p.push(m),g+=f});var m=null;xe(t,c,function(){return m||(m=r.cursorAtNext?p.map(function(t){return i.Selection.fromPositions({lineNumber:t,column:1})}):p.map(function(e){return t.position.get(e,"^").toSelection()})),m})}else{var v=new Me(t.model);e.map(function(t,e){var n=i.Range.fromPositions(t),o=s(e),a=o[0],u=o[1];c.push({range:n,text:a});var l=r.cursorAtNext?a.length:u>1?0:a.length-1;v.setRelative(t,l)}),v.applyEdits(c),xe(t,c,function(){return v.resolve()})}}},e}(We);Ee(new Ve(!1),{ncmdCursor:"P",vkey:"P"}),Ee(new Ve(!0),{ncmdCursor:"gP",vkey:"gP"}),Ee(new(function(){function t(){}return t.prototype.runWithCharRange=function(t,e,n,r){var o=r.char;if(!o)throw new Error;var s=[];e.forEach(function(e){a(t.model,e).forEach(function(t){var e=o.repeat(t.endColumn-t.startColumn);s.push({range:t,text:e})})});var u=e.map(function(t){return i.Selection.fromPositions({lineNumber:t.startLineNumber,column:0===n?t.endColumn-1:t.startColumn})});xe(t,s,function(){return u})},t.prototype.runWithLineRange=function(t,e,n,i){var r=e.map(function(e){return Se(t,e)});this.runWithCharRange(t,r,n,i)},t}()),{ncmdCountChar:["r",{kind:"Char"}],vkey:["r",{kind:"Char"}]}),Ee(new(function(){function t(){this.isInserting=!0}return t.prototype.runWithCharRange=function(t,e,n,r){var o=[],s=new Me(t.model),a=[];e.forEach(function(e){var n=i.Range.lift(e);a.push(t.model.getValueInRange(n)),o.push({range:n,text:null}),s.setRelative(n.getStartPosition(),0)}),tt.storeText(a,!1,r.register||"delete"),s.applyEdits(o),xe(t,o,function(){return s.resolve()})},t.prototype.runWithLineRange=function(t,e,n,r){var o=e[0],s=(e=e.sort(function(t,e){return t.first-e.first})).indexOf(o),a=[],u=[],c=0,l=[];e.map(function(e,n){var r=t.position.get(e.first,1),o=r.clone().shouldWrap(!1);0===o.kind&&o.stepTo(function(t){return 0!==t.kind});var h=t.position.get(e.last,"eol"),f=i.Range.fromPositions(r,h);l.push(t.model.getValueInRange(f)),f=i.Range.fromPositions(o,h),a.push({range:f,text:null});var d=i.Selection.fromPositions({lineNumber:e.first-c,column:o.column});n===s?u.unshift(d):u.push(d),c+=e.last-e.first}),tt.storeText(l,!0,r.register||"delete"),xe(t,a,function(){return u})},t}()),{nkey:"c",nline:!0,ncmdCountLine:"S",vkey:"c, s",vline:"C, S, R",nsynonym:{C:ce.EOL,s:ce.right}});var Te=function(){function t(t){0!==t.length&&(this.pieces=function(t){var e=[],n=0,i=0,r=t.length;for(;;){if(i===r){c(i);break}var o=t.charCodeAt(i++);if(i===r){c(i);break}if(o===De){var s=t.charCodeAt(i++);s===qe?l("\n"):s===He?l("\t"):s===De?l("\\"):s===Be&&l("/")}else if(o===je){var s=t.charCodeAt(i++);if(s===je)l("$");else if(s===Ke||s===Fe)h(0);else if(s>=Ue&&s<=Qe){var a=s-Fe;if(i!==r){var u=t.charCodeAt(i);u>=Fe&&u<=Qe&&(a=10*a+(u-Fe),i++)}h(a)}}}return e;function c(i){i>n&&e.push({kind:"text",text:t.substring(n,i)})}function l(t){c(i-2),e.push({kind:"text",text:t}),n=i}function h(t){c(i-(t<10?2:3)),e.push({kind:"submatch",index:t}),n=i}}(t))}return t.prototype.run=function(t){if(this.pieces){for(var e="",n=0,i=this.pieces;n<i.length;n++){var r=i[n];"text"===r.kind?e+=r.text:e+=this._substitute(r.index,t)}return e}return""},t.prototype._substitute=function(t,e){if(0===t)return e[0];for(var n="";t>0;){if(t<e.length)return(e[t]||"")+n;n=String(t%10)+n,t=Math.floor(t/10)}return"$"+n},t}(),De="\\".charCodeAt(0),Be="/".charCodeAt(0),je="$".charCodeAt(0),Ke="&".charCodeAt(0),Fe="0".charCodeAt(0),Ue="1".charCodeAt(0),Qe="9".charCodeAt(0),He="t".charCodeAt(0),qe="n".charCodeAt(0);var ze=null;function Ze(t,e,n,o,s,a){var u=new Te(o),c=!X.ignoreCase;n.startsWith("\\c")?(c=!1,n=n.substring(2)):n.startsWith("\\C")&&(c=!0,n=n.substring(2));for(var l,h=!1,f=0,d=s=s.replace(/^&+/,ze?ze.flags:"");f<d.length;f++){var p=d[f];"g"===p?h=!0:"I"===p?c=!0:"i"===p&&(c=!1)}if(ze={searchString:n,replaceString:o,flags:s},a&&(e={first:e.last,last:e.last+a-1}),e.last=Math.min(e.last,t.model.getLineCount()),h){if(0===(m=t.model.findMatches(n,r(t,[e.first,e.last]),!0,c,null,!0)).length)return;l=m.map(function(t){return{range:t.range,text:u.run(t.matches)}})}else{l=[];for(var g=e.first;g<=e.last;g++){var m;if(0!==(m=t.model.findMatches(n,r(t,[g,g]),!0,c,null,!0,1)).length){var v=m[0];l.push({range:v.range,text:u.run(v.matches)})}}}0!==l.length?(t.editor.pushUndoStop(),function(t,e,n){var r;Array.isArray(e)||(e=[e]),t.model.pushEditOperations(t.editor.getSelections(),e,function(){var t=n();return r=[i.Selection.fromPositions(t,t)]}),t.editor.setSelections(r)}(t,l,function(){return t.position.get(e.last,"^")}),t.editor.pushUndoStop(),t.vimState.toNormal()):t.vimState.outputError("Pattern not found: "+n)}Gt({matcher:/^(?:s(?:u|ub|ubs|ubst|ubsti|ubstit|ubstitu|ubstitut|ubstitute)?\s+|&)(?:([&a-zA-Z]*))?(?:\s*(\d+))?\s*$/,handler:function(t,e,n){if(ze)return Ze(t,e,ze.searchString,ze.replaceString,n[1]||"",n[2]?parseInt(n[2]):void 0);t.vimState.outputError("No previous substitute regular expression")}}),Gt({matcher:/^s(?:u|ub|ubs|ubst|ubsti|ubstit|ubstitu|ubstitut|ubstitute)?\/([^\/\\]*(?:\\.[^\\\/]*)*)\/([^\/\\]*(?:\\.[^\\\/]*)*)(?:\/([a-zA-Z]*))?(?:\s*(\d+))?\s*$/,handler:function(t,e,n){return Ze(t,e,n[1],n[2],n[3]||"",n[4]?parseInt(n[4]):void 0)}}),gt("&","n",function(t,e){if(ze){var n=ze.searchString,i=ze.replaceString,r=e.count||1,o=t.editor.getPosition().lineNumber;return Ze(t,{first:o,last:o},n,i,"",r)}t.vimState.outputError("No previous substitute regular expression")});var Ge=new Map,Je=!1,Ye=!1;var Xe=function(){function t(t){var e=this;this.editor=t,this.decorations=[],this.editorId=this.editor.getId(),this.versionId=this.model.getVersionId(),this.editor.onDidDispose(function(){Ge.delete(e.editorId)}),this.editor.onDidChangeModelContent(function(t){e.versionId=e.model.getVersionId(),e.matchRanges=void 0,e.pattern&&e.search(e.pattern)})}return Object.defineProperty(t.prototype,"model",{get:function(){var t=this.editor.getModel();if(!t)throw new Error("ICodeEditor.getModel() returns null.");return t},enumerable:!0,configurable:!0}),t.create=function(e){var n=e.getId(),i=Ge.get(n);return i||(i=new t(e),Ge.set(n,i)),i},t.prototype.getState=function(){return{versionId:this.versionId,matchRanges:this.matchRanges,pattern:this.pattern}},t.prototype.restoreState=function(t){this.versionId===t.versionId&&(this.matchRanges===t.matchRanges&&this.matchRanges===t.matchRanges||(this.matchRanges=t.matchRanges,this.pattern=t.pattern,this.updateHighlight()))},t.prototype.reset=function(){this.matchRanges=void 0,this.pattern=void 0,this.updateHighlight()},t.prototype.search=function(t){if(!this.matchRanges||!this.pattern||(n=this.pattern,i=t,n.searchString!==i.searchString||n.isRegex!==i.isRegex||n.matchCase!==i.matchCase||n.wholeWord!==i.wholeWord)){var e=this.model.findMatches(t.searchString,!1,t.isRegex,t.matchCase,t.wholeWord?this.editor.getConfiguration().wordSeparators:null,!1);this.matchRanges=e.map(function(t){return t.range}),this.pattern=t,this.updateHighlight()}var n,i;return this.matchRanges},t.prototype.updateHighlight=function(){if(Ye||X.highlightSearch&&!Je){if(this.matchRanges&&0!==this.matchRanges.length||0!==this.decorations.length){var t=this.matchRanges||[];this.decorations=this.editor.deltaDecorations(this.decorations,t.map(function(t){return{range:t,options:{stickiness:i.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,className:"findMatch"}}}))}}else this.clearHighLight()},t.prototype.clearHighLight=function(){0!==this.decorations.length&&(this.decorations=this.editor.deltaDecorations(this.decorations,[]))},t}(),$e=function(){function t(){}return Object.defineProperty(t,"isInc",{get:function(){return Ye},set:function(t){Ye!==t&&(Ye=t,Ge.forEach(function(t){return t.updateHighlight()}))},enumerable:!0,configurable:!0}),t.noHighLight=function(){Je=!0,Ge.forEach(function(t){return t.updateHighlight()})},t.trunOffNoHightLight=function(){Je=!1,Ge.forEach(function(t){return t.updateHighlight()})},t.getSearchModel=function(t){return Xe.create(t)},t.search=function(t,e,n,i,r,o){return void 0===r&&(r=1),void 0===o&&(o=!0),"forward"===i?this.searchNext(t,e,n,r,o):this.searchPrev(t,e,n,r,o)},t.containsPosition=function(t,e){return!(e.lineNumber<t.startLineNumber||e.lineNumber>t.endLineNumber)&&(!(e.lineNumber===t.startLineNumber&&e.column<t.startColumn)&&!(e.lineNumber===t.endLineNumber&&e.column>=t.endColumn))},t.isAtMatch=function(e,n,i){for(var r=0,o=Xe.create(e.editor).search(i);r<o.length;r++){var s=o[r];if(t.containsPosition(s,n))return s}return null},t.searchNext=function(e,n,i,r,o){void 0===r&&(r=1),void 0===o&&(o=!0),o&&t.trunOffNoHightLight();var s=Xe.create(e.editor).search(i);if(0===s.length)return null;for(var a=null;r>0;){for(var u=!1,c=0,l=s;c<l.length;c++){var h=l[c];if(h.startLineNumber>n.lineNumber||h.startLineNumber===n.lineNumber&&h.startColumn>n.column){u=!0,n=h.getStartPosition(),a=h;break}}u||(n=s[0].getStartPosition(),a=s[0]),r--}return a},t.searchPrev=function(e,n,i,r,o){void 0===r&&(r=1),void 0===o&&(o=!0),o&&t.trunOffNoHightLight();var s=Xe.create(e.editor).search(i);if(0===s.length)return null;for(var a=null;r>0;){for(var u=!1,c=s.length-1;c>=0;c--){var l=s[c];if(l.startLineNumber<n.lineNumber||l.startLineNumber===n.lineNumber&&l.endColumn<=n.column){u=!0,n=l.getStartPosition(),a=l;break}}u||(n=s[s.length-1].getStartPosition(),a=s[s.length-1]),r--}return a},t.notifyHighlightSearchOptionChanged=function(){X.highlightSearch?Ge.forEach(function(t){return t.updateHighlight()}):Ge.forEach(function(t){return t.clearHighLight()})},t}();X.onOptionChanged("highlightSearch",function(){return $e.notifyHighlightSearchOptionChanged()});var tn,en=void 0;function nn(t,e,n,r){var o=t.editor.getScrollLeft(),s=t.editor.getScrollTop(),a=!1,u=$e.getSearchModel(t.editor),c=u.getState();function l(e){void 0===e&&(e=!1),a&&(t.editor.setScrollLeft(o),t.editor.setScrollTop(s),a=!1),e&&u.restoreState(c)}t.vimState.requestExternalInput(r,"",function(n){if($e.isInc=!0,X.incrementalSearch){0===n.length&&(l(),u.reset());var r=function(n){var i=!X.ignoreCase;if(n.startsWith("\\c"))i=!1,n=n.substring(2);else if(n.startsWith("\\C"))i=!0,n=n.substring(2);else if(X.ignoreCase&&X.smartCase)for(var r=0;r<n.length;r++){var o=n.charCodeAt(r);if(o==="\\".charCodeAt(0))r++;else if(o>="A".charCodeAt(0)&&o<="Z".charCodeAt(0)){i=!0;break}}if(0===n.length)return null;var s={searchString:n,wholeWord:!1,isRegex:!0,matchCase:i},a=t.editor.getPosition(),u=$e.searchNext(t,a,s,e.count,!1);return u&&u.getStartPosition()}(n);r?(t.editor.revealRangeInCenterIfOutsideViewport(i.Range.fromPositions(r,r)),a=!0):l()}}).then(function(i){if($e.isInc=!1,i){var r=!X.ignoreCase;if(i.startsWith("\\c"))r=!1,i=i.substring(2);else if(i.startsWith("\\C"))r=!0,i=i.substring(2);else if(X.ignoreCase&&X.smartCase)for(var o=0;o<i.length;o++){var s=i.charCodeAt(o);if(s==="\\".charCodeAt(0))o++;else if(s>="A".charCodeAt(0)&&s<="Z".charCodeAt(0)){r=!0;break}}if(0!==i.length){var a={searchString:i,wholeWord:!1,isRegex:!0,matchCase:r};en={direction:n,pattern:a};var u=t.editor.getPosition(),c=$e.searchNext(t,u,a,e.count);if(c){var h=t.position.soften(c.getStartPosition());t.editor.setPosition(h),t.editor.revealPosition(h)}else l(),t.vimState.outputError("Pattern not found: "+i)}else l(!0)}else l(!0)})}ht("*",function(t,e,n){var i=re.getWordToSearch(t.editor,e),r=i.start,o=i.searchString;if(o){var s={searchString:o,wholeWord:!0,isRegex:!1,matchCase:!X.ignoreCase};en={direction:"forward",pattern:s};var a=$e.searchNext(t,r,s,n);return a&&a.getStartPosition()}return null}),ht("g*",function(t,e,n){var i=re.getWordToSearch(t.editor,e),r=i.start,o=i.searchString;if(o){var s={searchString:o,wholeWord:!1,isRegex:!1,matchCase:!X.ignoreCase};en={direction:"forward",pattern:s};var a=$e.searchNext(t,r,s,n);return a&&a.getStartPosition()}return null}),ht("#",function(t,e,n){var i=re.getWordToSearch(t.editor,e),r=i.start,o=i.searchString;if(o){var s={searchString:o,wholeWord:!0,isRegex:!1,matchCase:!X.ignoreCase};en={direction:"backward",pattern:s};var a=$e.searchPrev(t,r,s,n);return a&&a.getStartPosition()}return null}),ht("g#",function(t,e,n){var i=re.getWordToSearch(t.editor,e),r=i.start,o=i.searchString;if(o){var s={searchString:o,wholeWord:!1,isRegex:!1,matchCase:!X.ignoreCase};en={direction:"backward",pattern:s};var a=$e.searchPrev(t,r,s,n);return a&&a.getStartPosition()}return null}),ht("n",{isJump:!0,run:function(t,e,n){var i=en;if(!i)return t.vimState.outputError("No previous regular expression"),null;var r=$e.search(t,e,i.pattern,"forward"===i.direction?"forward":"backward",n);return r&&r.getStartPosition()}}),ht("N",{isJump:!0,run:function(t,e,n){var i=en;if(!i)return t.vimState.outputError("No previous regular expression"),null;var r=$e.search(t,e,i.pattern,"forward"===i.direction?"backward":"forward",n);return r&&r.getStartPosition()}}),ht("gn",{makeSelection:!0,run:function(t,e,n,r){var o=en;if(!o)return t.vimState.outputError("No previous regular expression"),null;var s=$e.isAtMatch(t,e,o.pattern);if(s&&(n--,"Select"===r&&i.Position.equals(e,s.getEndPosition())&&n++),n>0&&(s=$e.search(t,e,o.pattern,"forward"===o.direction?"forward":"backward",n)),!s)return null;if("Select"===r){var a=s.getEndPosition();return i.Position.isBeforeOrEqual(e,a)?a:t.position.get(a).move(-1)}return{from:s.getStartPosition(),to:s.getEndPosition()}}}),ht("gN",{makeSelection:!0,run:function(t,e,n,r){var o=en;if(!o)return t.vimState.outputError("No previous regular expression"),null;var s=$e.isAtMatch(t,e,o.pattern);return s&&(n--,"Select"===r&&i.Position.equals(e,s.getStartPosition())&&n++),n>0&&(s=$e.search(t,e,o.pattern,"forward"===o.direction?"backward":"forward",n)),s?"Select"===r?s.getStartPosition():{from:s.getEndPosition(),to:s.getStartPosition()}:null}}),gt("/","n",function(t,e){nn(t,e,"forward","/")}),gt("?","n",function(t,e){nn(t,e,"backward","?")}),tn={matcher:/^noh(?:l|ls|lse|lsea|lsear|lsearc|lsearch)?\s*$/,handler:function(){$e.noHighLight()}},zt.push(tn);var rn=function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function s(t){try{u(i.next(t))}catch(t){o(t)}}function a(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,a)}u((i=i.apply(t,e||[])).next())})},on=function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},sn=function(){function t(t){this.vimState=t,this.editor=t.editor,this.position=new Dt(this.editor)}return Object.defineProperty(t.prototype,"model",{get:function(){var t=this.editor.getModel();if(!t)throw new Error("ICodeEditor.getModel() returns null.");return t},enumerable:!0,configurable:!0}),t}(),an=function(){function t(t,e,n){void 0===n&&(n="Normal");var i=this;switch(this.editor=t,this.eventSink=e,this.contextDataDict={},this.desiredColumn=1,this.isMovingCursorByMotion=!1,this.isExecutingCommand=!1,this.isRepeating=!1,this.subscriptions=[],this.editorId=t.getId(),this.commandContext=new sn(this),this.normalMode=new Ct(this.commandContext),this.insertMode=new Et(this.commandContext),this.visualMode=new It(this.commandContext),this.visualLineMode=new Mt(this.commandContext),n){case"Normal":this.toNormal();break;case"Insert":this.toInsert();break;case"Visual":this.toVisual();break;case"VisualLine":this.toVisualLine()}this.subscriptions.push(this.editor.onKeyDown(function(t){return i.handleKeyDown(t)})),this.subscriptions.push(this.editor.onDidChangeCursorPosition(function(t){return i.handleCursorChanged(t)})),this.subscriptions.push(this.editor.onDidBlurEditorText(function(){return i.handleLostFocus()})),this.subscriptions.push(this.editor.onDidDispose(function(){return i.dispose()}))}return t.prototype.getContextData=function(t){if(this.contextDataDict[t])return this.contextDataDict[t];var e=function(t){return yt[t]}(t);if(!e)throw new Error;var n=e(this);return this.contextDataDict[t]=n,n},t.create=function(e,n){var i=e.getId();if(t.instances.has(i))throw new Error('already created for "'+i+'"');var r=new t(e,n,X.startInInsertMode?"Insert":"Normal");return t.instances.set(i,r),r},t.getInstance=function(e){return t.instances.get(e)},t.disposeAllInstances=function(){t.instances.forEach(function(t){return t.dispose()}),t.instances.clear()},t.prototype.dispose=function(){for(var e in this.contextDataDict)this.contextDataDict[e].dispose();this.currentMode.leave(),this.normalMode.dispose(),this.insertMode.dispose(),this.visualMode.dispose(),this.visualLineMode.dispose();for(var n=0,i=this.subscriptions;n<i.length;n++){i[n].dispose()}t.instances.delete(this.editorId),this.editor.updateOptions({cursorStyle:"line"})},Object.defineProperty(t.prototype,"model",{get:function(){var t=this.editor.getModel();if(!t)throw new Error("ICodeEditor.getModel() returns null.");return t},enumerable:!0,configurable:!0}),t.prototype.isVisual=function(){return"Visual"===this.currentModeName||"VisualLine"===this.currentModeName},t.prototype.getMode=function(){return this.currentModeName},t.prototype.getModeDisplayName=function(){return this.currentMode.displayName},t.prototype.toNormal=function(){"Normal"!==this.currentModeName&&(this.currentMode&&this.currentMode.leave(),this.normalMode.enter(),this.currentModeName="Normal",this.currentMode=this.normalMode,this.onModeChanged())},t.prototype.toInsert=function(t,e){void 0===e&&(e="none"),"Insert"!==this.currentModeName&&(this.currentMode&&this.currentMode.leave(),this.insertMode.enter(t,e),this.currentModeName="Insert",this.currentMode=this.insertMode,this.onModeChanged())},t.prototype.toVisual=function(t){"Visual"!==this.currentModeName&&(this.currentMode&&this.currentMode.leave(),this.visualMode.enter(t),this.currentModeName="Visual",this.currentMode=this.visualMode,this.onModeChanged())},t.prototype.toVisualLine=function(t){"VisualLine"!==this.currentModeName&&(this.currentMode&&this.currentMode.leave(),this.visualLineMode.enter(t),this.currentModeName="VisualLine",this.currentMode=this.visualLineMode,this.onModeChanged())},t.prototype.outputInfo=function(t){this.eventSink&&this.eventSink.onCommandOuput&&this.eventSink.onCommandOuput(this,"info",t)},t.prototype.outputError=function(t){this.eventSink&&this.eventSink.onCommandOuput&&this.eventSink.onCommandOuput(this,"error",t)},t.prototype.beep=function(){this.eventSink&&this.eventSink.onCommandBeep&&this.eventSink.onCommandBeep(this)},t.prototype.notifyKeyBufferChanged=function(t){this.eventSink&&this.eventSink.onKeyBufferChanged&&("string"!=typeof t&&(t=t.map(function(t){return U(t)}).join("")),this.eventSink.onKeyBufferChanged(this,t))},t.prototype.notifyKeyWaiting=function(t){this.eventSink&&this.eventSink.onKeyWaiting&&("string"!=typeof t&&(t=t.map(function(t){return U(t)}).join("")),this.eventSink.onKeyWaiting(this,t))},t.prototype.notifyKeyMatched=function(t){this.eventSink&&this.eventSink.onKeyMatched&&("string"!=typeof t&&(t=t.map(function(t){return U(t)}).join("")),this.eventSink.onKeyMatched(this,t))},t.prototype.notifyKeyFailed=function(t){this.eventSink&&this.eventSink.onKeyFailed&&("string"!=typeof t&&(t=t.map(function(t){return U(t)}).join("")),this.eventSink.onKeyFailed(this,t))},t.prototype.notifyKeyCanceled=function(t){this.eventSink&&this.eventSink.onKeyCanceled&&("string"!=typeof t&&(t=t.map(function(t){return U(t)}).join("")),this.eventSink.onKeyCanceled(this,t))},t.prototype.onModeChanged=function(){t.instances.has(this.editorId)&&this.eventSink&&this.eventSink.onModeChanged&&this.eventSink.onModeChanged(this,this.getMode(),this.getModeDisplayName())},t.prototype.requestExternalInput=function(t,e,n){var i=this;return this.eventSink&&this.eventSink.onRequestExternalInput?this.eventSink.onRequestExternalInput(this,t,e,n):new Promise(function(r){var o={onChange:function(t){n(t)},onSubmit:function(t){r(t)},onCancel:function(){r(null)}};new Bt(i.editor,t,e,o)})},t.prototype.handleKeyDown=function(t){var e=t.keyCode;if(5!=e&&4!==e&&6!==e&&57!==e){var n=function(t){return t.ctrlKey||t.altKey||t.metaKey||1!==t.browserEvent.key.length||" "===t.browserEvent.key&&t.shiftKey?N(t.keyCode,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey):t.browserEvent.key.charCodeAt(0)}(t),i=this.handleInput(n,!0);i.handled&&(t.preventDefault(),t.stopPropagation(),i.job&&i.job())}},t.prototype.handleInput=function(t,e){var n=this.currentMode.handleInput(t,e);return"boolean"==typeof n&&(n={handled:n}),n},t.prototype.sendInput=function(t){return rn(this,void 0,void 0,function(){var e,n,i,r,o,s;return on(this,function(a){switch(a.label){case 0:return"number"!=typeof t?[3,3]:(s=this.handleInput(t,!1)).job?[4,s.job()]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2,s.handled];case 3:e=!0,n="string"==typeof t?F(t):t,i=0,r=n,a.label=4;case 4:return i<r.length?(o=r[i],!(s=this.handleInput(o,!1)).handled||s.failed?(e=!1,[3,7]):s.job?[4,s.job()]:[3,6]):[3,7];case 5:a.sent(),a.label=6;case 6:return i++,[3,4];case 7:return[2,e]}})})},t.prototype.executeExCommand=function(t){return Yt(this.commandContext,t)},t.prototype.handleCursorChanged=function(t){this.isMovingCursorByMotion||(this.desiredColumn=t.position.column)},t.prototype.handleLostFocus=function(){this.currentMode.discardInputBuffer()},t.instances=new Map,t}();function un(t,e){return an.create(t,e)}function cn(t){return an.getInstance(t.getId())}var ln='function Greeter(greeting) {\n    this.greeting = greeting;\n}\n\nGreeter.prototype.greet = function() {\n    return "Hello, " + this.greeting;\n}\n\n// Oops, we\'re passing an object when we want a string. This will print "Hello, [object Object]" instead of "Hello, world" without error.\nlet greeter = new Greeter({message: "world"});\n\nlet button = document.createElement(\'button\');\nbutton.textContent = "Say Hello";\nbutton.onclick = function() {\n    alert(greeter.greet());\n};\n\ndocument.body.appendChild(button);',hn='class Greeter {\n    greeting: string;\n    constructor(message: string) {\n        this.greeting = message;\n    }\n    greet() {\n        return "Hello, " + this.greeting;\n    }\n}\n\nlet greeter = new Greeter("world");\n\nlet button = document.createElement(\'button\');\nbutton.textContent = "Say Hello";\nbutton.onclick = function() {\n    alert(greeter.greet());\n}\n\ndocument.body.appendChild(button);',fn='class Animal {\n    constructor(public name: string) { }\n    move(distanceInMeters: number = 0) {\n        console.log(`${this.name} moved ${distanceInMeters}m.`);\n    }\n}\n\nclass Snake extends Animal {\n    constructor(name: string) { super(name); }\n    move(distanceInMeters = 5) {\n        console.log("Slithering...");\n        super.move(distanceInMeters);\n    }\n}\n\nclass Horse extends Animal {\n    constructor(name: string) { super(name); }\n    move(distanceInMeters = 45) {\n        console.log("Galloping...");\n        super.move(distanceInMeters);\n    }\n}\n\nlet sam = new Snake("Sammy the Python");\nlet tom: Animal = new Horse("Tommy the Palomino");\n\nsam.move();\ntom.move(34);',dn="data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=",pn=function(){var t=void 0;return function(){var e;void 0===t&&(e=new Audio(dn),t=function(){e.play()}),t()}}();(new(function(){function t(){this._activeTabIndex=-1,this._mode="",this._text="",this._enabled=!0,this._tid=null,this.editors=[],this._running=!1}return t.prototype.onKeyBufferChanged=function(t,e){this.text=e},t.prototype.onKeyMatched=function(t,e){console.log("Matched: "+e)},t.prototype.onKeyFailed=function(t,e){console.log("Failed: "+e),pn()},t.prototype.onKeyCanceled=function(t,e){console.log("Canceled: "+e)},t.prototype.onCommandBeep=function(){pn()},t.prototype.onCommandOuput=function(t,e,n){"info"===e?(console.log("info: "+n),this.text=n):(console.error("error: "+n),this.text="ERROR: "+n)},t.prototype.onModeChanged=function(t,e,n){t.editor===this.activeEditor&&(this.mode=n)},t.prototype.didMountEditor=function(t){var e=this;un(t,this),t.addAction({id:"vim.toggle",label:"Toggle Vim Mode",keybindings:[i.KeyMod.CtrlCmd|i.KeyCode.F10],run:function(){e.enabled=!e.enabled}})},t.prototype.didChangeActiveEditor=function(t){if(this.enabled){var e=cn(t);if(!e)throw new Error("something goes wrong.");this.mode=e.getModeDisplayName(),this.text=""}},t.prototype.config=function(){var t=this;X.nmap.addEditorAction(",xm","editor.action.showContextMenu"),X.nmap.addUserAction(",p",function(){return t.prevTab()}),X.nmap.addUserAction(",n",function(){return t.nextTab()}),X.nmap.addString(",f","=iB")},Object.defineProperty(t.prototype,"activeTabIndex",{get:function(){return this._activeTabIndex},set:function(t){this._activeTabIndex!==t&&(this._activeTabIndex=t,this.didChangeActiveEditor(this.activeEditor),this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode!==t&&(this._mode=t,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(t){this._text!==t&&(this._text=t,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled!==t&&this.toggle()},enumerable:!0,configurable:!0}),t.prototype.toggle=function(){var t=this;if(this._enabled=!this._enabled,this._enabled){this.editors.forEach(function(e){return un(e,t)});var e=cn(this.activeEditor);if(!e)throw new Error("something goes wrong.");this.mode=e.getModeDisplayName(),this.text=""}else this.mode="",this.text="",an.disposeAllInstances();this.render()},t.prototype.render=function(){var t=this;this._tid&&clearTimeout(this._tid),this._tid=setTimeout(function(){document.getElementById("mode").innerText=""===t.mode?"":"-- "+t.mode.toUpperCase()+" --";var e=document.getElementById("text");e.innerText=t.text,e.classList.toggle("error",t.text.startsWith("ERROR")),document.getElementById("enable").checked=t.enabled,t._tid=null},0)},t.prototype.activate=function(t){var e=this,n=this.editors.length-1;t<0||t>n||t===this.activeTabIndex||(this.activeTabIndex=t,document.querySelectorAll("#tabs>div").forEach(function(t,n){t.classList.toggle("active",n===e.activeTabIndex)}),document.querySelectorAll("#editors>div").forEach(function(t,n){t.classList.toggle("active",n===e.activeTabIndex)}),this.editors[this.activeTabIndex].focus())},t.prototype.prevTab=function(){var t=this.editors.length-1;this.activate(0===this.activeTabIndex?t:this.activeTabIndex-1)},t.prototype.nextTab=function(){var t=this.editors.length-1;this.activate(this.activeTabIndex===t?0:this.activeTabIndex+1)},t.prototype.bindDomEvents=function(){var t=this;document.querySelectorAll("#tabs>div").forEach(function(e,n){e.addEventListener("click",function(){return t.activate(n)})});var e=document.getElementById("enable");e.addEventListener("change",function(){t.enabled!==e.checked&&(t.enabled=e.checked,t.activeEditor.focus())})},Object.defineProperty(t.prototype,"activeEditor",{get:function(){return this.editors[this.activeTabIndex]},enumerable:!0,configurable:!0}),t.prototype.createEditor=function(t,e,n){var r=i.editor.create(document.getElementById(t),{value:e,language:n,minimap:{enabled:!1},wordWrap:"on"});return window.addEventListener("resize",function(){r.layout()}),this.didMountEditor(r),r},t.prototype.run=function(){var t=this;this._running||(this._running=!0,this.config(),this.editors=[["editor-1",ln,"javascript"],["editor-2",hn,"typescript"],["editor-3",fn,"typescript"]].map(function(e){return t.createEditor(e[0],e[1],e[2])}),this.bindDomEvents(),this.activate(0))},t}())).run()}]);